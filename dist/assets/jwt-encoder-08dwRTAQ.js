import{R as $,j as e,r}from"./styles-CaSueeVL.js";import{c as N}from"./clsx-CxAhFnsm.js";import{N as V,S as z,C as q}from"./Navigation-GWCsTUHU.js";import{C as Q}from"./chevron-down-BZIR9TYn.js";import{U as X}from"./upload-C00UOnUN.js";import{C as Z}from"./circle-alert-o5Vbv60q.js";import{C as K}from"./circle-check-EtXXpUgd.js";const ee={servicenow:{name:"ServiceNow",primary:"#81B5A1",primaryDark:"#5A8F7A",primaryLight:"#A8D4C4",bgGradient:"from-green-50 to-emerald-50",badgeBg:"#81B5A1",badgeText:"#FFFFFF"},salesforce:{name:"Salesforce",primary:"#00A1E0",primaryDark:"#0070D2",primaryLight:"#4FC3F7",bgGradient:"from-blue-50 to-cyan-50",badgeBg:"#00A1E0",badgeText:"#FFFFFF"}},F=o=>{const x=encodeURIComponent(o).replace(/%([0-9A-F]{2})/g,(s,i)=>String.fromCharCode(parseInt(i,16)));return btoa(x).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")},te=async o=>{if(o)try{await navigator.clipboard.writeText(o)}catch(x){console.error("Copy failed",x)}},se=async(o,x,s,i,u)=>{try{const v=F(JSON.stringify(o)),h=F(JSON.stringify(x)),l=`${v}.${h}`;let b;if(s.startsWith("HS")){const n=new TextEncoder,d=n.encode(i),m=s==="HS256"?"SHA-256":s==="HS384"?"SHA-384":"SHA-512",a=await crypto.subtle.importKey("raw",d,{name:"HMAC",hash:m},!1,["sign"]),y=await crypto.subtle.sign("HMAC",a,n.encode(l));b=btoa(String.fromCharCode(...new Uint8Array(y))).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}else if(s.startsWith("RS")||s.startsWith("ES")){let n;if(u==="JWK"){const m=typeof i=="string"?JSON.parse(i):i;if(!m.d)return{error:'Private key (JWK) required for signing. The key must include the "d" parameter.'};n=await crypto.subtle.importKey("jwk",m,{name:s.startsWith("RS")?"RSASSA-PKCS1-v1_5":"ECDSA",hash:s==="RS256"||s==="ES256"?"SHA-256":s==="RS384"||s==="ES384"?"SHA-384":"SHA-512"},!1,["sign"])}else{const m=i.replace(/-----BEGIN PRIVATE KEY-----/g,"").replace(/-----END PRIVATE KEY-----/g,"").replace(/-----BEGIN RSA PRIVATE KEY-----/g,"").replace(/-----END RSA PRIVATE KEY-----/g,"").replace(/\s+/g,""),a=Uint8Array.from(atob(m),y=>y.charCodeAt(0));if(s.startsWith("RS"))n=await crypto.subtle.importKey("pkcs8",a.buffer,{name:"RSASSA-PKCS1-v1_5",hash:s==="RS256"?"SHA-256":s==="RS384"?"SHA-384":"SHA-512"},!1,["sign"]);else if(s.startsWith("ES"))n=await crypto.subtle.importKey("pkcs8",a.buffer,{name:"ECDSA",namedCurve:s==="ES256"?"P-256":s==="ES384"?"P-384":"P-521"},!1,["sign"]);else return{error:`Algorithm ${s} not supported for signing`}}const d=await crypto.subtle.sign(s.startsWith("RS")?"RSASSA-PKCS1-v1_5":"ECDSA",n,new TextEncoder().encode(l));b=btoa(String.fromCharCode(...new Uint8Array(d))).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}else return{error:`Algorithm ${s} not supported`};return{token:`${l}.${b}`,error:null}}catch(v){return{token:null,error:v.message||"Signing error"}}},W={alg:"HS256",typ:"JWT"},O={sub:"user@example.com",name:"John Doe",iat:Math.floor(Date.now()/1e3),exp:Math.floor(Date.now()/1e3)+3600},re=()=>{const[o,x]=r.useState(JSON.stringify(W,null,2)),[s,i]=r.useState(JSON.stringify(O,null,2)),[u,v]=r.useState("HS256"),[h,l]=r.useState(""),[b,J]=r.useState("PEM"),[n,d]=r.useState(""),[m,a]=r.useState(""),[y,R]=r.useState(!1),[f,T]=r.useState("servicenow"),[D,P]=r.useState(!0),[p,S]=r.useState(!1),[E,H]=r.useState(!1),[M,B]=r.useState(!1),A=r.useRef(null),_=r.useRef(null),L=r.useRef(null),w=ee[f],c=u.startsWith("HS"),g=r.useMemo(()=>{try{const t=JSON.parse(o);return a(""),t}catch(t){return a(`Header JSON error: ${t.message}`),null}},[o]),C=r.useMemo(()=>{try{const t=JSON.parse(s);return a(""),t}catch(t){return a(`Payload JSON error: ${t.message}`),null}},[s]);r.useEffect(()=>{if(g&&g.alg!==u){const t={...g,alg:u};x(JSON.stringify(t,null,2))}},[u,g]),r.useEffect(()=>{!c&&!M&&B(!0)},[u,c]),r.useEffect(()=>{const t=j=>{j.key==="Escape"&&p&&S(!1)};return document.addEventListener("keydown",t),()=>document.removeEventListener("keydown",t)},[p]),r.useEffect(()=>{const t=j=>{A.current&&!A.current.contains(j.target)&&S(!1)};return p&&document.addEventListener("mousedown",t),()=>{document.removeEventListener("mousedown",t)}},[p]);const U=async()=>{if(!g||!C){a("Please fix JSON errors before generating");return}if(!c&&!h.trim()){a("Private key or secret is required for signing");return}if(c&&!h.trim()){a("Secret is required for HMAC signing");return}R(!0),a("");const t=await se(g,C,u,h,b);t.error?(a(t.error),d("")):(d(t.token),a("")),R(!1)},G=()=>{x(JSON.stringify(W,null,2)),i(JSON.stringify({...O,sub:f==="servicenow"?"veera@servicenow.com":"veera@salesforce.com",name:"Veera Solutions",user_name:f==="servicenow"?"veera.solutions":void 0,sys_id:f==="servicenow"?"a12b34c":void 0,organization_id:f==="salesforce"?"00D123456789":void 0},null,2)),v("HS256"),l(""),d(""),a("")},Y=t=>{const j=t.target.files[0];if(!j)return;const I=new FileReader;I.onload=k=>{if(b==="JWK")try{l(JSON.stringify(JSON.parse(k.target.result),null,2))}catch{l(k.target.result)}else l(k.target.result)},I.readAsText(j)};return e.jsxs("div",{className:"flex h-screen bg-slate-50 overflow-hidden",children:[e.jsx(V,{currentPageId:"jwt-encoder",sidebarOpen:D,onSidebarToggle:P}),e.jsx("div",{className:"flex-1 overflow-hidden flex flex-col",style:{width:"100%",minWidth:0},children:e.jsxs("div",{className:"mx-auto max-w-[1800px] w-full px-8 py-6 flex-1 flex flex-col min-h-0",style:{width:"100%",maxWidth:"1800px"},children:[e.jsxs("header",{className:"mb-4 flex items-start justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:"JSON Web Token (JWT) Encoder"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Create and sign JSON Web Tokens. All processing happens in your browserâ€”data never leaves your device."})]}),e.jsxs("div",{className:"relative",ref:A,children:[e.jsxs("button",{className:"flex items-center gap-1.5 rounded-xl border border-slate-200 bg-white px-3 py-1.5 text-sm font-medium text-slate-700 shadow-sm transition-all hover:bg-slate-50 hover:border-slate-300 active:scale-[0.98] focus:outline-none",onClick:()=>S(!p),onKeyDown:t=>{(t.key==="Enter"||t.key===" ")&&(t.preventDefault(),S(!p))},tabIndex:0,"aria-label":"Select company","aria-expanded":p,children:[e.jsx("span",{className:"text-slate-900 whitespace-nowrap",children:w.name}),e.jsx(Q,{className:N("h-3.5 w-3.5 text-slate-500 transition-transform duration-200 flex-shrink-0",p&&"rotate-180")})]}),p&&e.jsxs("div",{className:"absolute right-0 top-full mt-1.5 w-40 rounded-xl border border-slate-200 bg-white shadow-xl z-50 overflow-hidden",children:[e.jsx("button",{onClick:()=>{T("servicenow"),S(!1)},className:N("w-full px-3 py-2 text-left text-sm transition-colors active:scale-[0.98] focus:outline-none",f==="servicenow"?"bg-slate-100 font-medium text-slate-900":"text-slate-700 hover:bg-slate-50"),tabIndex:0,children:"ServiceNow"}),e.jsx("button",{onClick:()=>{T("salesforce"),S(!1)},className:N("w-full px-3 py-2 text-left text-sm transition-colors active:scale-[0.98] focus:outline-none",f==="salesforce"?"bg-slate-100 font-medium text-slate-900":"text-slate-700 hover:bg-slate-50"),tabIndex:0,children:"Salesforce"})]})]})]}),e.jsxs("div",{className:"rounded-xl border-2 border-slate-200 bg-white shadow-sm overflow-hidden mb-4",children:[e.jsxs("div",{className:"relative border-b-2 border-slate-200 bg-slate-50/50 px-6 py-3 rounded-t-xl",children:[e.jsx("div",{className:"absolute left-0 top-0 bottom-0 w-1 rounded-l-xl",style:{backgroundColor:w.primary}}),e.jsx("label",{htmlFor:"header-input",className:"text-sm font-semibold text-slate-900",children:"JWT Header"})]}),e.jsx("div",{className:"relative",children:e.jsx("textarea",{ref:_,id:"header-input",value:o,onChange:t=>x(t.target.value),placeholder:"Enter JWT header as JSON",className:"h-40 w-full resize-none border-0 bg-white px-6 py-5 font-mono text-base leading-relaxed text-slate-900 placeholder:text-slate-500 focus:outline-none",tabIndex:0})})]}),e.jsxs("div",{className:"rounded-xl border-2 border-slate-200 bg-white shadow-sm overflow-hidden mb-4",children:[e.jsxs("div",{className:"relative border-b-2 border-slate-200 bg-slate-50/50 px-6 py-3 rounded-t-xl",children:[e.jsx("div",{className:"absolute left-0 top-0 bottom-0 w-1 rounded-l-xl",style:{backgroundColor:w.primary}}),e.jsx("label",{htmlFor:"payload-input",className:"text-sm font-semibold text-slate-900",children:"JWT Payload"})]}),e.jsx("div",{className:"relative",children:e.jsx("textarea",{ref:L,id:"payload-input",value:s,onChange:t=>i(t.target.value),placeholder:"Enter JWT payload as JSON",className:"h-40 w-full resize-none border-0 bg-white px-6 py-5 font-mono text-base leading-relaxed text-slate-900 placeholder:text-slate-500 focus:outline-none",tabIndex:0})})]}),e.jsxs("div",{className:"rounded-xl border-2 border-slate-200 bg-white shadow-sm overflow-hidden mb-4",children:[e.jsxs("div",{className:"relative border-b-2 border-slate-200 bg-slate-50/50 px-6 py-3 rounded-t-xl",children:[e.jsx("div",{className:"absolute left-0 top-0 bottom-0 w-1 rounded-l-xl",style:{backgroundColor:w.primary}}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{className:"text-sm font-semibold text-slate-900",children:"Signing Configuration"}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("button",{onClick:G,className:"rounded-xl border border-slate-200 bg-white px-3 py-1.5 text-xs font-medium text-slate-700 transition hover:bg-slate-50 hover:border-slate-300 active:scale-95 focus:outline-none",tabIndex:0,children:"Load Example"})})]})]}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Algorithm"}),e.jsxs("select",{value:u,onChange:t=>{v(t.target.value),l(""),d(""),a("")},className:"w-full rounded-xl border-2 border-slate-200 bg-white px-4 py-2 text-sm font-medium text-slate-700 focus:outline-none focus:border-slate-400 transition-colors cursor-pointer hover:bg-slate-50",tabIndex:0,children:[e.jsxs("optgroup",{label:"HMAC",children:[e.jsx("option",{value:"HS256",children:"HS256"}),e.jsx("option",{value:"HS384",children:"HS384"}),e.jsx("option",{value:"HS512",children:"HS512"})]}),e.jsxs("optgroup",{label:"RSA",children:[e.jsx("option",{value:"RS256",children:"RS256"}),e.jsx("option",{value:"RS384",children:"RS384"}),e.jsx("option",{value:"RS512",children:"RS512"})]}),e.jsxs("optgroup",{label:"ECDSA",children:[e.jsx("option",{value:"ES256",children:"ES256"}),e.jsx("option",{value:"ES384",children:"ES384"}),e.jsx("option",{value:"ES512",children:"ES512"})]})]})]}),!c&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Key Format"}),e.jsxs("select",{value:b,onChange:t=>{J(t.target.value),l(""),d("")},className:"w-full rounded-xl border-2 border-slate-200 bg-white px-4 py-2 text-sm font-medium text-slate-700 focus:outline-none focus:border-slate-400 transition-colors cursor-pointer hover:bg-slate-50",tabIndex:0,children:[e.jsx("option",{value:"PEM",children:"PEM"}),e.jsx("option",{value:"JWK",children:"JWK"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:c?"Secret":"Private Key"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("textarea",{value:h,onChange:t=>{l(t.target.value),d(""),a("")},placeholder:c?"Enter the secret used to sign the JWT":b==="PEM"?`-----BEGIN PRIVATE KEY-----
MIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQC...
-----END PRIVATE KEY-----`:`{
  "kty": "RSA",
  "n": "...",
  "e": "AQAB",
  "d": "...",
  ...
}`,className:"flex-1 h-32 resize-none rounded-xl border-2 border-slate-200 bg-white px-4 py-3 font-mono text-sm leading-relaxed text-slate-900 placeholder:text-slate-400 focus:border-slate-400 focus:outline-none transition-colors",tabIndex:0}),!c&&e.jsxs("label",{className:"flex items-center gap-2 rounded-xl border-2 border-slate-200 bg-white px-3.5 py-2 text-xs font-medium text-slate-700 transition hover:bg-slate-50 hover:border-slate-300 active:scale-95 cursor-pointer focus-within:outline-none focus-within:border-slate-400",children:[e.jsx(X,{className:"h-3.5 w-3.5"}),"Upload",e.jsx("input",{type:"file",accept:".pem,.key,.json",onChange:Y,className:"hidden",tabIndex:0})]})]})]}),e.jsx("button",{onClick:U,disabled:!g||!C||!c&&!h.trim()||c&&!h.trim()||y,className:"w-full rounded-xl px-5 py-3 text-sm font-semibold text-white transition-all hover:opacity-90 hover:shadow-md active:scale-95 active:opacity-75 disabled:bg-slate-300 disabled:cursor-not-allowed focus:outline-none shadow-lg flex items-center justify-center gap-2",style:{backgroundColor:w.primary},tabIndex:0,children:y?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"h-4 w-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Encoding..."]}):e.jsxs(e.Fragment,{children:[e.jsx(z,{className:"h-4 w-4"}),"Generate JWT"]})})]})]}),m&&e.jsx("div",{className:"rounded-xl border-2 border-error/40 bg-error/10 px-6 py-4 mb-4",children:e.jsxs("div",{className:"flex items-center gap-2 text-sm font-medium text-error",children:[e.jsx(Z,{className:"h-4 w-4 flex-shrink-0"}),e.jsx("span",{children:m})]})}),n&&e.jsxs("div",{className:"rounded-xl border-2 border-slate-200 bg-white shadow-sm overflow-hidden",children:[e.jsxs("div",{className:"relative border-b-2 border-slate-200 bg-slate-50/50 px-6 py-3 rounded-t-xl",children:[e.jsx("div",{className:"absolute left-0 top-0 bottom-0 w-1 rounded-l-xl",style:{backgroundColor:w.primary}}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{className:"text-sm font-semibold text-slate-900",children:"Encoded JWT Token"}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("button",{onClick:async()=>{await te(n),H(!0),setTimeout(()=>H(!1),2e3)},className:N("inline-flex items-center gap-1.5 rounded-xl border border-slate-200 bg-white px-3 py-1.5 text-xs font-medium text-slate-700 transition hover:bg-slate-50 hover:border-slate-300 active:scale-95 focus:outline-none",E&&"bg-success/20 border-success text-success"),tabIndex:0,children:[E?e.jsx(K,{className:"h-3.5 w-3.5"}):e.jsx(q,{className:"h-3.5 w-3.5"}),E?"Copied!":"Copy"]})})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx("textarea",{value:n,readOnly:!0,className:"h-32 w-full resize-none border-0 bg-white px-6 py-5 font-mono text-base leading-relaxed text-slate-900 focus:outline-none",tabIndex:0}),e.jsx("div",{className:"absolute inset-0 pointer-events-none px-6 py-5 font-mono text-base leading-relaxed overflow-hidden",children:e.jsx("pre",{className:"whitespace-pre-wrap break-all",children:(()=>{const t=n.split(".");return t.length!==3?e.jsx("span",{className:"text-slate-700",children:n}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-blue-400",children:t[0]}),e.jsx("span",{className:"text-slate-300",children:"."}),e.jsx("span",{className:"text-purple-400",children:t[1]}),e.jsx("span",{className:"text-slate-300",children:"."}),e.jsx("span",{className:"text-emerald-400",children:t[2]})]})})()})})]}),e.jsx("div",{className:"border-t-2 border-slate-200 bg-slate-50 px-6 py-4 rounded-b-xl",children:e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(K,{className:"h-4 w-4 text-green-600"}),e.jsx("span",{className:"font-medium text-slate-900",children:"JWT generated successfully"})]})})]})]})})]})};$.createRoot(document.getElementById("root")).render(e.jsx(re,{}));
//# sourceMappingURL=jwt-encoder-08dwRTAQ.js.map
