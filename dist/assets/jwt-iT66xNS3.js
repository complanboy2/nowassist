import{c as ht,S as Fe,F as gt,R as ft,j as e,r as l,a as xt}from"./styles-CaSueeVL.js";import{K as Be,N as pt,F as yt,c as S}from"./clsx-CxAhFnsm.js";import{N as bt,C as ke}from"./Navigation-GWCsTUHU.js";import{C as te}from"./circle-check-EtXXpUgd.js";import{X as ee,C as de}from"./x-BRk70qYl.js";import{C as F}from"./circle-alert-o5Vbv60q.js";import{C as P}from"./chevron-down-BZIR9TYn.js";import{R as Le}from"./refresh-cw-BRNcYpJW.js";import{I as xe}from"./info-k-umQQ3y.js";import{U as wt}from"./upload-C00UOnUN.js";import{C as vt}from"./clock-DYgp0fsE.js";import{L as St,G as Nt}from"./lock-YVgUwo2N.js";const jt=[["path",{d:"M12 3v18",key:"108xh3"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}]],kt=ht("table",jt);class ue extends Error{}ue.prototype.name="InvalidTokenError";function Ct(t){return decodeURIComponent(atob(t).replace(/(.)/g,(r,a)=>{let o=a.charCodeAt(0).toString(16).toUpperCase();return o.length<2&&(o="0"+o),"%"+o}))}function It(t){let r=t.replace(/-/g,"+").replace(/_/g,"/");switch(r.length%4){case 0:break;case 2:r+="==";break;case 3:r+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return Ct(r)}catch{return atob(r)}}function Et(t,r){if(typeof t!="string")throw new ue("Invalid token specified: must be a string");r||(r={});const a=r.header===!0?0:1,o=t.split(".")[a];if(typeof o!="string")throw new ue(`Invalid token specified: missing part #${a+1}`);let n;try{n=It(o)}catch(m){throw new ue(`Invalid token specified: invalid base64 for part #${a+1} (${m.message})`)}try{return JSON.parse(n)}catch(m){throw new ue(`Invalid token specified: invalid json for part #${a+1} (${m.message})`)}}const x={CRITICAL:"critical",HIGH:"high",MEDIUM:"medium",LOW:"low",INFO:"info"},Mt={iss:{name:"Issuer",description:"Identifies the principal that issued the JWT",required:!1,category:"Standard"},sub:{name:"Subject",description:"Identifies the subject of the JWT (usually the user)",required:!1,category:"Standard"},aud:{name:"Audience",description:"Identifies the recipients that the JWT is intended for. Should always be present in production tokens.",required:!1,recommended:!0,category:"Standard"},exp:{name:"Expiration Time",description:"Identifies the expiration time on or after which the JWT must not be accepted for processing",required:!1,recommended:!0,category:"Standard"},nbf:{name:"Not Before",description:"Identifies the time before which the JWT must not be accepted for processing",required:!1,category:"Standard"},iat:{name:"Issued At",description:"Identifies the time at which the JWT was issued",required:!1,recommended:!0,category:"Standard"},jti:{name:"JWT ID",description:"Provides a unique identifier for the JWT. Can be used to prevent token replay attacks.",required:!1,category:"Standard"},email:{name:"Email",description:"User email address",required:!1,category:"Custom"},name:{name:"Name",description:"User full name",required:!1,category:"Custom"},scope:{name:"Scope",description:"OAuth 2.0 scope values",required:!1,category:"OAuth"},sys_id:{name:"ServiceNow Sys ID",description:"ServiceNow system record identifier",required:!1,category:"ServiceNow"},user_name:{name:"ServiceNow Username",description:"ServiceNow user name",required:!1,category:"ServiceNow"},instance:{name:"ServiceNow Instance",description:"ServiceNow instance identifier",required:!1,category:"ServiceNow"},organization_id:{name:"Salesforce Organization ID",description:"Salesforce organization identifier",required:!1,category:"Salesforce"},user_id:{name:"Salesforce User ID",description:"Salesforce user identifier",required:!1,category:"Salesforce"}},At=(t,r,a,o=Date.now())=>{const n=[];if(!t)return n.push({severity:x.CRITICAL,code:"MISSING_HEADER",title:"Missing Header",message:"JWT header is missing or invalid",recommendation:"Ensure the token has a valid header segment"}),{issues:n,riskScore:100};if(!r)return n.push({severity:x.CRITICAL,code:"MISSING_PAYLOAD",title:"Missing Payload",message:"JWT payload is missing or invalid",recommendation:"Ensure the token has a valid payload segment"}),{issues:n,riskScore:100};const m=t.alg;if((m==="none"||m==="None"||m==="NONE")&&n.push({severity:x.CRITICAL,code:"NONE_ALGORITHM",title:"None Algorithm Detected",message:'Token uses the "none" algorithm, which provides no security',recommendation:'Never use the "none" algorithm in production. Use HS256, RS256, or ES256.',riskScore:100}),(!a||a.length===0)&&n.push({severity:x.HIGH,code:"MISSING_SIGNATURE",title:"Missing Signature",message:"Token has no signature (unsigned token)",recommendation:"Always sign tokens in production to ensure integrity and authenticity",riskScore:80}),!r.exp)n.push({severity:x.HIGH,code:"MISSING_EXP",title:"Missing Expiration Claim",message:"Token has no expiration time (exp claim)",recommendation:"Always include an expiration time to limit token lifetime and reduce risk if compromised",riskScore:70});else{const c=r.exp*1e3;if(c<o){const h=Math.floor((o-c)/864e5);n.push({severity:x.HIGH,code:"EXPIRED_TOKEN",title:"Token Expired",message:`Token expired ${h>0?`${h} day(s)`:"recently"} ago`,recommendation:"Do not accept expired tokens. Request a new token from the identity provider",riskScore:60})}}if(r.aud||n.push({severity:x.HIGH,code:"MISSING_AUD",title:"Missing Audience Claim",message:"Token has no audience (aud claim)",recommendation:"Include an audience claim to ensure tokens are only used by intended recipients",riskScore:65}),!r.iat)n.push({severity:x.MEDIUM,code:"MISSING_IAT",title:"Missing Issued At Claim",message:"Token has no issued at time (iat claim)",recommendation:"Include iat claim to track when the token was issued",riskScore:30});else{const h=(r.iat*1e3-o)/(1e3*60);h>5&&n.push({severity:x.MEDIUM,code:"FUTURE_IAT",title:"Future Issued At Time",message:`Token appears to be issued ${Math.round(h)} minutes in the future`,recommendation:"Check system clocks for clock skew between issuer and validator",riskScore:40})}if(r.exp&&r.iat){const c=(r.exp-r.iat)/3600;c>24&&n.push({severity:x.MEDIUM,code:"LONG_EXPIRY",title:"Long Token Lifetime",message:`Token lifetime is ${Math.round(c)} hours (${Math.round(c/24)} days)`,recommendation:"Access tokens should typically expire within 1 hour. Use refresh tokens for longer sessions",riskScore:45})}if(m==="HS256"&&n.push({severity:x.MEDIUM,code:"WEAK_ALGORITHM",title:"HMAC Algorithm Used",message:"Token uses HMAC (symmetric) signing algorithm",recommendation:"Consider using RS256 or ES256 (asymmetric) for better key management in distributed systems",riskScore:35,note:"HS256 is acceptable if secret is properly managed"}),r.jti||n.push({severity:x.LOW,code:"MISSING_JTI",title:"Missing JWT ID",message:"Token has no unique identifier (jti claim)",recommendation:"Include jti claim to enable token revocation and prevent replay attacks",riskScore:20}),r.nbf){const c=r.nbf*1e3;if(c>o){const h=Math.round((c-o)/6e4);n.push({severity:x.INFO,code:"NOT_YET_VALID",title:"Token Not Yet Valid",message:`Token will be valid in ${h} minutes`,recommendation:"Wait until nbf time before accepting this token",riskScore:10})}}const i=Math.min(100,Math.max(0,n.reduce((c,h)=>c+(h.riskScore||0),0)/Math.max(n.length,1)));return{issues:n,riskScore:i}},Tt=t=>t>=80?{level:"Critical",color:"text-red-600",bg:"bg-red-50",border:"border-red-200"}:t>=60?{level:"High",color:"text-orange-600",bg:"bg-orange-50",border:"border-orange-200"}:t>=40?{level:"Medium",color:"text-yellow-600",bg:"bg-yellow-50",border:"border-yellow-200"}:t>=20?{level:"Low",color:"text-blue-600",bg:"bg-blue-50",border:"border-blue-200"}:{level:"Info",color:"text-green-600",bg:"bg-green-50",border:"border-green-200"},Rt=t=>Mt[t]||{name:t,description:"Custom claim",required:!1,category:"Custom"},Dt=(t,r=Date.now())=>{if(!t)return"—";const a=typeof t=="number"?t*1e3:t,o=new Date(a);if(Number.isNaN(o.getTime()))return"Invalid timestamp";const n=Math.floor((a-r)/1e3),m=Math.floor(n/60),i=Math.floor(m/60),c=Math.floor(i/24),h=new Intl.RelativeTimeFormat("en",{numeric:"auto"});return Math.abs(c)>0?`${o.toLocaleString()} (${h.format(c,"day")})`:Math.abs(i)>0?`${o.toLocaleString()} (${h.format(i,"hour")})`:Math.abs(m)>0?`${o.toLocaleString()} (${h.format(m,"minute")})`:`${o.toLocaleString()} (${h.format(n,"second")})`},Ht=(t,r=Date.now())=>{if(!t)return null;const a=t*1e3,o=a-r,n=Math.max(0,Math.min(100,o/(a-(r-864e5))*100));return{ms:o,seconds:Math.floor(o/1e3),minutes:Math.floor(o/(1e3*60)),hours:Math.floor(o/(1e3*60*60)),days:Math.floor(o/(1e3*60*60*24)),percentage:n,expired:o<0}},_t=async t=>{try{const r=await fetch(t);if(!r.ok)throw new Error(`HTTP ${r.status}: ${r.statusText}`);const a=await r.json();if(!a.keys||!Array.isArray(a.keys))throw new Error("Invalid JWKS format: missing keys array");return{success:!0,jwks:a,keys:a.keys,count:a.keys.length}}catch(r){return{success:!1,error:r.message||"Failed to fetch JWKS",jwks:null,keys:[],count:0}}},We=(t,r)=>!t||!t.keys?null:t.keys.find(a=>a.kid===r)||null,Ge=new Map,Kt=300*1e3,Ut=t=>{const r=Ge.get(t);return r&&Date.now()-r.timestamp<Kt?r.jwks:null},Jt=(t,r)=>{Ge.set(t,{jwks:r,timestamp:Date.now()})},Lt=["password","secret","token","access_token","refresh_token","api_key","apikey","auth","authorization","credit_card","ssn","social_security","pin","pii","phi"],Wt=[/password/i,/secret/i,/token/i,/key/i,/auth/i,/credential/i,/passphrase/i,/private/i],pe=t=>{const r=t.toLowerCase();return Lt.some(a=>r.includes(a))?!0:Wt.some(a=>a.test(t))},Ot=(t,r=[],a="*",o=8)=>{if(!t)return t;const n={...t},m=new Set(r);return r.length===0&&Object.keys(t).forEach(i=>{pe(i)&&m.add(i)}),m.forEach(i=>{if(i in n){const c=n[i];typeof c=="string"?n[i]=a.repeat(Math.min(o,c.length))+(c.length>o?"...":""):typeof c=="object"&&c!==null?n[i]="[REDACTED]":n[i]=a.repeat(o)}}),n},$t=(t,r,a="")=>{try{const o=i=>{const c=encodeURIComponent(i).replace(/%([0-9A-F]{2})/g,(h,p)=>String.fromCharCode(parseInt(p,16)));return btoa(c).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")},n=o(JSON.stringify(t)),m=o(JSON.stringify(r));return`${n}.${m}.${a.substring(0,10)}...REDACTED`}catch{return null}},Pt=(t,r)=>{const a=h=>{if(!h)return null;const p=h.split(".");if(p.length!==3)return null;try{const y=A=>{const j=A.replace(/-/g,"+").replace(/_/g,"/").padEnd(A.length+(A.length%4?4-A.length%4:0),"="),w=atob(j);try{return decodeURIComponent(w.split("").map(E=>`%${`00${E.charCodeAt(0).toString(16)}`.slice(-2)}`).join(""))}catch{return w}},N=y(p[0]),D=y(p[1]);return{header:JSON.parse(N),payload:JSON.parse(D),signature:p[2],headerRaw:N,payloadRaw:D}}catch{return null}},o=a(t),n=a(r);if(!o||!n)return{valid:!1,error:"One or both tokens are invalid"};const m=Oe(o.header,n.header),i=Oe(o.payload,n.payload),c=o.signature===n.signature;return{valid:!0,token1:o,token2:n,headerDiff:m,payloadDiff:i,signaturesMatch:c,summary:{headerChanges:m.added.length+m.removed.length+m.changed.length,payloadChanges:i.added.length+i.removed.length+i.changed.length,signaturesMatch:c}}},Oe=(t,r)=>{const a=new Set([...Object.keys(t||{}),...Object.keys(r||{})]),o=[],n=[],m=[],i=[];return a.forEach(c=>{const h=t?.[c],p=r?.[c];c in(t||{})?c in(r||{})?JSON.stringify(h)!==JSON.stringify(p)?m.push({key:c,oldValue:h,newValue:p}):i.push({key:c,value:h}):n.push({key:c,value:h}):o.push({key:c,value:p})}),{added:o,removed:n,changed:m,unchanged:i}},Ft=t=>{if(!t.valid)return t.error||"Comparison failed";const{headerDiff:r,payloadDiff:a,signaturesMatch:o}=t,n=[];return r.added.length>0&&n.push(`${r.added.length} header field(s) added`),r.removed.length>0&&n.push(`${r.removed.length} header field(s) removed`),r.changed.length>0&&n.push(`${r.changed.length} header field(s) changed`),a.added.length>0&&n.push(`${a.added.length} claim(s) added`),a.removed.length>0&&n.push(`${a.removed.length} claim(s) removed`),a.changed.length>0&&n.push(`${a.changed.length} claim(s) changed`),o?n.push("Signatures match"):n.push("Signatures differ"),n.join(", ")||"Tokens are identical"},Bt={servicenow:{name:"ServiceNow",primary:"#81B5A1",primaryDark:"#5A8F7A",primaryLight:"#A8D4C4",bgGradient:"from-green-50 to-emerald-50",badgeBg:"#81B5A1",badgeText:"#FFFFFF"},salesforce:{name:"Salesforce",primary:"#00A1E0",primaryDark:"#0070D2",primaryLight:"#4FC3F7",bgGradient:"from-blue-50 to-cyan-50",badgeBg:"#00A1E0",badgeText:"#FFFFFF"}},Gt=t=>!t||t.sys_id||t.instance||t.instance_url||t.user_name||t.email&&t.email.includes("servicenow")?"servicenow":t.organization_id||t.user_id||t.sfdc_instance_url||t.scope||t.email&&t.email.includes("salesforce")?"salesforce":"servicenow",Vt=(t,r)=>{if(!t)return[];const a=[];return r==="servicenow"?(t.sys_id&&a.push("Contains ServiceNow sys_id"),(t.user_name||t.userName)&&a.push("User principal claim detected"),(t.instance||t.instance_url)&&a.push("Instance metadata present")):r==="salesforce"&&(t.organization_id&&a.push("Contains Salesforce organization_id"),t.user_id&&a.push("User ID claim detected"),t.sfdc_instance_url&&a.push("Salesforce instance URL present"),t.scope&&a.push("OAuth scope defined")),a},zt=(t,r)=>{if(!t)return new Set;const a=new Set;return r==="servicenow"?(t.sys_id&&a.add("sys_id"),(t.user_name||t.userName)&&a.add("user_name"),(t.instance||t.instance_url)&&(a.add("instance"),a.add("instance_url"))):r==="salesforce"&&(t.organization_id&&a.add("organization_id"),t.user_id&&a.add("user_id"),t.sfdc_instance_url&&a.add("sfdc_instance_url"),t.scope&&a.add("scope")),a},Ce=t=>{if(!t)return"";const r=t.replace(/-/g,"+").replace(/_/g,"/").padEnd(t.length+(t.length%4?4-t.length%4:0),"="),a=atob(r);try{return decodeURIComponent(a.split("").map(o=>`%${`00${o.charCodeAt(0).toString(16)}`.slice(-2)}`).join(""))}catch{return a}},$e=t=>{if(!t)return"";try{return JSON.stringify(JSON.parse(t),null,2)}catch{return t}},qt=t=>{if(!t?.exp)return{tone:"warning",icon:F,message:"Missing exp claim"};const r=Date.now(),a=t.exp*1e3;if(a<r){const n=Math.floor((r-a)/864e5);return{tone:"error",icon:F,message:n>0?`Expired ${n} day(s) ago`:"Recently expired"}}const o=(a-r)/(1e3*60*60);return o<=1?{tone:"warning",icon:F,message:`Expiring in ${Math.round(o*60)} minutes`}:{tone:"success",icon:te,message:`Valid for ${Math.round(o)} hour(s)`}},Yt={success:{text:"text-success",bg:"bg-success/10",border:"border-success/20"},warning:{text:"text-warning",bg:"bg-warning/10",border:"border-warning/20"},error:{text:"text-error",bg:"bg-error/10",border:"border-error/20"}},Pe=["sub","name","email","user_name","sys_id","iat","exp"],Qt=(t=32)=>{const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";let a="";for(let o=0;o<t;o++)a+=r.charAt(Math.floor(Math.random()*r.length));return a},Xt=async(t="HS256")=>{const r=["John","Jane","Alice","Bob","Charlie","David","Emma","Frank","Grace","Henry"],a=["Smith","Johnson","Williams","Brown","Jones","Garcia","Miller","Davis","Rodriguez","Martinez"],o=["example.com","test.com","demo.org","sample.net","dev.io"],n=r[Math.floor(Math.random()*r.length)],m=a[Math.floor(Math.random()*a.length)],i=o[Math.floor(Math.random()*o.length)],c=`${n.toLowerCase()}.${m.toLowerCase()}@${i}`,h=`${n.toLowerCase()}.${m.toLowerCase()}`,p=Array.from({length:32},()=>Math.floor(Math.random()*16).toString(16)).join(""),y=Math.floor(Date.now()/1e3),N=y-Math.floor(Math.random()*3600),D=y+Math.floor(Math.random()*86400)+3600,A={alg:t,typ:"JWT",...t.startsWith("RS")||t.startsWith("ES")?{kid:Math.floor(Math.random()*1e6).toString()}:{}},j={sub:c,name:`${n} ${m}`,email:c,user_name:h,sys_id:p,iat:N,exp:D,instance:`instance${Math.floor(Math.random()*100)}.service-now.com`,instance_url:`https://instance${Math.floor(Math.random()*100)}.service-now.com`},w=C=>{const R=encodeURIComponent(C).replace(/%([0-9A-F]{2})/g,(u,f)=>String.fromCharCode(parseInt(f,16)));return btoa(R).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")},E=w(JSON.stringify(A)),J=w(JSON.stringify(j)),H=`${E}.${J}`;let T,L="";if(t.startsWith("HS")){const C=Qt();L=C;const R=new TextEncoder,u=R.encode(C),f=t==="HS256"?"SHA-256":t==="HS384"?"SHA-384":"SHA-512",_=await crypto.subtle.importKey("raw",u,{name:"HMAC",hash:f},!1,["sign"]),W=await crypto.subtle.sign("HMAC",_,R.encode(H));T=btoa(String.fromCharCode(...new Uint8Array(W))).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}else if(t.startsWith("RS")){const C=t==="RS256"?"SHA-256":t==="RS384"?"SHA-384":"SHA-512",R=await crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:2048,publicExponent:new Uint8Array([1,0,1]),hash:C},!0,["sign","verify"]),u=new TextEncoder,f=await crypto.subtle.sign("RSASSA-PKCS1-v1_5",R.privateKey,u.encode(H));T=btoa(String.fromCharCode(...new Uint8Array(f))).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"");const _=await crypto.subtle.exportKey("spki",R.publicKey);L=`-----BEGIN PUBLIC KEY-----
${btoa(String.fromCharCode(...new Uint8Array(_))).match(/.{1,64}/g).join(`
`)}
-----END PUBLIC KEY-----`}else if(t.startsWith("ES")){const C=t==="ES256"?"SHA-256":t==="ES384"?"SHA-384":"SHA-512",R=t==="ES256"?"P-256":t==="ES384"?"P-384":"P-521",u=await crypto.subtle.generateKey({name:"ECDSA",namedCurve:R},!0,["sign","verify"]),f=new TextEncoder,_=await crypto.subtle.sign({name:"ECDSA",hash:C},u.privateKey,f.encode(H));T=btoa(String.fromCharCode(...new Uint8Array(_))).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"");const W=await crypto.subtle.exportKey("spki",u.publicKey);L=`-----BEGIN PUBLIC KEY-----
${btoa(String.fromCharCode(...new Uint8Array(W))).match(/.{1,64}/g).join(`
`)}
-----END PUBLIC KEY-----`}return{token:`${H}.${T}`,key:L,algorithm:t}};Fe,chrome.runtime?.getURL&&chrome.runtime.getURL("jwt.html"),Be,chrome.runtime?.getURL&&chrome.runtime.getURL("saml.html"),pt,chrome.runtime?.getURL&&chrome.runtime.getURL("rest.html"),yt,chrome.runtime?.getURL&&chrome.runtime.getURL("har-analyzer.html"),gt,chrome.runtime?.getURL&&chrome.runtime.getURL("json-utility.html");const z=async t=>{if(t)try{await navigator.clipboard.writeText(t)}catch(r){console.error("Copy failed",r)}},Zt=async(t,r,a,o)=>{try{const n=t.split(".");if(n.length!==3)return{verified:!1,error:"Invalid JWT format"};const i=JSON.parse(Ce(n[0])).alg||a||"RS256";if(i.startsWith("HS")){const w=new TextEncoder,E=`${n[0]}.${n[1]}`,J=w.encode(r),H=i==="HS256"?"SHA-256":i==="HS384"?"SHA-384":"SHA-512",T=await crypto.subtle.importKey("raw",J,{name:"HMAC",hash:H},!1,["sign"]),L=await crypto.subtle.sign("HMAC",T,w.encode(E)),C=btoa(String.fromCharCode(...new Uint8Array(L))).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")===n[2];return{verified:C,error:C?null:"Signature verification failed"}}let c;if(o==="JWK"){const w=typeof r=="string"?JSON.parse(r):r;c=await crypto.subtle.importKey("jwk",w,{name:i.startsWith("RS")?"RSASSA-PKCS1-v1_5":"ECDSA",hash:i==="RS256"||i==="ES256"?"SHA-256":i==="RS384"||i==="ES384"?"SHA-384":"SHA-512"},!1,["verify"])}else{const w=r.replace(/-----BEGIN PUBLIC KEY-----/g,"").replace(/-----END PUBLIC KEY-----/g,"").replace(/-----BEGIN RSA PUBLIC KEY-----/g,"").replace(/-----END RSA PUBLIC KEY-----/g,"").replace(/\s+/g,""),E=Uint8Array.from(atob(w),J=>J.charCodeAt(0));if(i.startsWith("RS"))c=await crypto.subtle.importKey("spki",E.buffer,{name:"RSASSA-PKCS1-v1_5",hash:i==="RS256"?"SHA-256":i==="RS384"?"SHA-384":"SHA-512"},!1,["verify"]);else if(i.startsWith("ES"))c=await crypto.subtle.importKey("spki",E.buffer,{name:"ECDSA",namedCurve:i==="ES256"?"P-256":i==="ES384"?"P-384":"P-521"},!1,["verify"]);else return{verified:!1,error:`Algorithm ${i} not supported for verification`}}const h=`${n[0]}.${n[1]}`,p=n[2].replace(/-/g,"+").replace(/_/g,"/"),y=p.length%4?4-p.length%4:0,N=p+"=".repeat(y),D=Uint8Array.from(atob(N),w=>w.charCodeAt(0)),A=i.startsWith("RS")?"RSASSA-PKCS1-v1_5":{name:"ECDSA",hash:i==="ES256"?"SHA-256":i==="ES384"?"SHA-384":"SHA-512"},j=await crypto.subtle.verify(A,c,D,new TextEncoder().encode(h));return{verified:j,error:j?null:"Signature verification failed"}}catch(n){return{verified:!1,error:n.message||"Verification error"}}},es=t=>l.useMemo(()=>{if(!t.trim())return{error:"",header:null,payload:null,signature:"",headerRaw:"",payloadRaw:""};const r=t.split(".");if(r.length!==3)return{error:"A JWT must contain three dot-separated segments.",header:null,payload:null,signature:"",headerRaw:"",payloadRaw:""};try{const a=Ce(r[0]),o=Ce(r[1]),n=r[2],m=JSON.parse(a),i=Et(t);return{error:"",header:m,payload:i,signature:n,headerRaw:a,payloadRaw:o}}catch(a){return{error:a.message||"Unable to decode token.",header:null,payload:null,signature:r[2]||"",headerRaw:"",payloadRaw:""}}},[t]),fe=({title:t,content:r,description:a,onCopy:o,viewMode:n,onViewModeChange:m,theme:i,statusColor:c,isHeader:h=!1,payload:p,targetClaims:y,getClaimInfo:N,companyClaimSet:D,currentCompany:A,currentTime:j,calculateTTL:w})=>{const[E,J]=l.useState(!1),H=r?r.split(`
`):["—"],T=n==="table"&&t?.startsWith("Payload:")?(()=>{try{return JSON.parse(r)}catch{return null}})():null;c?.border,c?.text;const L=c?c.text.includes("error")?"#ef4444":c.text.includes("warning")?"#f59e0b":i.primary:i.primary,q=async()=>{await o(r),J(!0),setTimeout(()=>J(!1),2e3)},C=t?.startsWith("Payload:")||t?.startsWith("Signature:")?"400px":h?"auto":"280px",R=n==="table"&&T&&t?.startsWith("Payload:");return e.jsxs("div",{className:"border border-gray-200 rounded-xl bg-white flex flex-col overflow-hidden shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between bg-gray-50 px-6 py-3.5 flex-shrink-0 border-b border-gray-200",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-2 w-2 rounded-full flex-shrink-0",style:{backgroundColor:L}}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-900 uppercase tracking-wide",children:t}),a&&e.jsx("p",{className:"text-xs text-gray-600 leading-tight mt-1",children:a})]})]}),e.jsxs("div",{className:"flex items-center gap-1.5 flex-shrink-0",children:[t?.startsWith("Payload:")&&e.jsxs("div",{className:"flex items-center gap-0.5 bg-white p-0.5 border border-gray-300 rounded-md",children:[e.jsx("button",{onClick:()=>m("json"),className:S("px-2 py-1 text-xs font-medium transition-colors rounded",n==="json"?"bg-sky-500 text-white":"text-gray-700 hover:bg-gray-50"),tabIndex:0,children:"JSON"}),e.jsxs("button",{onClick:()=>m("table"),className:S("px-2 py-1 text-xs font-medium transition-colors rounded inline-flex items-center gap-1",n==="table"?"bg-sky-500 text-white":"text-gray-700 hover:bg-gray-50"),tabIndex:0,children:[e.jsx(kt,{className:"h-3 w-3"}),"Table"]})]}),e.jsxs("button",{onClick:q,onKeyDown:u=>{(u.key==="Enter"||u.key===" ")&&(u.preventDefault(),q())},onMouseDown:u=>{u.currentTarget.style.transform="scale(0.95)",u.currentTarget.style.backgroundColor="#e2e8f0"},onMouseUp:u=>{u.currentTarget.style.transform="",u.currentTarget.style.backgroundColor=""},onTouchStart:u=>{u.currentTarget.style.transform="scale(0.95)",u.currentTarget.style.backgroundColor="#e2e8f0"},onTouchEnd:u=>{setTimeout(()=>{u.currentTarget.style.transform="",u.currentTarget.style.backgroundColor=""},150)},className:S("inline-flex items-center gap-1.5 px-3 py-1.5 text-xs font-semibold transition-all focus:outline-none border-2 rounded-lg focus:ring-2 focus:ring-sky-500 focus:ring-offset-1 shadow-sm",E?"bg-green-50 border-green-400 text-green-700":"text-gray-700 hover:bg-gray-50 hover:border-gray-400 bg-white border-gray-300 hover:shadow"),tabIndex:0,children:[E?e.jsx(te,{className:"h-3.5 w-3.5"}):e.jsx(ke,{className:"h-3.5 w-3.5"}),e.jsx("span",{className:"hidden sm:inline",children:E?"Copied!":"Copy"})]})]})]}),e.jsx("div",{className:S("bg-white",h||R?"overflow-visible":"overflow-auto"),style:h||R?{}:{height:C,maxHeight:C},children:n==="table"&&T?e.jsx("div",{className:"p-6 w-full",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b-2 border-gray-200",children:[e.jsx("th",{className:"px-5 py-3 text-left font-semibold text-gray-900",children:"Claim"}),e.jsx("th",{className:"px-5 py-3 text-left font-semibold text-gray-900",children:"Value"})]})}),e.jsx("tbody",{children:Object.entries(T).map(([u,f])=>e.jsxs("tr",{className:"border-b border-gray-100 hover:bg-gray-50 transition-colors",children:[e.jsx("td",{className:"px-5 py-3 font-mono text-gray-700 text-sm",children:u}),e.jsx("td",{className:"px-5 py-3 text-gray-900 text-sm",children:typeof f=="object"?JSON.stringify(f):String(f)})]},u))})]})}):t?.startsWith("Signature:")?e.jsx("div",{className:"p-6",children:e.jsx("pre",{className:"text-sm leading-relaxed whitespace-pre-wrap break-words overflow-wrap-anywhere",children:e.jsx("code",{className:"font-mono text-gray-800",children:r||"—"})})}):e.jsxs("div",{className:"flex bg-white",style:{flex:"1 1 auto",minHeight:"100%"},children:[e.jsx("div",{className:"flex-shrink-0 bg-gray-50 border-r-2 border-gray-200 text-right pr-4 pl-4 py-5 flex flex-col",style:{width:"55px",fontFamily:"monospace",minHeight:"100%"},children:H.map((u,f)=>e.jsx("div",{className:"text-gray-400 text-xs leading-relaxed select-none flex-shrink-0",style:{minHeight:"20px"},children:f+1},f))}),e.jsx("div",{className:"flex-1 py-5 pl-6 pr-6 text-sm leading-relaxed overflow-x-auto bg-white",children:e.jsx("div",{className:"font-mono text-gray-800",children:H.map((u,f)=>{let _=null,W=!1;if(t?.startsWith("Key Claims:")&&y&&N&&p){const M=u.match(/^\s*"([^"]+)":\s*(.+)/);if(M&&y.includes(M[1])){const B=M[1];_=N(B),W=D?.has(B)||!1}}if(t?.startsWith("Key Claims:")&&_){const M=u.indexOf(":");if(M!==-1){const B=u.substring(0,M+1),G=u.substring(M+1).trim();return e.jsxs("div",{className:"flex items-center gap-2",style:{minHeight:"22.4px"},children:[e.jsx("span",{className:"text-slate-900 whitespace-pre",children:B}),e.jsx("span",{className:"text-slate-900 whitespace-pre",children:G}),W&&e.jsx("span",{className:"inline-flex items-center rounded-full px-1.5 py-0.5 text-xs font-semibold uppercase text-white flex-shrink-0",style:{backgroundColor:i.badgeBg},children:A==="servicenow"?"SN":"SF"}),e.jsx(Ve,{content:e.jsxs("div",{className:"max-w-sm",children:[e.jsx("p",{className:"font-semibold mb-1.5 text-sm text-white",children:_.name}),e.jsx("p",{className:"text-xs mb-2.5 text-slate-300 leading-relaxed",children:_.description})]}),position:"left",children:e.jsx(xe,{className:"h-3.5 w-3.5 text-sky-500 cursor-help flex-shrink-0"})})]},f)}}return e.jsx("div",{className:"text-slate-900 whitespace-pre",style:{minHeight:"22.4px"},children:u||" "},f)})})})]})})]})},Ve=({children:t,content:r,position:a="top"})=>{const[o,n]=l.useState(!1),m={top:"left-1/2 bottom-full mb-2 -translate-x-1/2",left:"right-full top-1/2 mr-2 -translate-y-1/2",right:"left-full top-1/2 ml-2 -translate-y-1/2",bottom:"left-1/2 top-full mt-2 -translate-x-1/2"},i={top:"left-1/2 top-full -translate-x-1/2 -mt-1 border-4 border-transparent border-t-white",left:"left-full top-1/2 -translate-y-1/2 -ml-1 border-4 border-transparent border-r-white",right:"right-full top-1/2 -translate-y-1/2 -mr-1 border-4 border-transparent border-l-white",bottom:"left-1/2 bottom-full -translate-x-1/2 -mb-1 border-4 border-transparent border-b-white"};return e.jsxs("div",{className:"relative inline-block",children:[e.jsx("div",{onMouseEnter:()=>n(!0),onMouseLeave:()=>n(!1),onFocus:()=>n(!0),onBlur:()=>n(!1),className:"cursor-help",tabIndex:0,children:t}),o&&e.jsxs("div",{className:`absolute ${m[a]} z-50 w-64 rounded-lg border border-slate-200 bg-white p-3 text-xs text-slate-700 shadow-lg`,children:[r,e.jsx("div",{className:`absolute ${i[a]}`})]})]})},ts=()=>{const[t,r]=l.useState(""),[a,o]=l.useState(""),[n,m]=l.useState(""),[i,c]=l.useState("PEM"),[h,p]=l.useState(!1),[y,N]=l.useState(null),[D,A]=l.useState(!1),[j,w]=l.useState(!1),[E,J]=l.useState("json"),[H,T]=l.useState("servicenow"),[L,q]=l.useState(!0),[C,R]=l.useState(""),[u,f]=l.useState(!1),[_,W]=l.useState(!1),[M,B]=l.useState(!1),[G,ye]=l.useState(null),[ze]=l.useState(!0),[se,Ie]=l.useState(!1),[re,Ee]=l.useState(!1),[ae,Me]=l.useState(!1),[Y,qe]=l.useState(""),[O,be]=l.useState(null),[Ae,we]=l.useState(!1),[Te,Re]=l.useState(null),[ne,De]=l.useState(""),[ve]=l.useState(!0),[Q,He]=l.useState([]),[me,Ye]=l.useState(null),[Qe]=l.useState(!0),[he,Xe]=l.useState(""),[b,Ze]=l.useState(null),[_e,et]=l.useState("HS256"),[oe,ge]=l.useState(!1),Se=l.useRef(null),Ke=l.useRef(null),Ne=l.useRef(null),Ue=l.useRef(null);l.useRef(null);const{error:ie,header:K,payload:g,signature:V,headerRaw:tt,payloadRaw:st}=es(t),X=qt(g),Z=G||Date.now(),I=l.useMemo(()=>!K||!g?null:At(K,g,V,Z),[K,g,V,Z]),je=l.useMemo(()=>I?Tt(I.riskScore):null,[I]),rt=l.useMemo(()=>Gt(g),[g]),$=H||rt,le=Bt[$];l.useMemo(()=>Vt(g,$),[g,$]);const at=l.useMemo(()=>zt(g,$),[g,$]),nt=X.icon,ce=V&&V.length>0,U=K?.alg?.startsWith("HS");l.useEffect(()=>{ce&&!j&&w(!0)},[ce]),l.useEffect(()=>{N(null)},[t]),l.useEffect(()=>{const s=Ue.current;if(s){s.style.height="auto";const d=Math.min(s.scrollHeight,400);s.style.height=`${d}px`}},[t]),l.useEffect(()=>{const s=d=>{d.key==="Escape"&&u&&f(!1),d.key==="Escape"&&j&&w(!1)};return document.addEventListener("keydown",s),()=>document.removeEventListener("keydown",s)},[u,j]),l.useEffect(()=>{const s=d=>{Se.current&&!Se.current.contains(d.target)&&f(!1),Ke.current&&!Ke.current.contains(d.target)&&ge(!1),Ne.current&&!Ne.current.contains(d.target)&&p(!1)};return(u||oe||h)&&document.addEventListener("mousedown",s),()=>{document.removeEventListener("mousedown",s)}},[u,oe,h]);const ot=async()=>{if(!t)return;A(!0);const d=await Zt(t,U?n:a,K?.alg,i);N(d),A(!1)},it=s=>{const d=s.target.files[0];if(!d)return;const v=new FileReader;v.onload=k=>{if(i==="JWK")try{o(JSON.stringify(JSON.parse(k.target.result),null,2))}catch{o(k.target.result)}else o(k.target.result)},v.readAsText(d)},Je=async()=>{if(!Y.trim())return;we(!0),Re(null);const s=Ut(Y);if(s){be(s),we(!1);return}const d=await _t(Y);d.success?(be(d.jwks),Jt(Y,d.jwks),K?.kid&&d.keys.length>0&&We(d.jwks,K.kid)&&De(K.kid)):(Re(d.error),be(null)),we(!1)};l.useEffect(()=>{if(O&&ne&&!U){const s=We(O,ne);s&&(c("JWK"),o(JSON.stringify(s,null,2)))}},[O,ne,U]),l.useEffect(()=>{if(g&&ve){const s=Object.keys(g).filter(d=>pe(d));s.length>0&&Q.length===0&&He(s)}},[g,ve]);const lt=s=>{He(d=>d.includes(s)?d.filter(v=>v!==s):[...d,s])};l.useEffect(()=>{if(K&&g){const s=Ot(g,Q),d=$t(K,s,V);Ye(d)}},[K,g,V,Q]);const ct=()=>{if(!t||!he)return;const s=Pt(t,he);Ze(s)},dt=s=>({text:"text-error",border:"border-error/40"});l.useMemo(()=>ie||g&&(X.tone==="error"||y?.verified===!1)?"error":null,[ie,g,X,y]);const ut=l.useMemo(()=>{if(!g)return[];const s=[];return s.push({label:"Structure",status:"success",icon:te,message:"Valid"}),s.push({label:"Expiry",status:X.tone,icon:nt,message:X.message}),ce?y?.verified?s.push({label:"Signature",status:"success",icon:te,message:"Verified"}):y?.verified===!1?s.push({label:"Signature",status:"error",icon:ee,message:"Invalid"}):s.push({label:"Signature",status:"warning",icon:F,message:"Not verified"}):s.push({label:"Signature",status:"warning",icon:F,message:"Missing"}),s},[g,X,ce,y]);return e.jsxs("div",{className:"flex h-screen bg-white overflow-hidden",children:[e.jsx(bt,{currentPageId:"jwt",sidebarOpen:L,onSidebarToggle:q}),e.jsx("div",{className:"flex-1 overflow-y-auto bg-gray-50",style:{width:"100%",minWidth:0},children:e.jsxs("div",{className:"mx-auto max-w-7xl w-full px-8 py-10",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsx("header",{className:"bg-white border border-gray-300 rounded-xl shadow-sm px-8 py-6 mb-6",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"JWT Debugger"}),e.jsx("p",{className:"text-base text-gray-600",children:"Decode, verify, and inspect JSON Web Tokens"})]}),e.jsxs("div",{className:"relative",ref:Se,children:[e.jsxs("button",{className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-gray-700 hover:text-gray-900 transition-all border border-gray-300 rounded-lg hover:border-sky-400 hover:bg-sky-50 focus:outline-none focus:ring-2 focus:ring-sky-500 focus:ring-offset-2",onClick:()=>f(!u),onKeyDown:s=>{(s.key==="Enter"||s.key===" ")&&(s.preventDefault(),f(!u))},tabIndex:0,"aria-label":"Select company","aria-expanded":u,children:[e.jsx("span",{className:"whitespace-nowrap",children:le.name}),e.jsx(P,{className:S("h-4 w-4 text-gray-500 transition-transform duration-200",u&&"rotate-180")})]}),u&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>f(!1)}),e.jsxs("div",{className:"absolute right-0 top-full mt-2 w-40 bg-white border border-gray-200 rounded-lg shadow-xl z-50 overflow-hidden",children:[e.jsx("button",{onClick:()=>{T("servicenow"),f(!1)},className:S("w-full px-4 py-2.5 text-left text-sm transition-colors border-b border-gray-100 last:border-b-0 focus:outline-none",$==="servicenow"?"bg-sky-50 text-sky-700 font-semibold":"text-gray-700 hover:bg-gray-50"),tabIndex:0,children:"ServiceNow"}),e.jsx("button",{onClick:()=>{T("salesforce"),f(!1)},className:S("w-full px-4 py-2.5 text-left text-sm transition-colors border-b border-gray-100 last:border-b-0 focus:outline-none",$==="salesforce"?"bg-sky-50 text-sky-700 font-semibold":"text-gray-700 hover:bg-gray-50"),tabIndex:0,children:"Salesforce"})]})]})]})]})}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{htmlFor:"token-input",className:"text-base font-semibold text-gray-900",children:"JSON Web Token (JWT)"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>ge(!oe),onKeyDown:s=>{(s.key==="Enter"||s.key===" ")&&(s.preventDefault(),ge(!oe))},className:"px-4 py-2 text-xs font-semibold text-gray-700 bg-white border-2 border-gray-300 rounded-lg hover:bg-gray-50 hover:border-gray-400 focus:outline-none focus:ring-2 focus:ring-sky-500 focus:ring-offset-1 transition-all shadow-sm hover:shadow inline-flex items-center gap-2",tabIndex:0,children:[e.jsx(Le,{className:"h-3.5 w-3.5"}),"Generate example (",_e,")",e.jsx(P,{className:"h-3 w-3"})]}),oe&&e.jsx("div",{className:"absolute right-0 top-full mt-2 w-40 border border-gray-200 rounded-lg bg-white shadow-lg z-50 overflow-y-auto max-h-64",children:["HS256","HS384","HS512","RS256","RS384","RS512","ES256","ES384","ES512"].map(s=>e.jsx("button",{onClick:async()=>{et(s),ge(!1);const{token:d,key:v,algorithm:k}=await Xt(s);r(d),k.startsWith("HS")?(m(v),o("")):(o(v),m(""),c("PEM")),j||w(!0)},className:S("w-full px-3 py-2 text-left text-sm transition-colors active:scale-[0.98] focus:outline-none",_e===s?"bg-slate-100 font-medium text-slate-900":"text-slate-700 hover:bg-slate-50"),tabIndex:0,children:s},s))})]}),e.jsxs("button",{onClick:()=>z(t),onKeyDown:s=>{(s.key==="Enter"||s.key===" ")&&(s.preventDefault(),z(t))},className:"inline-flex items-center gap-2 px-4 py-2 text-xs font-semibold text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 hover:border-gray-400 focus:outline-none focus:ring-2 focus:ring-sky-500 focus:ring-offset-1 transition-all shadow-sm hover:shadow",tabIndex:0,children:[e.jsx(ke,{className:"h-4 w-4"}),"Copy"]}),e.jsxs("button",{onClick:()=>r(""),onKeyDown:s=>{(s.key==="Enter"||s.key===" ")&&(s.preventDefault(),r(""))},className:"inline-flex items-center gap-1.5 px-4 py-2 text-xs font-semibold text-gray-700 bg-white border-2 border-gray-300 rounded-lg hover:bg-gray-50 hover:border-gray-400 focus:outline-none focus:ring-2 focus:ring-sky-500 focus:ring-offset-1 transition-all shadow-sm hover:shadow",tabIndex:0,children:[e.jsx(ee,{className:"h-3.5 w-3.5"}),"Clear"]})]})]})}),e.jsxs("div",{className:"relative",children:[e.jsx("textarea",{ref:Ue,id:"token-input",value:t,onChange:s=>{r(s.target.value),s.target.style.height="auto";const d=Math.min(s.target.scrollHeight,400);s.target.style.height=`${d}px`},placeholder:"Paste a JWT token here...",className:"min-h-[120px] max-h-[400px] w-full resize-none border border-gray-300 rounded-xl bg-white px-5 py-4 font-mono text-sm leading-relaxed text-gray-900 placeholder:text-gray-400 focus:outline-none focus:ring-2 focus:ring-sky-500 focus:border-sky-500 transition-all overflow-y-auto shadow-sm",style:{color:"transparent",caretColor:"#111827",height:"auto"},tabIndex:0}),t&&e.jsx("div",{className:"absolute inset-0 pointer-events-none px-5 py-4 font-mono text-sm leading-relaxed overflow-hidden rounded-xl",style:{maxHeight:"400px",overflowY:"auto"},children:e.jsx("pre",{className:"whitespace-pre-wrap break-all",children:(()=>{const s=t.split(".");return s.length!==3?e.jsx("span",{className:"text-gray-900",children:t}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-sky-600",children:s[0]}),e.jsx("span",{className:"text-gray-400",children:"."}),e.jsx("span",{className:"text-purple-600",children:s[1]}),e.jsx("span",{className:"text-gray-400",children:"."}),e.jsx("span",{className:"text-green-600",children:s[2]})]})})()})})]}),ie&&e.jsxs("div",{className:"mt-4 flex items-center gap-3 text-sm text-red-700 bg-red-50 border border-red-200 px-5 py-3 rounded-lg",children:[e.jsx(F,{className:"h-5 w-5 flex-shrink-0"}),e.jsx("span",{className:"font-medium",children:ie})]}),!ie&&g&&e.jsxs("div",{className:"mt-4 flex items-center gap-6 text-sm flex-wrap bg-green-50 border border-green-200 px-5 py-3 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(te,{className:"h-4 w-4 text-green-600"}),e.jsx("span",{className:"font-medium text-gray-900",children:"Valid JWT"})]}),ut.map((s,d)=>{const v=s.icon,k=Yt[s.status];return e.jsxs(xt.Fragment,{children:[d>0&&e.jsx("span",{className:"text-gray-300 mx-2",children:"·"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(v,{className:S("h-4 w-4",k.text)}),e.jsxs("span",{className:S("font-medium",k.text),children:[s.label,": ",e.jsx("span",{className:"text-gray-600",children:s.message})]})]})]},s.label)})]})]}),g&&e.jsxs(e.Fragment,{children:[I&&I.issues.length>0&&e.jsxs("div",{className:"mb-6 bg-white border border-gray-200 rounded-xl shadow-sm overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between bg-gray-50 px-6 py-4 border-b border-gray-200 cursor-pointer hover:bg-gray-100 transition-colors",onClick:()=>B(!M),children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsx(Fe,{className:"h-5 w-5 text-slate-600"}),e.jsx("span",{className:"text-base font-semibold text-slate-900",children:"Security Analysis"}),e.jsxs("span",{className:S("ml-2 px-2 py-0.5 rounded text-xs font-semibold",je?.bg,je?.color),children:[I.issues.length," ",I.issues.length===1?"Issue":"Issues"]}),!M&&e.jsxs("span",{className:"ml-2 text-xs text-slate-500",children:["• ",I.issues.filter(s=>s.severity===x.CRITICAL).length>0&&`${I.issues.filter(s=>s.severity===x.CRITICAL).length} Critical`,I.issues.filter(s=>s.severity===x.HIGH).length>0&&`, ${I.issues.filter(s=>s.severity===x.HIGH).length} High`,I.issues.filter(s=>s.severity===x.MEDIUM).length>0&&`, ${I.issues.filter(s=>s.severity===x.MEDIUM).length} Medium`,"• ",je?.level," Risk (",I.riskScore,"/100)"]})]}),e.jsx("button",{onClick:s=>{s.stopPropagation(),B(!M)},className:"p-1 text-gray-500 hover:text-gray-700 transition-colors focus:outline-none",tabIndex:0,children:M?e.jsx(de,{className:"h-4 w-4"}):e.jsx(P,{className:"h-4 w-4"})})]}),M&&e.jsx("div",{className:"p-6 space-y-4 bg-white",children:I.issues.map((s,d)=>{const v={[x.CRITICAL]:{text:"text-red-700",bg:"bg-red-50",border:"border-red-200",icon:ee},[x.HIGH]:{text:"text-orange-700",bg:"bg-orange-50",border:"border-orange-200",icon:F},[x.MEDIUM]:{text:"text-yellow-700",bg:"bg-yellow-50",border:"border-yellow-200",icon:F},[x.LOW]:{text:"text-sky-700",bg:"bg-sky-50",border:"border-sky-200",icon:xe},[x.INFO]:{text:"text-slate-700",bg:"bg-slate-50",border:"border-slate-200",icon:xe}},k=v[s.severity]||v[x.INFO],mt=k.icon;return e.jsx("div",{className:S("rounded p-3",k.bg),children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(mt,{className:S("h-4 w-4 mt-0.5 flex-shrink-0",k.text)}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:S("font-medium text-sm",k.text),children:s.title}),e.jsx("span",{className:S("text-xs font-medium px-2 py-0.5 rounded uppercase",k.bg,k.text,k.border,"border"),children:s.severity})]}),e.jsx("p",{className:"text-sm text-gray-700 mb-2",children:s.message}),s.recommendation&&e.jsxs("div",{className:"mt-2 pt-2 border-t border-gray-200",children:[e.jsx("p",{className:"text-xs font-medium text-gray-600 mb-1",children:"Recommendation:"}),e.jsx("p",{className:"text-xs text-gray-700",children:s.recommendation})]})]})]})},d)})})]}),e.jsxs("div",{className:"grid gap-6 lg:grid-cols-2 mb-6",children:[e.jsx(fe,{title:"Header: Signing Algorithms & Token Type",content:$e(tt),description:"",onCopy:z,viewMode:"json",theme:le,statusColor:null,isHeader:!0}),e.jsx(fe,{title:"Key Claims: Important JWT Claims",content:(()=>{const s={};return Pe.forEach(d=>{const v=g?.[d];v!=null&&(d==="iat"||d==="exp"||d==="nbf"?s[d]=Dt(v,Z):s[d]=v)}),JSON.stringify(s,null,2)})(),description:"",onCopy:z,viewMode:"json",theme:le,statusColor:null,isHeader:!0,payload:g,targetClaims:Pe,getClaimInfo:Rt,companyClaimSet:at,currentCompany:$,currentTime:Z,calculateTTL:Ht})]}),e.jsxs("div",{className:"grid gap-6 lg:grid-cols-2 mb-6",children:[e.jsx(fe,{title:"Payload: Claims and User Data",content:$e(st),description:"",onCopy:z,viewMode:E,onViewModeChange:J,theme:le,statusColor:null}),ce&&e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsx(fe,{title:"Signature: Cryptographic Signature",content:V,description:"",onCopy:z,viewMode:"json",theme:le,statusColor:y?.verified===!1?dt():null,isHeader:!0}),e.jsxs("div",{className:"mt-6 bg-white border border-gray-200 rounded-xl shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between bg-gray-50 px-6 py-3.5 border-b border-gray-200",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[e.jsx("span",{className:"text-sm font-semibold text-gray-900 uppercase tracking-wide",children:"Verify Signature"}),!U&&e.jsx(Ve,{content:e.jsxs("div",{className:"max-w-xs",children:[e.jsx("p",{className:"font-semibold mb-1 text-sm text-white",children:"Supported Algorithms"}),e.jsx("p",{className:"text-xs text-gray-300 leading-relaxed",children:"RSA: RS256, RS384, RS512 | ECDSA: ES256, ES384, ES512. Paste your public key in PEM or JWK format, or upload a file."})]}),position:"bottom",children:e.jsx(xe,{className:"h-3.5 w-3.5 text-gray-400 hover:text-gray-600 cursor-help flex-shrink-0"})}),y&&e.jsxs("div",{className:S("ml-2 flex items-center gap-1.5 px-2 py-0.5 rounded text-xs font-medium flex-shrink-0",y.verified?"bg-green-100 text-green-700":"bg-red-100 text-red-700"),children:[y.verified?e.jsx(te,{className:"h-3.5 w-3.5"}):e.jsx(ee,{className:"h-3.5 w-3.5"}),e.jsx("span",{children:y.verified?"Verified":"Failed"})]})]}),e.jsx("button",{onClick:()=>w(!j),className:"flex-shrink-0 p-1 text-gray-500 hover:text-gray-700 transition-colors focus:outline-none",tabIndex:0,"aria-label":j?"Collapse":"Expand",children:j?e.jsx(de,{className:"h-4 w-4"}):e.jsx(P,{className:"h-4 w-4"})})]}),j&&e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsx("div",{children:e.jsx("textarea",{value:U?n:a,onChange:s=>{U?m(s.target.value):o(s.target.value),N(null)},placeholder:U?"Enter the secret used to sign the JWT":i==="PEM"?`-----BEGIN PUBLIC KEY-----
MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8A...
-----END PUBLIC KEY-----`:`{
  "kty": "RSA",
  "n": "...",
  "e": "AQAB"
}`,className:"w-full h-32 resize-none border border-gray-300 rounded-lg bg-gray-50 px-4 py-3 font-mono text-sm leading-relaxed text-gray-900 placeholder:text-gray-400 focus:border-sky-500 focus:outline-none focus:ring-2 focus:ring-sky-500 transition-all",tabIndex:0})}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:ot,disabled:!t||!U&&!a||U&&!n||D,className:"px-5 py-2.5 text-sm font-semibold text-white bg-sky-500 hover:bg-sky-600 rounded-lg transition-all disabled:bg-gray-300 disabled:cursor-not-allowed disabled:hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-sky-500 focus:ring-offset-2 shadow-sm hover:shadow",tabIndex:0,children:D?"Verifying...":"Verify Signature"}),e.jsxs("div",{className:"flex items-center gap-2 ml-auto",children:[!U&&e.jsxs(e.Fragment,{children:[e.jsxs("label",{className:"inline-flex items-center gap-2 px-4 py-2 text-xs font-semibold text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 hover:border-gray-400 cursor-pointer transition-all focus-within:outline-none focus-within:ring-2 focus-within:ring-sky-500 focus-within:ring-offset-1 shadow-sm hover:shadow",children:[e.jsx(wt,{className:"h-4 w-4"}),"Upload",e.jsx("input",{type:"file",accept:".pem,.key,.crt,.pub,.json",onChange:it,className:"hidden",tabIndex:0})]}),e.jsxs("div",{className:"relative",ref:Ne,children:[e.jsxs("button",{type:"button",onClick:()=>p(!h),className:"inline-flex items-center gap-2 px-4 py-2 text-sm font-semibold text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 hover:border-gray-400 focus:outline-none focus:ring-2 focus:ring-sky-500 focus:ring-offset-1 transition-all shadow-sm hover:shadow",tabIndex:0,children:[e.jsx("span",{children:i}),e.jsx(P,{className:S("h-4 w-4 text-gray-500 transition-transform duration-200",h&&"rotate-180")})]}),h&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-[49]",onClick:()=>p(!1)}),e.jsxs("div",{className:"absolute right-0 top-full mt-2 w-36 bg-white border border-gray-200 rounded-lg shadow-xl z-[100] overflow-hidden",children:[e.jsx("button",{onClick:()=>{c("PEM"),o(""),N(null),p(!1)},className:S("w-full px-4 py-2.5 text-left text-sm transition-colors focus:outline-none border-b border-gray-100 last:border-b-0",i==="PEM"?"bg-sky-50 text-sky-600 font-medium":"text-gray-700 hover:bg-gray-50"),tabIndex:0,children:"PEM"}),e.jsx("button",{onClick:()=>{c("JWK"),o(""),N(null),p(!1)},className:S("w-full px-4 py-2.5 text-left text-sm transition-colors focus:outline-none border-b border-gray-100 last:border-b-0",i==="JWK"?"bg-sky-50 text-sky-600 font-medium":"text-gray-700 hover:bg-gray-50"),tabIndex:0,children:"JWK"})]})]})]})]}),(a||n)&&e.jsxs("button",{onClick:()=>{o(""),m(""),N(null)},className:"inline-flex items-center gap-2 px-4 py-2 text-xs font-semibold text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 hover:border-gray-400 focus:outline-none focus:ring-2 focus:ring-sky-500 focus:ring-offset-1 transition-all shadow-sm hover:shadow",tabIndex:0,children:[e.jsx(ee,{className:"h-4 w-4"}),"Clear"]})]})]}),y&&!y.verified&&e.jsx("div",{className:"bg-red-50 border border-red-200 px-5 py-3 rounded-lg",children:e.jsxs("div",{className:"flex items-center gap-3 text-sm text-red-700 font-medium",children:[e.jsx(ee,{className:"h-5 w-5 flex-shrink-0"}),e.jsx("span",{children:y.error||"Signature verification failed"})]})})]})]})]})]}),!U&&e.jsxs("div",{className:"mb-6 bg-white border border-gray-200 rounded-xl shadow-sm px-6 py-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4 pb-3 border-b border-gray-200",children:[e.jsx(Be,{className:"h-5 w-5 text-gray-600"}),e.jsx("span",{className:"text-base font-semibold text-gray-900",children:"JWKS (JSON Web Key Set)"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"url",value:Y,onChange:s=>qe(s.target.value),placeholder:"https://example.com/.well-known/jwks.json",className:"flex-1 border border-gray-300 rounded-lg bg-white px-4 py-2.5 text-sm text-gray-900 placeholder:text-gray-400 focus:outline-none focus:ring-2 focus:ring-sky-500 focus:border-sky-500 transition-all",onKeyDown:s=>{s.key==="Enter"&&Je()}}),e.jsx("button",{onClick:Je,disabled:Ae||!Y.trim(),className:"inline-flex items-center gap-2 px-5 py-2.5 text-sm font-semibold text-white bg-sky-500 hover:bg-sky-600 rounded-lg transition-all disabled:bg-gray-300 disabled:cursor-not-allowed disabled:hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-sky-500 focus:ring-offset-2 shadow-sm hover:shadow",children:Ae?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"h-4 w-4 border-2 border-slate-400 border-t-transparent rounded-full animate-spin"}),"Loading..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Le,{className:"h-4 w-4"}),"Fetch"]})})]}),Te&&e.jsx("div",{className:"bg-red-50 border border-red-200 px-4 py-3 rounded-lg text-sm text-red-700 font-medium",children:Te}),O&&O.keys&&O.keys.length>0&&e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Select Key:"}),e.jsxs("select",{value:ne,onChange:s=>De(s.target.value),className:"w-full border border-gray-300 rounded-lg bg-white px-4 py-2.5 text-sm text-gray-900 focus:outline-none focus:ring-2 focus:ring-sky-500 focus:border-sky-500 transition-all cursor-pointer hover:bg-gray-50",children:[e.jsx("option",{value:"",children:"-- Select a key --"}),O.keys.map((s,d)=>e.jsxs("option",{value:s.kid||d,children:[s.kid||`Key ${d+1}`," (",s.alg||"N/A",")"]},d))]}),e.jsxs("p",{className:"text-xs text-gray-500",children:["Found ",O.keys.length," key(s). ",ne?"Key selected for verification.":"Select a key to use for verification."]})]})]})]}),ze&&e.jsxs("div",{className:"mb-6 bg-white border border-gray-200 rounded-xl shadow-sm overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between border-b border-gray-200 bg-gray-50 px-6 py-4 cursor-pointer hover:bg-gray-100 transition-colors",onClick:()=>Ie(!se),children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsx(vt,{className:"h-4 w-4 text-gray-600"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:"Time Simulation"}),!se&&e.jsxs("span",{className:"text-xs text-gray-500 ml-2",children:[G?`Simulated: ${new Date(G).toLocaleString()}`:"Real time",g?.exp&&` • Token ${g.exp*1e3<Z?"expired":"valid"}`]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("button",{onClick:s=>{s.stopPropagation(),Ie(!se)},className:"p-1 text-gray-500 hover:text-gray-700 transition-colors focus:outline-none",tabIndex:0,children:se?e.jsx(de,{className:"h-4 w-4"}):e.jsx(P,{className:"h-4 w-4"})})})]}),se&&e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-4 flex-wrap",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 whitespace-nowrap",children:"Current Time:"}),e.jsx("input",{type:"datetime-local",value:G?new Date(G).toISOString().slice(0,16):new Date().toISOString().slice(0,16),onChange:s=>{const d=new Date(s.target.value).getTime();ye(d)},className:"border border-gray-300 rounded bg-white px-3 py-1.5 text-sm text-gray-900 focus:outline-none focus:ring-2 focus:ring-sky-500 focus:border-sky-500 transition-colors"}),e.jsx("button",{onClick:()=>{const s=Date.now(),d=prompt("Fast-forward hours (negative to go back):","0");d!==null&&!isNaN(parseFloat(d))&&ye(s+parseFloat(d)*60*60*1e3)},className:"px-3 py-1.5 text-xs font-medium text-gray-700 hover:text-gray-900 transition-colors focus:outline-none",children:"Fast Forward"}),e.jsx("button",{onClick:()=>ye(null),className:"px-3 py-1.5 text-xs font-medium text-gray-700 hover:text-gray-900 transition-colors focus:outline-none",children:"Reset"})]}),g?.exp&&e.jsx("div",{className:"pt-3 border-t border-gray-100",children:e.jsxs("p",{className:"text-sm text-gray-600",children:["Token ",g.exp*1e3<Z?"expired":"valid"," at simulated time"]})})]})]}),ve&&g&&e.jsxs("div",{className:"mb-6 bg-white border border-gray-200 rounded-xl shadow-sm overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between border-b border-gray-200 bg-gray-50 px-6 py-4 cursor-pointer hover:bg-gray-100 transition-colors",onClick:()=>Ee(!re),children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsx(St,{className:"h-5 w-5 text-slate-600"}),e.jsx("span",{className:"text-base font-semibold text-slate-900",children:"Redact Sensitive Claims"}),!re&&e.jsxs("span",{className:"text-xs text-slate-500 ml-2",children:["• ",Q.length," claim",Q.length!==1?"s":""," selected",me?" • Redacted token ready":""]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("button",{onClick:s=>{s.stopPropagation(),Ee(!re)},className:"p-1.5 hover:bg-slate-200 rounded-lg transition focus:outline-none focus:ring-2 focus:ring-slate-300",tabIndex:0,children:re?e.jsx(de,{className:"h-4 w-4 text-slate-600"}):e.jsx(P,{className:"h-4 w-4 text-slate-600"})})})]}),re&&e.jsxs("div",{className:"p-6 space-y-5",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Select claims to redact:"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2 max-h-48 overflow-y-auto",children:Object.keys(g).map(s=>e.jsxs("label",{className:"flex items-center gap-2 p-2 rounded border border-slate-200 hover:bg-slate-50 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:Q.includes(s),onChange:()=>lt(s),className:"rounded"}),e.jsxs("span",{className:S("text-sm",pe(s)?"font-semibold text-red-700":"text-slate-700"),children:[s,pe(s)&&e.jsx("span",{className:"ml-1 text-xs text-red-500",children:"(sensitive)"})]})]},s))})]}),me&&e.jsxs("div",{className:"pt-3 border-t border-gray-100",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Redacted Token:"}),e.jsx("textarea",{value:me,readOnly:!0,className:"w-full h-24 resize-none border border-gray-300 rounded bg-gray-50 px-3 py-2 font-mono text-xs text-gray-700"}),e.jsxs("button",{onClick:()=>z(me),className:"mt-2 inline-flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-gray-700 hover:text-gray-900 transition-colors focus:outline-none",children:[e.jsx(ke,{className:"h-3.5 w-3.5"}),"Copy Redacted Token"]})]})]})]}),Qe&&e.jsxs("div",{className:"mb-6 bg-white border border-gray-200 rounded-xl shadow-sm overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between border-b border-gray-200 bg-gray-50 px-6 py-4 cursor-pointer hover:bg-gray-100 transition-colors",onClick:()=>Me(!ae),children:[e.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[e.jsx(Nt,{className:"h-4 w-4 text-gray-600"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:"Compare Tokens"}),!ae&&e.jsx("span",{className:"text-xs text-gray-500 ml-2",children:b?`${b.summary.headerChanges+b.summary.payloadChanges} difference${b.summary.headerChanges+b.summary.payloadChanges!==1?"s":""}`:"Paste second token to compare"})]}),e.jsx("button",{onClick:s=>{s.stopPropagation(),Me(!ae)},className:"p-1 text-gray-500 hover:text-gray-700 transition-colors focus:outline-none",tabIndex:0,children:ae?e.jsx(de,{className:"h-4 w-4"}):e.jsx(P,{className:"h-4 w-4"})})]}),ae&&e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Second Token:"}),e.jsx("textarea",{value:he,onChange:s=>Xe(s.target.value),placeholder:"Paste the second JWT token to compare",className:"w-full h-32 resize-none border border-gray-300 rounded bg-white px-3 py-2 font-mono text-sm text-gray-900 placeholder:text-gray-400 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500 transition-colors"})]}),e.jsx("button",{onClick:ct,disabled:!t||!he,className:"px-4 py-2 text-sm font-medium text-white bg-sky-500 hover:bg-sky-600 rounded-lg transition-colors disabled:bg-gray-300 disabled:cursor-not-allowed disabled:hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-sky-500 focus:ring-offset-1",children:"Compare Tokens"}),b&&e.jsxs("div",{className:"pt-3 border-t border-gray-100 space-y-3",children:[e.jsxs("div",{className:"bg-gray-50 px-3 py-2 rounded",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 mb-1",children:"Summary:"}),e.jsx("p",{className:"text-sm text-gray-700",children:b?Ft(b):""})]}),b.valid&&e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 mb-2",children:"Header Changes:"}),e.jsxs("div",{className:"space-y-1 text-xs",children:[b.headerDiff.added.length>0&&e.jsxs("div",{className:"text-green-700",children:["+ ",b.headerDiff.added.length," added"]}),b.headerDiff.removed.length>0&&e.jsxs("div",{className:"text-red-700",children:["- ",b.headerDiff.removed.length," removed"]}),b.headerDiff.changed.length>0&&e.jsxs("div",{className:"text-yellow-700",children:["~ ",b.headerDiff.changed.length," changed"]})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 mb-2",children:"Payload Changes:"}),e.jsxs("div",{className:"space-y-1 text-xs",children:[b.payloadDiff.added.length>0&&e.jsxs("div",{className:"text-green-700",children:["+ ",b.payloadDiff.added.length," added"]}),b.payloadDiff.removed.length>0&&e.jsxs("div",{className:"text-red-700",children:["- ",b.payloadDiff.removed.length," removed"]}),b.payloadDiff.changed.length>0&&e.jsxs("div",{className:"text-yellow-700",children:["~ ",b.payloadDiff.changed.length," changed"]})]})]})]})]})]})]})]})]})})]})};ft.createRoot(document.getElementById("root")).render(e.jsx(ts,{}));
//# sourceMappingURL=jwt-iT66xNS3.js.map
