import{c as H,S as X,F as Z,R as G,j as e,r as N,a as J}from"./styles-DKyjvD9O.js";import{K as Q,N as q,F as Y,c as v}from"./clsx-z0O_71pp.js";import{N as ee,C as K}from"./Navigation-D7Om55Ur.js";import{R as te}from"./refresh-cw-Cq62rDJ5.js";import{T as se}from"./trash-2-BGmRePPO.js";import{L as ae,a as re}from"./list-tree-DKN-3JGS.js";import{I as ne}from"./info-Dt03Go15.js";import{C as le}from"./clock-COl7W2MF.js";import{C as _}from"./circle-check-C2c164ka.js";import{C as oe}from"./chevron-down-CuuRSaY2.js";const ie=[["path",{d:"M12 10a2 2 0 0 0-2 2c0 1.02-.1 2.51-.26 4",key:"1nerag"}],["path",{d:"M14 13.12c0 2.38 0 6.38-1 8.88",key:"o46ks0"}],["path",{d:"M17.29 21.02c.12-.6.43-2.3.5-3.02",key:"ptglia"}],["path",{d:"M2 12a10 10 0 0 1 18-6",key:"ydlgp0"}],["path",{d:"M2 16h.01",key:"1gqxmh"}],["path",{d:"M21.8 16c.2-2 .131-5.354 0-6",key:"drycrb"}],["path",{d:"M5 19.5C5.5 18 6 15 6 12a6 6 0 0 1 .34-2",key:"1tidbn"}],["path",{d:"M8.65 22c.21-.66.45-1.32.57-2",key:"13wd9y"}],["path",{d:"M9 6.8a6 6 0 0 1 9 5.2v2",key:"1fr1j5"}]],ce=H("fingerprint-pattern",ie);X,chrome.runtime?.getURL&&chrome.runtime.getURL("jwt.html"),Q,chrome.runtime?.getURL&&chrome.runtime.getURL("saml.html"),q,chrome.runtime?.getURL&&chrome.runtime.getURL("rest.html"),Y,chrome.runtime?.getURL&&chrome.runtime.getURL("har-analyzer.html"),Z,chrome.runtime?.getURL&&chrome.runtime.getURL("json-utility.html");const R=async a=>{if(a)try{await navigator.clipboard.writeText(a)}catch(l){console.error("Unable to copy value",l)}},de=a=>{if(!a)return"";const l="  ";let d=0;return a.replace(/>\s+</g,"><").replace(/</g,"~::~<").split("~::~").map(c=>{if(!c)return"";c.match(/^<\/\w/)&&(d-=1);const s=`${l.repeat(Math.max(d,0))}${c}`;return c.match(/^<\w([^>]*[^/])?>.*$/)&&!c.includes("</")&&(d+=1),s}).join(`
`).trim()},me=a=>{const l=a.replace(/\s+/g,"");if(!l)return"";const d=l.length%4?4-l.length%4:0,c=l+"=".repeat(d);try{return atob(c)}catch{throw new Error("Could not Base64 decode payload")}},P=(a,l)=>a?.querySelector(l)?.textContent?.trim()||"",ue=a=>{if(!a)return null;try{const l=a.replace(/\s+/g,""),d=`-----BEGIN CERTIFICATE-----
${l.match(/.{1,64}/g)?.join(`
`)||l}
-----END CERTIFICATE-----`,c=atob(l),s=new Uint8Array(c.length);for(let r=0;r<c.length;r++)s[r]=c.charCodeAt(r);let x="—",m="—",g="—";const u=new TextDecoder("latin1",{fatal:!1}).decode(s);let y=u.match(/CN\s*=\s*([^,\x00\n<>]+)/i);if(y||(y=u.match(/(?:^|[^A-Za-z])CN\s+([A-Za-z0-9._-]+)/i)),y||(y=u.match(/([a-z0-9][a-z0-9.-]+\.[a-z]{2,})/i)),y){const r=y[1]||y[0],n=u.indexOf(y[0]);if(n>0){const o=Math.max(0,n-200),f=Math.min(u.length,n+400),p=u.substring(o,f),j=[/(?:CN|OU|O|L|ST|C|DC|EMAIL|E|UID)\s*=\s*[^,\x00\n<>]+(?:\s*,\s*(?:CN|OU|O|L|ST|C|DC|EMAIL|E|UID)\s*=\s*[^,\x00\n<>]+)*/i,/(?:CN|OU|O|L|ST|C|DC|EMAIL|E|UID)=[^,\x00\n<>]+(?:,\s*[A-Z]+=[^,\x00\n<>]+)*/i];let i=null;for(const M of j)if(i=p.match(M),i)break;i?x=i[0].replace(/\x00/g,"").replace(/\s+/g," ").replace(/,/g,", ").trim():x=`CN=${r.replace(/\x00/g,"").trim()}`}else x=`CN=${r.replace(/\x00/g,"").trim()}`}let S=-1,A=0;for(let r=0;r<s.length-5;r++)if(s[r]===48){let n=s[r+1],o=1;if(n&128){if(o=n&127,o>0&&o<=4&&r+2+o<s.length){n=0;for(let f=0;f<o;f++)n=n<<8|s[r+2+f];A=n}}else A=n;S=r;break}if(S>=0){let r=S;if(s[r]===48){r++;let n=s[r];if(n&128){const o=n&127;r+=1+o}else r+=1}if(r<s.length&&(s[r]===160||s[r]===161)){r++;let n=s[r],o=1;if(n&128)if(o=n&127,o>0&&o<=4&&r+1+o<s.length){n=0;for(let f=0;f<o;f++)n=n<<8|s[r+1+f];r+=1+o+n}else r+=1+n;else r+=1+n}if(r<s.length&&s[r]===2){r++;let n=s[r],o=r+1;if(n&128){const f=n&127;if(f>0&&f<=4&&r+1+f<s.length){n=0;for(let p=0;p<f;p++)n=n<<8|s[r+1+p];o=r+1+f}else n=0}if(n>0&&n<=20&&o+n<s.length){const f=s.slice(o,o+n);m=Array.from(f).map(p=>p.toString(16).padStart(2,"0")).join("").toLowerCase()}}}if(m==="—"){const r=[];for(let n=0;n<s.length-10;n++)if(s[n]===2){let o=s[n+1],f=n+2;if(o&128){const p=o&127;if(p>0&&p<=4&&n+2+p<s.length){o=0;for(let j=0;j<p;j++)o=o<<8|s[n+2+j];f=n+2+p}else continue}if(o>0&&o<=20&&f+o<s.length){const p=s.slice(f,f+o);p.some(i=>i!==0)&&o>=4&&o<=16&&r.push({bytes:p,length:o,position:n})}}if(r.length>0){const n=r.find(o=>o.length>=8&&o.length<=16)||r[0];m=Array.from(n.bytes).map(o=>o.toString(16).padStart(2,"0")).join("").toLowerCase()}}return{pem:d,raw:l,snippet:l?`${l.slice(0,32)}…${l.slice(-16)}`:"",subject:x,serialNumber:m,thumbprint:g,bytes:s}}catch(l){return console.error("Certificate parsing error:",l),null}},he=a=>{if(!a.trim())return{error:"",assertionXml:"",attributes:[],certificates:[],meta:{},samlInfo:{},signature:{}};const d=new DOMParser().parseFromString(a,"text/xml");if(d.getElementsByTagName("parsererror").length>0)return{error:"XML parser error - check for malformed assertion.",assertionXml:a,attributes:[],certificates:[],meta:{},samlInfo:{},signature:{}};const c=d.getElementsByTagNameNS("*","Assertion")[0],s=d.getElementsByTagNameNS("*","AuthnRequest")[0]||d.getElementsByTagNameNS("*","LogoutRequest")[0],x=d.getElementsByTagNameNS("*","Response")[0],m=x?"Response":s?"Request":"Assertion",g=x?.getAttribute("ID")||"",b=c?.getAttribute("ID")||"",u=P(d,"Issuer")||s?.getAttribute("Issuer")||x?.getAttribute("Issuer")||"",y=P(d,"Subject NameID"),S=P(d,"AudienceRestriction Audience"),A=c?.getAttribute("IssueInstant")||s?.getAttribute("IssueInstant")||x?.getAttribute("IssueInstant")||"",r=c?.getElementsByTagNameNS("*","Conditions")[0],n=r?.getAttribute("NotBefore")||"",o=r?.getAttribute("NotOnOrAfter")||"",f=d.querySelector("SubjectConfirmation")?.getAttribute("Method")||"",p=d.querySelector('[Algorithm*="SignatureMethod"]')?.getAttribute("Algorithm")||"",j=d.querySelector('[Algorithm*="DigestMethod"]')?.getAttribute("Algorithm")||"",i=c?.getAttribute("Version")||s?.getAttribute("Version")||x?.getAttribute("Version")||"2.0",M=c?.namespaceURI||s?.namespaceURI||x?.namespaceURI||"",E=s?.getAttribute("ProtocolBinding")||"",I=s?.getAttribute("Destination")||x?.getAttribute("Destination")||"",k=s?.getAttribute("AssertionConsumerServiceURL")||"",t=d.querySelector("NameID")?.getAttribute("Format")||"";let h=[];if(c&&(h=Array.from(c.getElementsByTagName("Attribute")),h.length===0)){const w=c.getElementsByTagNameNS("*","AttributeStatement")[0]||c.getElementsByTagName("AttributeStatement")[0];w&&(h=Array.from(w.getElementsByTagName("Attribute")))}const C=h.map(w=>{const D=w.getAttribute("Name")||w.getAttribute("FriendlyName")||"Attribute",z=Array.from(w.getElementsByTagName("AttributeValue")).map(W=>W.textContent?.trim()||"");return{name:D,values:z}}),T=Array.from(d.getElementsByTagNameNS("*","X509Certificate")).map(w=>{const D=w.textContent?.replace(/\s+/g,"")??"",$=ue(D);if($){const{bytes:z,...W}=$;return W}return{raw:D,snippet:D?`${D.slice(0,32)}…${D.slice(-16)}`:"",pem:"",subject:"—",serialNumber:"—",thumbprint:"—"}}),L=x?.getElementsByTagNameNS("*","Signature")[0],O=c?.getElementsByTagNameNS("*","Signature")[0],V=!!L,U=!!O;return{error:"",assertionXml:new XMLSerializer().serializeToString(c||s||x||d),fullXml:a,attributes:C,certificates:T,meta:{issuer:u,subject:y,audience:S,issueInstant:A,notBefore:n,notOnOrAfter:o,signatureMethod:p,digestMethod:j,subjectConfirmation:f,assertionId:b,responseId:g},samlInfo:{messageType:m,samlVersion:i,samlProtocol:M,binding:E,destination:I,acsUrl:k,nameIdFormat:t},signature:{responseSigned:V,assertionSigned:U}}},xe=a=>{if(!a)return"";let l=a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");return l=l.replace(/(&lt;)(\/?)([\w:]+)([^&]*?)(\/?&gt;)/g,(d,c,s,x,m,g)=>{let b=`<span class="text-blue-400">${c}${s}</span><span class="text-blue-400 font-semibold">${x}</span>`;return m&&(b+=m.replace(/(\w+)(=)(".*?"|'.*?')/g,(u,y,S,A)=>`<span class="text-cyan-400">${y}</span><span class="text-slate-400">${S}</span><span class="text-orange-400">${A}</span>`)),b+=`<span class="text-blue-400">${g}</span>`,b}),l},fe=({meta:a,certificates:l,parseError:d,decodeError:c,warnings:s,signature:x})=>{if(c)return{status:"error",message:"Decode failed",details:c};if(d)return{status:"error",message:"Invalid XML",details:d};const m=Date.now(),g=300*1e3,b=a.notBefore?Date.parse(a.notBefore):null,u=a.notOnOrAfter?Date.parse(a.notOnOrAfter):null;return b&&m+g<b?{status:"warning",message:"Not yet valid",details:`Starts ${new Date(b).toLocaleString()}`}:u&&m-g>u?{status:"error",message:"Expired",details:`Expired ${new Date(u).toLocaleString()}`}:l.length===0&&x.assertionSigned?{status:"warning",message:"Missing certificate",details:"Signature present but no certificate found."}:s&&s.length>0?{status:"warning",message:"Validation warnings",details:`${s.length} issue(s) found.`}:{status:"success",message:"Successful",details:"SAML message is valid."}},F=a=>{if(!a)return"";try{const l=new Date(a),c=new Date-l,s=Math.floor(c/(1e3*60*60*24*365));if(s>0)return`${a} (${s} year${s>1?"s":""} ago)`;const x=Math.floor(c/(1e3*60*60*24));if(x>0)return`${a} (${x} day${x>1?"s":""} ago)`;const m=Math.floor(c/(1e3*60*60));return m>0?`${a} (${m} hour${m>1?"s":""} ago)`:a}catch{return a}},ge=({certificate:a})=>{const[l,d]=N.useState(!1),[c,s]=N.useState(!1),x=async()=>{await R(a.pem||a.raw),s(!0),setTimeout(()=>s(!1),2e3)};return e.jsxs("div",{className:"rounded-lg border-2 bg-white p-5 shadow-sm",style:{borderColor:"#fef3c7",backgroundColor:"#fffbeb"},children:[e.jsxs("div",{className:"mb-4 flex items-center gap-2",children:[e.jsx(ce,{className:"h-5 w-5",style:{color:"#f59e0b"}}),e.jsx("h4",{className:"text-sm font-bold",style:{color:"#d97706"},children:"CERTIFICATE"})]}),e.jsxs("dl",{className:"space-y-2.5",children:[[{label:"Subject",value:a.subject||"CN=...",fullWidth:!0},{label:"SerialNumber",value:a.serialNumber||"—",fullWidth:!0},{label:"Thumbprint",value:a.thumbprint||"—",fullWidth:!0}].map(m=>e.jsx("div",{className:"rounded-lg border border-slate-200 bg-slate-50 px-3 py-2.5",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsxs("span",{className:"font-semibold text-slate-700 text-sm flex-shrink-0 min-w-[110px]",children:[m.label,":"]}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsx("div",{className:"text-right",children:e.jsx("span",{className:"font-mono font-semibold text-slate-900 text-sm break-words whitespace-normal inline-block",style:{textAlign:"right",wordBreak:"break-word",overflowWrap:"break-word"},children:m.value})})})]})},m.label)),e.jsxs("div",{className:"mt-3",children:[e.jsxs("button",{onClick:()=>d(!l),onKeyDown:m=>{(m.key==="Enter"||m.key===" ")&&(m.preventDefault(),d(!l))},className:"w-full text-left rounded-lg border border-slate-200 bg-slate-50 px-3 py-2 text-xs text-slate-700 hover:bg-slate-100 hover:border-slate-300 transition flex items-center justify-between active:scale-[0.98] focus:outline-none focus:ring-2 focus:ring-slate-300",tabIndex:0,children:[e.jsx("span",{children:"Pem"}),e.jsx(oe,{className:v("h-3 w-3 transition-transform duration-200",l&&"rotate-180")})]}),l&&e.jsxs("div",{className:"mt-2 rounded-lg border border-slate-200 bg-slate-950 p-3 animate-in fade-in duration-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-xs text-slate-400",children:"Certificate PEM"}),e.jsxs("button",{onClick:x,onKeyDown:m=>{(m.key==="Enter"||m.key===" ")&&(m.preventDefault(),x())},className:"inline-flex items-center gap-1 rounded px-2 py-1 text-xs text-slate-400 hover:text-slate-200 hover:bg-slate-800 transition active:scale-95 focus:outline-none focus:ring-2 focus:ring-slate-600",tabIndex:0,children:[c?e.jsx(_,{className:"h-3 w-3 text-success"}):e.jsx(K,{className:"h-3 w-3"}),c?"Copied!":"Copy"]})]}),e.jsx("pre",{className:"text-xs text-slate-300 font-mono whitespace-pre-wrap break-words overflow-auto max-h-48 leading-tight",children:a.pem||a.raw})]})]})]})]})},pe=({xml:a,onCopy:l})=>{const[d,c]=N.useState(!1),[s,x]=N.useState(!0),m=N.useMemo(()=>de(a),[a]),g=m.split(`
`),b=async()=>{await l(m),c(!0),setTimeout(()=>c(!1),2e3)};return e.jsxs("div",{className:"rounded-xl border-2 border-slate-200 bg-white shadow-sm overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between border-b-2 border-slate-200 bg-slate-50/50 px-6 py-3",children:[e.jsxs("div",{className:"flex items-center gap-2.5",children:[e.jsx("div",{className:"h-1.5 w-1.5 rounded-full bg-slate-400"}),e.jsx("h3",{className:"text-sm font-semibold text-slate-900",children:"DECODED"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("label",{className:"flex items-center gap-2 text-xs text-slate-700 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:s,onChange:u=>x(u.target.checked),className:"h-4 w-4 rounded border-slate-300"}),e.jsx("span",{children:"Line wrap"})]}),e.jsxs("button",{onClick:b,onKeyDown:u=>{(u.key==="Enter"||u.key===" ")&&(u.preventDefault(),b())},onMouseDown:u=>{u.currentTarget.style.transform="scale(0.95)"},onMouseUp:u=>{u.currentTarget.style.transform=""},className:"inline-flex items-center gap-1.5 rounded-lg px-3 py-1.5 text-xs font-medium text-slate-600 hover:bg-slate-100 hover:text-slate-900 transition active:scale-95 border border-slate-200 focus:outline-none focus:ring-2 focus:ring-slate-300",tabIndex:0,children:[d?e.jsx(_,{className:"h-3.5 w-3.5 text-success"}):e.jsx(K,{className:"h-3.5 w-3.5"}),d?"Copied!":"Copy"]})]})]}),e.jsx("div",{className:"overflow-auto bg-slate-950",style:{maxHeight:"500px"},children:e.jsx("pre",{className:v("p-6 text-sm leading-tight text-slate-100 font-mono",s?"whitespace-pre-wrap break-words":"whitespace-pre"),children:e.jsx("code",{children:g.map((u,y)=>e.jsxs(J.Fragment,{children:[e.jsx("span",{className:"inline-block w-10 select-none text-right text-slate-500 pr-4 flex-shrink-0",children:y+1}),e.jsx("span",{className:"text-slate-100",dangerouslySetInnerHTML:{__html:xe(u)}}),`
`]},y))})})})]})},be=()=>{const[a,l]=N.useState(""),[d,c]=N.useState(!0),[s,x]=N.useState([]),[m,g]=N.useState(null),[b,u]=N.useState("manual"),[y,S]=N.useState(!1),[A,r]=N.useState(!0),[n,o]=N.useState(""),f=async()=>{if(chrome.runtime){S(!0);try{const t=await chrome.runtime.sendMessage({action:"get_saml_messages"});if(chrome.runtime.lastError)return;t&&t.messages&&(x(t.messages),t.messages.length>0&&!m&&(g(t.messages[0]),l(t.messages[0].samlData),u("captured")))}catch(t){t.message&&!t.message.includes("Receiving end does not exist")&&!t.message.includes("Could not establish connection")&&console.error("Failed to load messages",t)}finally{S(!1)}}},p=async()=>{if(chrome.runtime)try{if(await chrome.runtime.sendMessage({action:"clear_saml_messages"}),chrome.runtime.lastError){x([]),g(null),l(""),u("manual");return}x([]),g(null),l(""),u("manual")}catch(t){t.message&&!t.message.includes("Receiving end does not exist")&&!t.message.includes("Could not establish connection")&&console.error("Failed to clear messages",t),x([]),g(null),l(""),u("manual")}};N.useEffect(()=>{if(chrome.runtime&&chrome.runtime.id){f();const t=(h,C,B)=>(h&&h.type==="SAML_MESSAGE_CAPTURED"&&f(),!0);try{return chrome.runtime.onMessage.addListener(t),()=>{try{chrome.runtime.onMessage.removeListener(t)}catch{}}}catch{}}},[]),N.useEffect(()=>{if(!chrome.runtime||!chrome.runtime.id)return;const t=setInterval(()=>{b==="captured"&&f()},2e3);return()=>clearInterval(t)},[b]);const j=N.useMemo(()=>{if(!a.trim())return{text:"",error:""};if(!d)return{text:a,error:""};try{return{text:me(a),error:""}}catch(t){return{text:a,error:t.message||"Base64 decode failed"}}},[a,d]),i=N.useMemo(()=>he(j.text),[j.text]),[M,E]=N.useState(i.certificates);N.useEffect(()=>{(async()=>{if(i.certificates.length>0){const h=await Promise.all(i.certificates.map(async C=>{if(C.raw&&C.thumbprint==="—")try{const B=C.raw.replace(/\s+/g,""),T=atob(B),L=new Uint8Array(T.length);for(let w=0;w<T.length;w++)L[w]=T.charCodeAt(w);const O=await crypto.subtle.digest("SHA-1",L),U=Array.from(new Uint8Array(O)).map(w=>w.toString(16).padStart(2,"0")).join("").toUpperCase();return{...C,thumbprint:U}}catch{return C}return C}));E(h)}else E(i.certificates)})()},[i.certificates]);const I=[];j.error&&I.push(j.error),i.error&&I.push(i.error),(!i.meta.notBefore||!i.meta.notOnOrAfter)&&I.push("Conditions (NotBefore/NotOnOrAfter) missing."),i.meta.signatureMethod||I.push("Signature method not specified.");const k=fe({meta:i.meta,certificates:M,parseError:i.error,decodeError:j.error,warnings:I,signature:i.signature});return e.jsxs("div",{className:"flex h-screen bg-slate-50 overflow-hidden",children:[e.jsx(ee,{currentPageId:"saml",sidebarOpen:A,onSidebarToggle:r}),e.jsx("div",{className:"flex-1 overflow-hidden flex flex-col",style:{width:"100%",minWidth:0},children:e.jsxs("div",{className:"mx-auto max-w-[1400px] w-full px-6 py-8 flex-1 flex flex-col min-h-0 bg-white",children:[e.jsx("header",{className:"pb-4 border-b border-gray-200 mb-4",children:e.jsx("h1",{className:"text-2xl font-semibold text-gray-900 mb-1",children:"SAML Inspector"})}),e.jsxs("div",{className:"flex-1 overflow-y-auto min-h-0 space-y-6",children:[e.jsx("p",{className:"text-sm text-slate-600 mb-4",children:"Decode base64 responses, inspect assertions, and automatically trace SAML requests/responses from your browser."}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2 rounded-xl border-2 border-slate-200 bg-white p-1",children:[e.jsx("button",{onClick:()=>{u("manual"),g(null)},onKeyDown:t=>{(t.key==="Enter"||t.key===" ")&&(t.preventDefault(),u("manual"),g(null))},className:v("px-4 py-2 text-sm font-medium rounded-lg transition focus:outline-none focus:ring-2 focus:ring-slate-300",b==="manual"?"bg-slate-900 text-white":"text-slate-700 hover:bg-slate-50"),tabIndex:0,children:"Manual Input"}),e.jsxs("button",{onClick:()=>{u("captured"),f()},onKeyDown:t=>{(t.key==="Enter"||t.key===" ")&&(t.preventDefault(),u("captured"),f())},className:v("px-4 py-2 text-sm font-medium rounded-lg transition flex items-center gap-2 focus:outline-none focus:ring-2 focus:ring-slate-300",b==="captured"?"bg-slate-900 text-white":"text-slate-700 hover:bg-slate-50"),tabIndex:0,children:[e.jsx(q,{className:"h-4 w-4"}),"Captured Messages",s.length>0&&e.jsx("span",{className:"ml-1 px-2 py-0.5 text-xs bg-white/20 rounded-full",children:s.length})]})]}),b==="captured"&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:f,onKeyDown:t=>{(t.key==="Enter"||t.key===" ")&&!y&&(t.preventDefault(),f())},disabled:y,className:"inline-flex items-center gap-2 rounded-xl border-2 border-slate-200 bg-white px-3 py-2 text-sm font-medium text-slate-700 transition hover:bg-slate-50 active:scale-95 focus:outline-none focus:ring-2 focus:ring-slate-300 disabled:opacity-50 disabled:cursor-not-allowed",tabIndex:y?-1:0,children:[e.jsx(te,{className:v("h-4 w-4",y&&"animate-spin")}),"Refresh"]}),e.jsxs("button",{onClick:p,onKeyDown:t=>{(t.key==="Enter"||t.key===" ")&&(t.preventDefault(),p())},className:"inline-flex items-center gap-2 rounded-xl border-2 border-slate-200 bg-white px-3 py-2 text-sm font-medium text-slate-700 transition hover:bg-slate-50 hover:text-red-600 active:scale-95 focus:outline-none focus:ring-2 focus:ring-slate-300",tabIndex:0,children:[e.jsx(se,{className:"h-4 w-4"}),"Clear All"]})]})]}),b==="captured"&&e.jsxs("div",{className:"rounded-xl border-2 border-slate-200 bg-white shadow-sm overflow-hidden",children:[e.jsx("div",{className:"border-b-2 border-slate-200 bg-slate-50/50 px-6 py-3",children:e.jsx("h2",{className:"text-sm font-semibold text-slate-900",children:"Captured SAML Messages"})}),e.jsx("div",{className:"p-4",children:s.length===0?e.jsxs("div",{className:"text-center py-12 text-slate-500",children:[e.jsx(q,{className:"h-12 w-12 mx-auto mb-3 text-slate-300"}),e.jsx("p",{className:"text-sm",children:"No SAML messages captured yet."}),e.jsx("p",{className:"text-xs mt-2 text-slate-400",children:"Navigate to a SAML SSO flow to automatically capture messages."})]}):e.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:s.map(t=>e.jsx("button",{onClick:()=>{g(t),l(t.samlData)},onKeyDown:h=>{(h.key==="Enter"||h.key===" ")&&(h.preventDefault(),g(t),l(t.samlData))},className:v("w-full text-left rounded-xl border-2 p-4 transition focus:outline-none focus:ring-2 focus:ring-slate-300",m?.id===t.id?"border-slate-900 bg-slate-50":"border-slate-200 bg-white hover:border-slate-300 hover:bg-slate-50"),tabIndex:0,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:v("px-2.5 py-1 rounded-lg text-xs font-semibold",t.type==="request"?"bg-blue-100 text-blue-700":t.type==="response"?"bg-green-100 text-green-700":"bg-slate-100 text-slate-700"),children:t.type.toUpperCase()}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-medium text-slate-900",children:[t.method," Request"]}),e.jsx("p",{className:"text-xs text-slate-500 mt-0.5 truncate max-w-md",children:t.url})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-xs text-slate-500",children:new Date(t.timestamp).toLocaleTimeString()}),e.jsx("p",{className:"text-xs text-slate-400 mt-0.5",children:new Date(t.timestamp).toLocaleDateString()})]})]})},t.id))})})]}),e.jsxs("div",{className:"rounded-xl border-2 border-slate-200 bg-white shadow-sm overflow-hidden",children:[e.jsxs("div",{className:"relative border-b-2 border-slate-200 bg-slate-50/50 px-6 py-3",children:[e.jsx("div",{className:"absolute left-0 top-0 bottom-0 w-1 rounded-l-xl bg-slate-400"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{htmlFor:"saml-input",className:"text-sm font-semibold text-slate-900",children:"SAML TOKEN"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("label",{className:"flex items-center gap-2 text-xs text-slate-700",children:[e.jsx("input",{type:"checkbox",checked:d,onChange:()=>c(t=>!t),className:"h-4 w-4 rounded border-slate-300 text-primary focus:ring-primary"}),"Auto Base64 Decode"]}),e.jsx("button",{onClick:()=>{l(""),g(null)},onKeyDown:t=>{(t.key==="Enter"||t.key===" ")&&(t.preventDefault(),l(""),g(null))},onMouseDown:t=>{t.currentTarget.style.transform="scale(0.95)"},onMouseUp:t=>{t.currentTarget.style.transform=""},className:"rounded-xl border border-slate-200 bg-white px-3 py-1.5 text-xs font-medium text-slate-700 transition hover:bg-slate-50 hover:border-slate-300 active:scale-95 focus:outline-none focus:ring-2 focus:ring-slate-300",tabIndex:0,children:"Clear"})]})]})]}),e.jsx("div",{children:e.jsx("textarea",{id:"saml-input",value:a,onChange:t=>l(t.target.value),placeholder:"Paste SAML response (Base64 encoded) or let the extension capture it automatically",className:"h-40 w-full resize-none border-0 bg-white px-6 py-5 font-mono text-base leading-relaxed text-slate-900 placeholder:text-slate-500 focus:outline-none"})}),a&&e.jsx("div",{className:v("border-t-2 border-slate-200 px-6 py-4",k.status==="success"?"bg-success/10 border-success/40 text-success":k.status==="warning"?"bg-warning/10 border-warning/40 text-warning":"bg-error/10 border-error/40 text-error"),children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:v("h-2.5 w-2.5 rounded-full",k.status==="success"?"bg-success":k.status==="warning"?"bg-warning":"bg-error")}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-sm",children:k.message}),e.jsx("p",{className:"text-xs text-slate-700 mt-0.5",children:k.details})]})]})})]}),a&&j.text&&e.jsx(pe,{xml:j.text,onCopy:R}),a&&e.jsxs("div",{className:"rounded-xl border-2 border-slate-200 bg-white shadow-sm overflow-hidden",children:[e.jsx("div",{className:"border-b-2 border-slate-200 bg-slate-50/50 px-6 py-3",children:e.jsxs("div",{className:"flex items-center gap-2.5",children:[e.jsx("div",{className:"h-1.5 w-1.5 rounded-full bg-slate-400"}),e.jsx("h3",{className:"text-sm font-bold text-slate-900",children:"SAML Information"})]})}),e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"grid gap-6 lg:grid-cols-3",children:[i.attributes.length>0&&e.jsx("div",{className:"lg:col-span-1",children:e.jsxs("div",{className:"rounded-lg border-2 bg-gradient-to-br p-5 h-full shadow-sm",style:{borderColor:"#dbeafe",backgroundColor:"#eff6ff",background:"linear-gradient(to bottom right, #eff6ff, #ffffff)"},children:[e.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ae,{className:"h-5 w-5",style:{color:"#60a5fa"}}),e.jsx("h4",{className:"text-sm font-bold",style:{color:"#3b82f6"},children:"SAML Claims"})]}),e.jsx("span",{className:"px-2.5 py-1 rounded-lg bg-slate-100 text-xs font-semibold text-slate-700",children:i.attributes.length})]}),e.jsx("div",{className:"space-y-2",style:{maxHeight:"400px",overflowY:"auto"},children:i.attributes.map(t=>e.jsxs("div",{className:"rounded-lg border border-slate-200 bg-white p-3 hover:border-slate-300 transition",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2 mb-2",children:[e.jsx("div",{className:"font-mono text-sm font-semibold text-slate-900 break-words flex-1",children:t.name}),e.jsx("button",{onClick:()=>R(t.values.join(", ")),onKeyDown:h=>{(h.key==="Enter"||h.key===" ")&&(h.preventDefault(),R(t.values.join(", ")))},onMouseDown:h=>{h.currentTarget.style.transform="scale(0.95)",h.currentTarget.style.backgroundColor="#e2e8f0"},onMouseUp:h=>{h.currentTarget.style.transform="",h.currentTarget.style.backgroundColor=""},onTouchStart:h=>{h.currentTarget.style.transform="scale(0.95)",h.currentTarget.style.backgroundColor="#e2e8f0"},onTouchEnd:h=>{setTimeout(()=>{h.currentTarget.style.transform="",h.currentTarget.style.backgroundColor=""},150)},className:"inline-flex items-center gap-1 rounded px-1.5 py-1 text-xs text-slate-600 hover:bg-slate-100 hover:text-slate-900 transition active:scale-95 flex-shrink-0 focus:outline-none focus:ring-2 focus:ring-slate-300",tabIndex:0,children:e.jsx(K,{className:"h-3 w-3"})})]}),e.jsx("div",{className:"space-y-1.5",children:t.values.map((h,C)=>e.jsx("div",{className:"text-sm text-slate-700 bg-slate-50 rounded px-2.5 py-2 break-words leading-tight font-medium",children:h||"—"},C))})]},t.name))})]})}),e.jsxs("div",{className:v("space-y-6",i.attributes.length>0?"lg:col-span-2":"lg:col-span-3"),children:[e.jsxs("div",{className:"grid gap-6 lg:grid-cols-2",children:[e.jsxs("div",{className:"rounded-lg border-2 bg-white p-5 shadow-sm",style:{borderColor:"#e0e7ff",backgroundColor:"#f8fafc"},children:[e.jsxs("div",{className:"mb-4 flex items-center gap-2",children:[e.jsx(ne,{className:"h-5 w-5",style:{color:"#6366f1"}}),e.jsx("h4",{className:"text-sm font-bold",style:{color:"#4f46e5"},children:"COMMON"})]}),e.jsx("dl",{className:"space-y-2.5",children:[{label:"Type",value:i.samlInfo.messageType,fullWidth:!1},{label:"Version",value:i.samlInfo.samlVersion,fullWidth:!1},{label:"Issuer",value:i.meta.issuer,fullWidth:!0},{label:"Destination",value:i.samlInfo.destination||"—",fullWidth:!0},{label:"IssueInstant",value:F(i.meta.issueInstant)||"—",fullWidth:!0}].map(t=>e.jsx("div",{className:"rounded-lg border border-slate-200 bg-slate-50 px-3 py-2.5",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsxs("span",{className:"font-semibold text-slate-700 text-sm flex-shrink-0 min-w-[110px]",children:[t.label,":"]}),e.jsx("div",{className:"flex-1 text-right",children:e.jsx("span",{className:v("font-semibold text-slate-900 text-sm break-words whitespace-normal inline-block",t.fullWidth?"":"truncate max-w-[140px]"),style:{textAlign:"right",width:"100%"},children:t.value})})]})},t.label))})]}),e.jsxs("div",{className:"rounded-lg border-2 bg-white p-5 shadow-sm",style:{borderColor:"#d1fae5",backgroundColor:"#f0fdf4"},children:[e.jsxs("div",{className:"mb-4 flex items-center gap-2",children:[e.jsx(X,{className:"h-5 w-5",style:{color:"#10b981"}}),e.jsx("h4",{className:"text-sm font-bold",style:{color:"#059669"},children:"SIGNATURE"})]}),e.jsx("dl",{className:"space-y-2.5",children:[{label:"SAML Response",value:i.signature.responseSigned?"Signed":"Not signed",fullWidth:!1},{label:"SAML Assertion",value:i.signature.assertionSigned?"Valid Signature":"Not signed",fullWidth:!1},{label:"Signature Method",value:i.meta.signatureMethod||"—",fullWidth:!0},{label:"Digest Method",value:i.meta.digestMethod||"—",fullWidth:!0}].map(t=>e.jsx("div",{className:"rounded-lg border border-slate-200 bg-slate-50 px-3 py-2.5",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsxs("span",{className:"font-semibold text-slate-700 text-sm flex-shrink-0 min-w-[130px]",children:[t.label,":"]}),e.jsx("div",{className:"flex-1 text-right",children:e.jsx("span",{className:v("font-semibold text-sm break-words whitespace-normal inline-block",t.value==="Valid Signature"?"text-success":t.value==="Signed"?"text-slate-900":"text-slate-600",t.fullWidth?"":"truncate max-w-[140px]"),style:{textAlign:"right",width:"100%"},children:t.value})})]})},t.label))})]})]}),e.jsxs("div",{className:"grid gap-6 lg:grid-cols-2",children:[M.length>0&&e.jsx(ge,{certificate:M[0]}),e.jsxs("div",{className:"rounded-lg border-2 bg-white p-5 shadow-sm",style:{borderColor:"#e9d5ff",backgroundColor:"#faf5ff"},children:[e.jsxs("div",{className:"mb-4 flex items-center gap-2",children:[e.jsx(re,{className:"h-5 w-5",style:{color:"#a855f7"}}),e.jsx("h4",{className:"text-sm font-bold",style:{color:"#9333ea"},children:"ASSERTION"})]}),e.jsx("dl",{className:"space-y-2.5",children:[{label:"NameID",value:i.meta.subject||"—",fullWidth:!0},{label:"Subject Confirmation",value:i.meta.subjectConfirmation||"—",fullWidth:!1},{label:"Audience",value:i.meta.audience||"—",fullWidth:!0},{label:"Assertion ID",value:i.meta.assertionId||"—",fullWidth:!0}].map(t=>e.jsx("div",{className:"rounded-lg border border-slate-200 bg-slate-50 px-3 py-2.5",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsxs("span",{className:"font-semibold text-slate-700 text-sm flex-shrink-0 min-w-[130px]",children:[t.label,":"]}),e.jsx("div",{className:"flex-1 text-right",children:e.jsx("span",{className:v("font-semibold text-slate-900 text-sm break-words whitespace-normal inline-block",t.fullWidth?"":"truncate max-w-[140px]"),style:{textAlign:"right",width:"100%"},children:t.value})})]})},t.label))})]})]}),e.jsxs("div",{className:"rounded-lg border-2 bg-white p-5 shadow-sm",style:{borderColor:"#cfe2ff",backgroundColor:"#eff6ff"},children:[e.jsxs("div",{className:"mb-4 flex items-center gap-2",children:[e.jsx(le,{className:"h-5 w-5",style:{color:"#3b82f6"}}),e.jsx("h4",{className:"text-sm font-bold",style:{color:"#2563eb"},children:"CONDITIONS"})]}),e.jsx("dl",{className:"space-y-2.5",children:[{label:"NotBefore",value:F(i.meta.notBefore)||"—"},{label:"NotOnOrAfter",value:F(i.meta.notOnOrAfter)||"—"}].map(t=>e.jsx("div",{className:"rounded-lg border border-slate-200 bg-slate-50 px-3 py-2.5",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsxs("span",{className:"font-semibold text-slate-700 text-sm flex-shrink-0 min-w-[130px]",children:[t.label,":"]}),e.jsx("div",{className:"flex-1 text-right",children:e.jsx("span",{className:"font-semibold text-slate-900 text-sm break-words whitespace-normal inline-block",style:{textAlign:"right",width:"100%"},children:t.value})})]})},t.label))})]})]})]})})]})]})]})})]})};G.createRoot(document.getElementById("root")).render(e.jsx(be,{}));
//# sourceMappingURL=saml-D-Y3-dPG.js.map
