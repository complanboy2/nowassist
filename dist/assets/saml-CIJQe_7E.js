import{c as H,S as X,F as Z,R as G,j as e,r as N,a as J}from"./styles-B9ZRb-5T.js";import{K as Q,N as q,F as Y,c as v,I as ee}from"./clsx-CPouqH0V.js";import{N as te,F as se}from"./Footer-VLkAkB5J.js";import{R as re}from"./refresh-cw-DAkdIO7s.js";import{T as ae}from"./trash-2-0_RQTmvS.js";import{L as ne,a as le}from"./list-tree-CqU0zotJ.js";import{C as K}from"./copy-CzcUpir4.js";import{C as oe}from"./clock-BZiYRMqY.js";import{C as _}from"./circle-check-D1uzc6dJ.js";import{C as ie}from"./chevron-down-5zhzlaOA.js";const ce=[["path",{d:"M12 10a2 2 0 0 0-2 2c0 1.02-.1 2.51-.26 4",key:"1nerag"}],["path",{d:"M14 13.12c0 2.38 0 6.38-1 8.88",key:"o46ks0"}],["path",{d:"M17.29 21.02c.12-.6.43-2.3.5-3.02",key:"ptglia"}],["path",{d:"M2 12a10 10 0 0 1 18-6",key:"ydlgp0"}],["path",{d:"M2 16h.01",key:"1gqxmh"}],["path",{d:"M21.8 16c.2-2 .131-5.354 0-6",key:"drycrb"}],["path",{d:"M5 19.5C5.5 18 6 15 6 12a6 6 0 0 1 .34-2",key:"1tidbn"}],["path",{d:"M8.65 22c.21-.66.45-1.32.57-2",key:"13wd9y"}],["path",{d:"M9 6.8a6 6 0 0 1 9 5.2v2",key:"1fr1j5"}]],de=H("fingerprint-pattern",ce);X,chrome.runtime?.getURL&&chrome.runtime.getURL("jwt.html"),Q,chrome.runtime?.getURL&&chrome.runtime.getURL("saml.html"),q,chrome.runtime?.getURL&&chrome.runtime.getURL("rest.html"),Y,chrome.runtime?.getURL&&chrome.runtime.getURL("har-analyzer.html"),Z,chrome.runtime?.getURL&&chrome.runtime.getURL("json-utility.html");const R=async r=>{if(r)try{await navigator.clipboard.writeText(r)}catch(l){console.error("Unable to copy value",l)}},me=r=>{if(!r)return"";const l="  ";let d=0;return r.replace(/>\s+</g,"><").replace(/</g,"~::~<").split("~::~").map(c=>{if(!c)return"";c.match(/^<\/\w/)&&(d-=1);const s=`${l.repeat(Math.max(d,0))}${c}`;return c.match(/^<\w([^>]*[^/])?>.*$/)&&!c.includes("</")&&(d+=1),s}).join(`
`).trim()},ue=r=>{const l=r.replace(/\s+/g,"");if(!l)return"";const d=l.length%4?4-l.length%4:0,c=l+"=".repeat(d);try{return atob(c)}catch{throw new Error("Could not Base64 decode payload")}},F=(r,l)=>r?.querySelector(l)?.textContent?.trim()||"",ge=r=>{if(!r)return null;try{const l=r.replace(/\s+/g,""),d=`-----BEGIN CERTIFICATE-----
${l.match(/.{1,64}/g)?.join(`
`)||l}
-----END CERTIFICATE-----`,c=atob(l),s=new Uint8Array(c.length);for(let a=0;a<c.length;a++)s[a]=c.charCodeAt(a);let x="—",m="—",f="—";const u=new TextDecoder("latin1",{fatal:!1}).decode(s);let y=u.match(/CN\s*=\s*([^,\x00\n<>]+)/i);if(y||(y=u.match(/(?:^|[^A-Za-z])CN\s+([A-Za-z0-9._-]+)/i)),y||(y=u.match(/([a-z0-9][a-z0-9.-]+\.[a-z]{2,})/i)),y){const a=y[1]||y[0],n=u.indexOf(y[0]);if(n>0){const o=Math.max(0,n-200),h=Math.min(u.length,n+400),p=u.substring(o,h),w=[/(?:CN|OU|O|L|ST|C|DC|EMAIL|E|UID)\s*=\s*[^,\x00\n<>]+(?:\s*,\s*(?:CN|OU|O|L|ST|C|DC|EMAIL|E|UID)\s*=\s*[^,\x00\n<>]+)*/i,/(?:CN|OU|O|L|ST|C|DC|EMAIL|E|UID)=[^,\x00\n<>]+(?:,\s*[A-Z]+=[^,\x00\n<>]+)*/i];let i=null;for(const M of w)if(i=p.match(M),i)break;i?x=i[0].replace(/\x00/g,"").replace(/\s+/g," ").replace(/,/g,", ").trim():x=`CN=${a.replace(/\x00/g,"").trim()}`}else x=`CN=${a.replace(/\x00/g,"").trim()}`}let S=-1,A=0;for(let a=0;a<s.length-5;a++)if(s[a]===48){let n=s[a+1],o=1;if(n&128){if(o=n&127,o>0&&o<=4&&a+2+o<s.length){n=0;for(let h=0;h<o;h++)n=n<<8|s[a+2+h];A=n}}else A=n;S=a;break}if(S>=0){let a=S;if(s[a]===48){a++;let n=s[a];if(n&128){const o=n&127;a+=1+o}else a+=1}if(a<s.length&&(s[a]===160||s[a]===161)){a++;let n=s[a],o=1;if(n&128)if(o=n&127,o>0&&o<=4&&a+1+o<s.length){n=0;for(let h=0;h<o;h++)n=n<<8|s[a+1+h];a+=1+o+n}else a+=1+n;else a+=1+n}if(a<s.length&&s[a]===2){a++;let n=s[a],o=a+1;if(n&128){const h=n&127;if(h>0&&h<=4&&a+1+h<s.length){n=0;for(let p=0;p<h;p++)n=n<<8|s[a+1+p];o=a+1+h}else n=0}if(n>0&&n<=20&&o+n<s.length){const h=s.slice(o,o+n);m=Array.from(h).map(p=>p.toString(16).padStart(2,"0")).join("").toLowerCase()}}}if(m==="—"){const a=[];for(let n=0;n<s.length-10;n++)if(s[n]===2){let o=s[n+1],h=n+2;if(o&128){const p=o&127;if(p>0&&p<=4&&n+2+p<s.length){o=0;for(let w=0;w<p;w++)o=o<<8|s[n+2+w];h=n+2+p}else continue}if(o>0&&o<=20&&h+o<s.length){const p=s.slice(h,h+o);p.some(i=>i!==0)&&o>=4&&o<=16&&a.push({bytes:p,length:o,position:n})}}if(a.length>0){const n=a.find(o=>o.length>=8&&o.length<=16)||a[0];m=Array.from(n.bytes).map(o=>o.toString(16).padStart(2,"0")).join("").toLowerCase()}}return{pem:d,raw:l,snippet:l?`${l.slice(0,32)}…${l.slice(-16)}`:"",subject:x,serialNumber:m,thumbprint:f,bytes:s}}catch(l){return console.error("Certificate parsing error:",l),null}},xe=r=>{if(!r.trim())return{error:"",assertionXml:"",attributes:[],certificates:[],meta:{},samlInfo:{},signature:{}};const d=new DOMParser().parseFromString(r,"text/xml");if(d.getElementsByTagName("parsererror").length>0)return{error:"XML parser error - check for malformed assertion.",assertionXml:r,attributes:[],certificates:[],meta:{},samlInfo:{},signature:{}};const c=d.getElementsByTagNameNS("*","Assertion")[0],s=d.getElementsByTagNameNS("*","AuthnRequest")[0]||d.getElementsByTagNameNS("*","LogoutRequest")[0],x=d.getElementsByTagNameNS("*","Response")[0],m=x?"Response":s?"Request":"Assertion",f=x?.getAttribute("ID")||"",b=c?.getAttribute("ID")||"",u=F(d,"Issuer")||s?.getAttribute("Issuer")||x?.getAttribute("Issuer")||"",y=F(d,"Subject NameID"),S=F(d,"AudienceRestriction Audience"),A=c?.getAttribute("IssueInstant")||s?.getAttribute("IssueInstant")||x?.getAttribute("IssueInstant")||"",a=c?.getElementsByTagNameNS("*","Conditions")[0],n=a?.getAttribute("NotBefore")||"",o=a?.getAttribute("NotOnOrAfter")||"",h=d.querySelector("SubjectConfirmation")?.getAttribute("Method")||"",p=d.querySelector('[Algorithm*="SignatureMethod"]')?.getAttribute("Algorithm")||"",w=d.querySelector('[Algorithm*="DigestMethod"]')?.getAttribute("Algorithm")||"",i=c?.getAttribute("Version")||s?.getAttribute("Version")||x?.getAttribute("Version")||"2.0",M=c?.namespaceURI||s?.namespaceURI||x?.namespaceURI||"",E=s?.getAttribute("ProtocolBinding")||"",I=s?.getAttribute("Destination")||x?.getAttribute("Destination")||"",k=s?.getAttribute("AssertionConsumerServiceURL")||"",t=d.querySelector("NameID")?.getAttribute("Format")||"";let g=[];if(c&&(g=Array.from(c.getElementsByTagName("Attribute")),g.length===0)){const j=c.getElementsByTagNameNS("*","AttributeStatement")[0]||c.getElementsByTagName("AttributeStatement")[0];j&&(g=Array.from(j.getElementsByTagName("Attribute")))}const C=g.map(j=>{const D=j.getAttribute("Name")||j.getAttribute("FriendlyName")||"Attribute",z=Array.from(j.getElementsByTagName("AttributeValue")).map(W=>W.textContent?.trim()||"");return{name:D,values:z}}),T=Array.from(d.getElementsByTagNameNS("*","X509Certificate")).map(j=>{const D=j.textContent?.replace(/\s+/g,"")??"",$=ge(D);if($){const{bytes:z,...W}=$;return W}return{raw:D,snippet:D?`${D.slice(0,32)}…${D.slice(-16)}`:"",pem:"",subject:"—",serialNumber:"—",thumbprint:"—"}}),L=x?.getElementsByTagNameNS("*","Signature")[0],O=c?.getElementsByTagNameNS("*","Signature")[0],V=!!L,U=!!O;return{error:"",assertionXml:new XMLSerializer().serializeToString(c||s||x||d),fullXml:r,attributes:C,certificates:T,meta:{issuer:u,subject:y,audience:S,issueInstant:A,notBefore:n,notOnOrAfter:o,signatureMethod:p,digestMethod:w,subjectConfirmation:h,assertionId:b,responseId:f},samlInfo:{messageType:m,samlVersion:i,samlProtocol:M,binding:E,destination:I,acsUrl:k,nameIdFormat:t},signature:{responseSigned:V,assertionSigned:U}}},he=r=>{if(!r)return"";let l=r.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");return l=l.replace(/(&lt;)(\/?)([\w:]+)([^&]*?)(\/?&gt;)/g,(d,c,s,x,m,f)=>{let b=`<span class="text-blue-400">${c}${s}</span><span class="text-blue-400 font-semibold">${x}</span>`;return m&&(b+=m.replace(/(\w+)(=)(".*?"|'.*?')/g,(u,y,S,A)=>`<span class="text-cyan-400">${y}</span><span class="text-gray-400">${S}</span><span class="text-orange-400">${A}</span>`)),b+=`<span class="text-blue-400">${f}</span>`,b}),l},fe=({meta:r,certificates:l,parseError:d,decodeError:c,warnings:s,signature:x})=>{if(c)return{status:"error",message:"Decode failed",details:c};if(d)return{status:"error",message:"Invalid XML",details:d};const m=Date.now(),f=300*1e3,b=r.notBefore?Date.parse(r.notBefore):null,u=r.notOnOrAfter?Date.parse(r.notOnOrAfter):null;return b&&m+f<b?{status:"warning",message:"Not yet valid",details:`Starts ${new Date(b).toLocaleString()}`}:u&&m-f>u?{status:"error",message:"Expired",details:`Expired ${new Date(u).toLocaleString()}`}:l.length===0&&x.assertionSigned?{status:"warning",message:"Missing certificate",details:"Signature present but no certificate found."}:s&&s.length>0?{status:"warning",message:"Validation warnings",details:`${s.length} issue(s) found.`}:{status:"success",message:"Successful",details:"SAML message is valid."}},P=r=>{if(!r)return"";try{const l=new Date(r),c=new Date-l,s=Math.floor(c/(1e3*60*60*24*365));if(s>0)return`${r} (${s} year${s>1?"s":""} ago)`;const x=Math.floor(c/(1e3*60*60*24));if(x>0)return`${r} (${x} day${x>1?"s":""} ago)`;const m=Math.floor(c/(1e3*60*60));return m>0?`${r} (${m} hour${m>1?"s":""} ago)`:r}catch{return r}},pe=({certificate:r})=>{const[l,d]=N.useState(!1),[c,s]=N.useState(!1),x=async()=>{await R(r.pem||r.raw),s(!0),setTimeout(()=>s(!1),2e3)};return e.jsxs("div",{className:"rounded-lg border-2 bg-white p-5 shadow-sm",style:{borderColor:"#fef3c7",backgroundColor:"#fffbeb"},children:[e.jsxs("div",{className:"mb-4 flex items-center gap-2",children:[e.jsx(de,{className:"h-5 w-5",style:{color:"#f59e0b"}}),e.jsx("h4",{className:"text-sm font-bold",style:{color:"#d97706"},children:"CERTIFICATE"})]}),e.jsxs("dl",{className:"space-y-2.5",children:[[{label:"Subject",value:r.subject||"CN=...",fullWidth:!0},{label:"SerialNumber",value:r.serialNumber||"—",fullWidth:!0},{label:"Thumbprint",value:r.thumbprint||"—",fullWidth:!0}].map(m=>e.jsx("div",{className:"rounded-lg border border-gray-200 bg-gray-50 px-3 py-2.5",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsxs("span",{className:"font-semibold text-gray-700 text-sm flex-shrink-0 min-w-[110px]",children:[m.label,":"]}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsx("div",{className:"text-right",children:e.jsx("span",{className:"font-mono font-semibold text-gray-900 text-sm break-words whitespace-normal inline-block",style:{textAlign:"right",wordBreak:"break-word",overflowWrap:"break-word"},children:m.value})})})]})},m.label)),e.jsxs("div",{className:"mt-3",children:[e.jsxs("button",{onClick:()=>d(!l),onKeyDown:m=>{(m.key==="Enter"||m.key===" ")&&(m.preventDefault(),d(!l))},className:"w-full text-left rounded-lg border border-gray-200 bg-gray-50 px-3 py-2 text-xs text-gray-700 hover:bg-gray-100 hover:border-gray-300 transition flex items-center justify-between active:scale-[0.98] focus:outline-none focus:ring-2 focus:outline-none300",tabIndex:0,children:[e.jsx("span",{children:"Pem"}),e.jsx(ie,{className:v("h-3 w-3 transition-transform duration-200",l&&"rotate-180")})]}),l&&e.jsxs("div",{className:"mt-2 rounded-lg border border-gray-200 bg-gray-950 p-3 animate-in fade-in duration-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-xs text-gray-400",children:"Certificate PEM"}),e.jsxs("button",{onClick:x,onKeyDown:m=>{(m.key==="Enter"||m.key===" ")&&(m.preventDefault(),x())},className:"inline-flex items-center gap-1 rounded px-2 py-1 text-xs text-gray-400 hover:text-gray-200 hover:bg-gray-800 transition active:scale-95 focus:outline-none focus:ring-2 focus:outline-none600",tabIndex:0,children:[c?e.jsx(_,{className:"h-3 w-3 text-success"}):e.jsx(K,{className:"h-3 w-3"}),c?"Copied!":"Copy"]})]}),e.jsx("pre",{className:"text-xs text-gray-300 font-mono whitespace-pre-wrap break-words overflow-auto max-h-48 leading-tight",children:r.pem||r.raw})]})]})]})]})},be=({xml:r,onCopy:l})=>{const[d,c]=N.useState(!1),[s,x]=N.useState(!0),m=N.useMemo(()=>me(r),[r]),f=m.split(`
`),b=async()=>{await l(m),c(!0),setTimeout(()=>c(!1),2e3)};return e.jsxs("div",{className:"rounded-xl border border-gray-200 bg-white shadow-sm overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between border-b border-gray-200 bg-gray-50 px-4 sm:px-6 py-3 sm:py-4",children:[e.jsxs("div",{className:"flex items-center gap-2.5",children:[e.jsx("div",{className:"h-1.5 w-1.5 rounded-full bg-gray-400"}),e.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:"DECODED"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("label",{className:"flex items-center gap-2 text-xs text-gray-700 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:s,onChange:u=>x(u.target.checked),className:"h-4 w-4 rounded border-gray-300"}),e.jsx("span",{children:"Line wrap"})]}),e.jsxs("button",{onClick:b,onKeyDown:u=>{(u.key==="Enter"||u.key===" ")&&(u.preventDefault(),b())},onMouseDown:u=>{u.currentTarget.style.transform="scale(0.95)"},onMouseUp:u=>{u.currentTarget.style.transform=""},className:"inline-flex items-center gap-1.5 rounded-lg px-3 py-1.5 text-xs font-medium text-gray-600 hover:bg-gray-100 hover:text-gray-900 transition active:scale-95 border border-gray-200 focus:outline-none focus:ring-2 focus:outline-none300",tabIndex:0,children:[d?e.jsx(_,{className:"h-3.5 w-3.5"}):e.jsx(K,{className:"h-3.5 w-3.5"}),e.jsx("span",{className:"hidden sm:inline",children:d?"Copied!":"Copy"})]})]})]}),e.jsx("div",{className:"overflow-auto bg-gray-950",style:{maxHeight:"500px"},children:e.jsx("pre",{className:v("p-6 text-sm leading-tight text-gray-100 font-mono",s?"whitespace-pre-wrap break-words":"whitespace-pre"),children:e.jsx("code",{children:f.map((u,y)=>e.jsxs(J.Fragment,{children:[e.jsx("span",{className:"inline-block w-10 select-none text-right text-gray-500 pr-4 flex-shrink-0",children:y+1}),e.jsx("span",{className:"text-gray-100",dangerouslySetInnerHTML:{__html:he(u)}}),`
`]},y))})})})]})},ye=()=>{const[r,l]=N.useState(""),[d,c]=N.useState(!0),[s,x]=N.useState([]),[m,f]=N.useState(null),[b,u]=N.useState("manual"),[y,S]=N.useState(!1),[A,a]=N.useState(!0),[n,o]=N.useState(""),h=async()=>{if(chrome.runtime){S(!0);try{const t=await chrome.runtime.sendMessage({action:"get_saml_messages"});if(chrome.runtime.lastError)return;t&&t.messages&&(x(t.messages),t.messages.length>0&&!m&&(f(t.messages[0]),l(t.messages[0].samlData),u("captured")))}catch(t){t.message&&!t.message.includes("Receiving end does not exist")&&!t.message.includes("Could not establish connection")&&console.error("Failed to load messages",t)}finally{S(!1)}}},p=async()=>{if(chrome.runtime)try{if(await chrome.runtime.sendMessage({action:"clear_saml_messages"}),chrome.runtime.lastError){x([]),f(null),l(""),u("manual");return}x([]),f(null),l(""),u("manual")}catch(t){t.message&&!t.message.includes("Receiving end does not exist")&&!t.message.includes("Could not establish connection")&&console.error("Failed to clear messages",t),x([]),f(null),l(""),u("manual")}};N.useEffect(()=>{if(chrome.runtime&&chrome.runtime.id){h();const t=(g,C,B)=>(g&&g.type==="SAML_MESSAGE_CAPTURED"&&h(),!0);try{return chrome.runtime.onMessage.addListener(t),()=>{try{chrome.runtime.onMessage.removeListener(t)}catch{}}}catch{}}},[]),N.useEffect(()=>{if(!chrome.runtime||!chrome.runtime.id)return;const t=setInterval(()=>{b==="captured"&&h()},2e3);return()=>clearInterval(t)},[b]);const w=N.useMemo(()=>{if(!r.trim())return{text:"",error:""};if(!d)return{text:r,error:""};try{return{text:ue(r),error:""}}catch(t){return{text:r,error:t.message||"Base64 decode failed"}}},[r,d]),i=N.useMemo(()=>xe(w.text),[w.text]),[M,E]=N.useState(i.certificates);N.useEffect(()=>{(async()=>{if(i.certificates.length>0){const g=await Promise.all(i.certificates.map(async C=>{if(C.raw&&C.thumbprint==="—")try{const B=C.raw.replace(/\s+/g,""),T=atob(B),L=new Uint8Array(T.length);for(let j=0;j<T.length;j++)L[j]=T.charCodeAt(j);const O=await crypto.subtle.digest("SHA-1",L),U=Array.from(new Uint8Array(O)).map(j=>j.toString(16).padStart(2,"0")).join("").toUpperCase();return{...C,thumbprint:U}}catch{return C}return C}));E(g)}else E(i.certificates)})()},[i.certificates]);const I=[];w.error&&I.push(w.error),i.error&&I.push(i.error),(!i.meta.notBefore||!i.meta.notOnOrAfter)&&I.push("Conditions (NotBefore/NotOnOrAfter) missing."),i.meta.signatureMethod||I.push("Signature method not specified.");const k=fe({meta:i.meta,certificates:M,parseError:i.error,decodeError:w.error,warnings:I,signature:i.signature});return e.jsxs("div",{className:"flex h-screen bg-white overflow-hidden",children:[e.jsx(te,{currentPageId:"saml",sidebarOpen:A,onSidebarToggle:a}),e.jsxs("div",{className:"flex-1 overflow-y-auto bg-gray-50 flex flex-col",style:{width:"100%",minWidth:0},children:[e.jsx("div",{className:"flex-1 flex flex-col",children:e.jsx("div",{className:"mx-auto max-w-[1600px] w-full px-4 sm:px-6 lg:px-8 py-4 sm:py-6 lg:py-10",children:e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsx("header",{className:"bg-white border border-gray-300 rounded-xl shadow-sm px-4 sm:px-6 lg:px-8 py-4 sm:py-6 mb-4 sm:mb-6",children:e.jsx("div",{className:"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-4",children:e.jsxs("div",{className:"space-y-1 sm:space-y-2",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:"SAML Inspector"}),e.jsx("p",{className:"text-sm sm:text-base text-gray-600",children:"Decode base64 responses, inspect assertions, and automatically trace SAML requests/responses from your browser."})]})})}),e.jsxs("div",{className:"flex items-center gap-4 flex-wrap",children:[e.jsxs("div",{className:"flex items-center gap-0.5 bg-white p-0.5 border border-gray-300 rounded-md",children:[e.jsx("button",{onClick:()=>{u("manual"),f(null)},onKeyDown:t=>{(t.key==="Enter"||t.key===" ")&&(t.preventDefault(),u("manual"),f(null))},className:v("px-2 py-1 text-xs font-medium transition-colors rounded",b==="manual"?"bg-sky-500 text-white":"text-gray-700 hover:bg-gray-50"),tabIndex:0,children:"Manual Input"}),e.jsxs("button",{onClick:()=>{u("captured"),h()},onKeyDown:t=>{(t.key==="Enter"||t.key===" ")&&(t.preventDefault(),u("captured"),h())},className:v("px-2 py-1 text-xs font-medium transition-colors rounded inline-flex items-center gap-1",b==="captured"?"bg-sky-500 text-white":"text-gray-700 hover:bg-gray-50"),tabIndex:0,children:[e.jsx(q,{className:"h-4 w-4"}),"Captured Messages",s.length>0&&e.jsx("span",{className:"ml-1 px-2 py-0.5 text-xs bg-white/20 rounded-full",children:s.length})]})]}),b==="captured"&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:h,onKeyDown:t=>{(t.key==="Enter"||t.key===" ")&&!y&&(t.preventDefault(),h())},disabled:y,className:"inline-flex items-center gap-2 px-4 py-2 text-xs font-semibold text-gray-700 bg-white border-[0.5px] border-gray-300 rounded-lg hover:bg-gray-50 hover:border-gray-500 focus:outline-none shadow-sm hover:shadow transition-all disabled:bg-gray-300 disabled:cursor-not-allowed disabled:hover:bg-gray-300",tabIndex:y?-1:0,children:[e.jsx(re,{className:v("h-4 w-4",y&&"animate-spin")}),"Refresh"]}),e.jsxs("button",{onClick:p,onKeyDown:t=>{(t.key==="Enter"||t.key===" ")&&(t.preventDefault(),p())},className:"inline-flex items-center gap-2 px-4 py-2 text-xs font-semibold text-gray-700 bg-white border-[0.5px] border-gray-300 rounded-lg hover:bg-gray-50 hover:border-gray-500 hover:text-red-600 focus:outline-none shadow-sm hover:shadow transition-all",tabIndex:0,children:[e.jsx(ae,{className:"h-4 w-4"}),"Clear All"]})]})]}),b==="captured"&&e.jsxs("div",{className:"border border-gray-200 rounded-xl bg-white shadow-sm overflow-hidden",children:[e.jsx("div",{className:"flex items-center justify-between bg-gray-50 px-4 sm:px-6 py-3 sm:py-4 border-b border-gray-200",children:e.jsx("h2",{className:"text-sm sm:text-base font-semibold text-gray-900",children:"Captured SAML Messages"})}),e.jsx("div",{className:"p-4",children:s.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx(q,{className:"h-12 w-12 mx-auto mb-3 text-gray-300"}),e.jsx("p",{className:"text-sm",children:"No SAML messages captured yet."}),e.jsx("p",{className:"text-xs mt-2 text-gray-400",children:"Navigate to a SAML SSO flow to automatically capture messages."})]}):e.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:s.map(t=>e.jsx("button",{onClick:()=>{f(t),l(t.samlData)},onKeyDown:g=>{(g.key==="Enter"||g.key===" ")&&(g.preventDefault(),f(t),l(t.samlData))},className:v("w-full text-left border-[0.5px] p-4 rounded-lg transition focus:outline-none focus:border-sky-400/60",m?.id===t.id?"border-gray-900 bg-gray-50":"border-gray-200 bg-white hover:border-gray-300 hover:bg-gray-50"),tabIndex:0,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:v("px-2.5 py-1 rounded-lg text-xs font-semibold",t.type==="request"?"bg-blue-100 text-blue-700":t.type==="response"?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700"),children:t.type.toUpperCase()}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-medium text-gray-900",children:[t.method," Request"]}),e.jsx("p",{className:"text-xs text-gray-500 mt-0.5 truncate max-w-md",children:t.url})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-xs text-gray-500",children:new Date(t.timestamp).toLocaleTimeString()}),e.jsx("p",{className:"text-xs text-gray-400 mt-0.5",children:new Date(t.timestamp).toLocaleDateString()})]})]})},t.id))})})]}),e.jsxs("div",{className:"border border-gray-200 rounded-xl bg-white shadow-sm overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between bg-gray-50 px-4 sm:px-6 py-3 sm:py-4 border-b border-gray-200",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[e.jsx("div",{className:"h-1.5 sm:h-2 w-1.5 sm:w-2 rounded-full flex-shrink-0 bg-gray-400"}),e.jsx("label",{htmlFor:"saml-input",className:"text-sm sm:text-base font-semibold text-gray-900",children:"SAML TOKEN"})]}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("label",{className:"flex items-center gap-2 text-xs text-gray-700",children:[e.jsx("input",{type:"checkbox",checked:d,onChange:()=>c(t=>!t),className:"h-4 w-4 rounded border-gray-300 text-primary focus:ring-primary"}),"Auto Base64 Decode"]}),e.jsx("button",{onClick:()=>{l(""),f(null)},onKeyDown:t=>{(t.key==="Enter"||t.key===" ")&&(t.preventDefault(),l(""),f(null))},onMouseDown:t=>{t.currentTarget.style.transform="scale(0.95)"},onMouseUp:t=>{t.currentTarget.style.transform=""},className:"px-4 py-2 text-xs font-semibold text-gray-700 bg-white border-[0.5px] border-gray-300 rounded-lg hover:bg-gray-50 hover:border-gray-500 focus:outline-none shadow-sm hover:shadow transition-all inline-flex items-center gap-2",tabIndex:0,children:"Clear"})]})})]}),e.jsx("textarea",{id:"saml-input",value:r,onChange:t=>l(t.target.value),placeholder:"Paste SAML response (Base64 encoded) or let the extension capture it automatically",className:"w-full min-h-[160px] resize-none border-0 bg-white px-4 sm:px-5 lg:px-6 py-3 sm:py-4 font-mono text-xs sm:text-sm leading-relaxed text-gray-900 placeholder:text-gray-400 focus:outline-none focus:bg-sky-50/30"}),r&&e.jsx("div",{className:v("border-t border-gray-200 px-4 sm:px-6 py-3 sm:py-4",k.status==="success"?"bg-success/10 border-success/40 text-success":k.status==="warning"?"bg-warning/10 border-warning/40 text-warning":"bg-error/10 border-error/40 text-error"),children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:v("h-2.5 w-2.5 rounded-full",k.status==="success"?"bg-success":k.status==="warning"?"bg-warning":"bg-error")}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-sm",children:k.message}),e.jsx("p",{className:"text-xs text-gray-700 mt-0.5",children:k.details})]})]})})]}),r&&w.text&&e.jsx(be,{xml:w.text,onCopy:R}),r&&e.jsxs("div",{className:"border border-gray-200 rounded-xl bg-white shadow-sm overflow-hidden",children:[e.jsx("div",{className:"flex items-center justify-between bg-gray-50 px-4 sm:px-6 py-3 sm:py-4 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[e.jsx("div",{className:"h-1.5 sm:h-2 w-1.5 sm:w-2 rounded-full flex-shrink-0 bg-gray-400"}),e.jsx("h3",{className:"text-sm font-bold text-gray-900",children:"SAML Information"})]})}),e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"grid gap-6 lg:grid-cols-3",children:[i.attributes.length>0&&e.jsx("div",{className:"lg:col-span-1",children:e.jsxs("div",{className:"rounded-lg border-2 bg-gradient-to-br p-5 h-full shadow-sm",style:{borderColor:"#dbeafe",backgroundColor:"#eff6ff",background:"linear-gradient(to bottom right, #eff6ff, #ffffff)"},children:[e.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ne,{className:"h-5 w-5",style:{color:"#60a5fa"}}),e.jsx("h4",{className:"text-sm font-bold",style:{color:"#3b82f6"},children:"SAML Claims"})]}),e.jsx("span",{className:"px-2.5 py-1 rounded-lg bg-gray-100 text-xs font-semibold text-gray-700",children:i.attributes.length})]}),e.jsx("div",{className:"space-y-2",style:{maxHeight:"400px",overflowY:"auto"},children:i.attributes.map(t=>e.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white p-3 hover:border-gray-300 transition",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2 mb-2",children:[e.jsx("div",{className:"font-mono text-sm font-semibold text-gray-900 break-words flex-1",children:t.name}),e.jsx("button",{onClick:()=>R(t.values.join(", ")),onKeyDown:g=>{(g.key==="Enter"||g.key===" ")&&(g.preventDefault(),R(t.values.join(", ")))},onMouseDown:g=>{g.currentTarget.style.transform="scale(0.95)",g.currentTarget.style.backgroundColor="#e2e8f0"},onMouseUp:g=>{g.currentTarget.style.transform="",g.currentTarget.style.backgroundColor=""},onTouchStart:g=>{g.currentTarget.style.transform="scale(0.95)",g.currentTarget.style.backgroundColor="#e2e8f0"},onTouchEnd:g=>{setTimeout(()=>{g.currentTarget.style.transform="",g.currentTarget.style.backgroundColor=""},150)},className:"inline-flex items-center gap-1 rounded px-1.5 py-1 text-xs text-gray-600 hover:bg-gray-100 hover:text-gray-900 transition active:scale-95 flex-shrink-0 focus:outline-none focus:ring-2 focus:outline-none300",tabIndex:0,children:e.jsx(K,{className:"h-3 w-3"})})]}),e.jsx("div",{className:"space-y-1.5",children:t.values.map((g,C)=>e.jsx("div",{className:"text-sm text-gray-700 bg-gray-50 rounded px-2.5 py-2 break-words leading-tight font-medium",children:g||"—"},C))})]},t.name))})]})}),e.jsxs("div",{className:v("space-y-6",i.attributes.length>0?"lg:col-span-2":"lg:col-span-3"),children:[e.jsxs("div",{className:"grid gap-6 lg:grid-cols-2",children:[e.jsxs("div",{className:"rounded-lg border-2 bg-white p-5 shadow-sm",style:{borderColor:"#e0e7ff",backgroundColor:"#f8fafc"},children:[e.jsxs("div",{className:"mb-4 flex items-center gap-2",children:[e.jsx(ee,{className:"h-5 w-5",style:{color:"#6366f1"}}),e.jsx("h4",{className:"text-sm font-bold",style:{color:"#4f46e5"},children:"COMMON"})]}),e.jsx("dl",{className:"space-y-2.5",children:[{label:"Type",value:i.samlInfo.messageType,fullWidth:!1},{label:"Version",value:i.samlInfo.samlVersion,fullWidth:!1},{label:"Issuer",value:i.meta.issuer,fullWidth:!0},{label:"Destination",value:i.samlInfo.destination||"—",fullWidth:!0},{label:"IssueInstant",value:P(i.meta.issueInstant)||"—",fullWidth:!0}].map(t=>e.jsx("div",{className:"rounded-lg border border-gray-200 bg-gray-50 px-3 py-2.5",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsxs("span",{className:"font-semibold text-gray-700 text-sm flex-shrink-0 min-w-[110px]",children:[t.label,":"]}),e.jsx("div",{className:"flex-1 text-right",children:e.jsx("span",{className:v("font-semibold text-gray-900 text-sm break-words whitespace-normal inline-block",t.fullWidth?"":"truncate max-w-[140px]"),style:{textAlign:"right",width:"100%"},children:t.value})})]})},t.label))})]}),e.jsxs("div",{className:"rounded-lg border-2 bg-white p-5 shadow-sm",style:{borderColor:"#d1fae5",backgroundColor:"#f0fdf4"},children:[e.jsxs("div",{className:"mb-4 flex items-center gap-2",children:[e.jsx(X,{className:"h-5 w-5",style:{color:"#10b981"}}),e.jsx("h4",{className:"text-sm font-bold",style:{color:"#059669"},children:"SIGNATURE"})]}),e.jsx("dl",{className:"space-y-2.5",children:[{label:"SAML Response",value:i.signature.responseSigned?"Signed":"Not signed",fullWidth:!1},{label:"SAML Assertion",value:i.signature.assertionSigned?"Valid Signature":"Not signed",fullWidth:!1},{label:"Signature Method",value:i.meta.signatureMethod||"—",fullWidth:!0},{label:"Digest Method",value:i.meta.digestMethod||"—",fullWidth:!0}].map(t=>e.jsx("div",{className:"rounded-lg border border-gray-200 bg-gray-50 px-3 py-2.5",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsxs("span",{className:"font-semibold text-gray-700 text-sm flex-shrink-0 min-w-[130px]",children:[t.label,":"]}),e.jsx("div",{className:"flex-1 text-right",children:e.jsx("span",{className:v("font-semibold text-sm break-words whitespace-normal inline-block",t.value==="Valid Signature"?"text-success":t.value==="Signed"?"text-gray-900":"text-gray-600",t.fullWidth?"":"truncate max-w-[140px]"),style:{textAlign:"right",width:"100%"},children:t.value})})]})},t.label))})]})]}),e.jsxs("div",{className:"grid gap-6 lg:grid-cols-2",children:[M.length>0&&e.jsx(pe,{certificate:M[0]}),e.jsxs("div",{className:"rounded-lg border-2 bg-white p-5 shadow-sm",style:{borderColor:"#e9d5ff",backgroundColor:"#faf5ff"},children:[e.jsxs("div",{className:"mb-4 flex items-center gap-2",children:[e.jsx(le,{className:"h-5 w-5",style:{color:"#a855f7"}}),e.jsx("h4",{className:"text-sm font-bold",style:{color:"#9333ea"},children:"ASSERTION"})]}),e.jsx("dl",{className:"space-y-2.5",children:[{label:"NameID",value:i.meta.subject||"—",fullWidth:!0},{label:"Subject Confirmation",value:i.meta.subjectConfirmation||"—",fullWidth:!1},{label:"Audience",value:i.meta.audience||"—",fullWidth:!0},{label:"Assertion ID",value:i.meta.assertionId||"—",fullWidth:!0}].map(t=>e.jsx("div",{className:"rounded-lg border border-gray-200 bg-gray-50 px-3 py-2.5",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsxs("span",{className:"font-semibold text-gray-700 text-sm flex-shrink-0 min-w-[130px]",children:[t.label,":"]}),e.jsx("div",{className:"flex-1 text-right",children:e.jsx("span",{className:v("font-semibold text-gray-900 text-sm break-words whitespace-normal inline-block",t.fullWidth?"":"truncate max-w-[140px]"),style:{textAlign:"right",width:"100%"},children:t.value})})]})},t.label))})]})]}),e.jsxs("div",{className:"rounded-lg border-2 bg-white p-5 shadow-sm",style:{borderColor:"#cfe2ff",backgroundColor:"#eff6ff"},children:[e.jsxs("div",{className:"mb-4 flex items-center gap-2",children:[e.jsx(oe,{className:"h-5 w-5",style:{color:"#3b82f6"}}),e.jsx("h4",{className:"text-sm font-bold",style:{color:"#2563eb"},children:"CONDITIONS"})]}),e.jsx("dl",{className:"space-y-2.5",children:[{label:"NotBefore",value:P(i.meta.notBefore)||"—"},{label:"NotOnOrAfter",value:P(i.meta.notOnOrAfter)||"—"}].map(t=>e.jsx("div",{className:"rounded-lg border border-gray-200 bg-gray-50 px-3 py-2.5",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsxs("span",{className:"font-semibold text-gray-700 text-sm flex-shrink-0 min-w-[130px]",children:[t.label,":"]}),e.jsx("div",{className:"flex-1 text-right",children:e.jsx("span",{className:"font-semibold text-gray-900 text-sm break-words whitespace-normal inline-block",style:{textAlign:"right",width:"100%"},children:t.value})})]})},t.label))})]})]})]})})]})]})})}),e.jsx(se,{})]})]})};G.createRoot(document.getElementById("root")).render(e.jsx(ye,{}));
//# sourceMappingURL=saml-CIJQe_7E.js.map
