import{c as ht,S as Fe,F as gt,R as xt,j as e,r as l,a as ft}from"./styles-5wXeUhhA.js";import{K as Be,N as pt,F as yt,c as S}from"./clsx-B5FRgGQU.js";import{N as bt,C as ke}from"./Navigation-DLwhlW8U.js";import{C as ee}from"./circle-check-MmQgBdp5.js";import{X as ce,C as de}from"./x-C4hRl36k.js";import{C as B}from"./circle-alert-Bx3e1qOH.js";import{C as F}from"./chevron-down-DOMm9JwN.js";import{R as Le}from"./refresh-cw-Bts4OWXU.js";import{I as fe}from"./info-CHkhJL_6.js";import{U as wt}from"./upload-BnWmwlwu.js";import{C as vt}from"./clock-CxRxVJnw.js";import{L as St,G as Nt}from"./lock-Bgwpi_Vv.js";const jt=[["path",{d:"M12 3v18",key:"108xh3"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}]],kt=ht("table",jt);class ue extends Error{}ue.prototype.name="InvalidTokenError";function Ct(t){return decodeURIComponent(atob(t).replace(/(.)/g,(r,n)=>{let o=n.charCodeAt(0).toString(16).toUpperCase();return o.length<2&&(o="0"+o),"%"+o}))}function It(t){let r=t.replace(/-/g,"+").replace(/_/g,"/");switch(r.length%4){case 0:break;case 2:r+="==";break;case 3:r+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return Ct(r)}catch{return atob(r)}}function Et(t,r){if(typeof t!="string")throw new ue("Invalid token specified: must be a string");r||(r={});const n=r.header===!0?0:1,o=t.split(".")[n];if(typeof o!="string")throw new ue(`Invalid token specified: missing part #${n+1}`);let a;try{a=It(o)}catch(m){throw new ue(`Invalid token specified: invalid base64 for part #${n+1} (${m.message})`)}try{return JSON.parse(a)}catch(m){throw new ue(`Invalid token specified: invalid json for part #${n+1} (${m.message})`)}}const x={CRITICAL:"critical",HIGH:"high",MEDIUM:"medium",LOW:"low",INFO:"info"},Mt={iss:{name:"Issuer",description:"Identifies the principal that issued the JWT",required:!1,category:"Standard"},sub:{name:"Subject",description:"Identifies the subject of the JWT (usually the user)",required:!1,category:"Standard"},aud:{name:"Audience",description:"Identifies the recipients that the JWT is intended for. Should always be present in production tokens.",required:!1,recommended:!0,category:"Standard"},exp:{name:"Expiration Time",description:"Identifies the expiration time on or after which the JWT must not be accepted for processing",required:!1,recommended:!0,category:"Standard"},nbf:{name:"Not Before",description:"Identifies the time before which the JWT must not be accepted for processing",required:!1,category:"Standard"},iat:{name:"Issued At",description:"Identifies the time at which the JWT was issued",required:!1,recommended:!0,category:"Standard"},jti:{name:"JWT ID",description:"Provides a unique identifier for the JWT. Can be used to prevent token replay attacks.",required:!1,category:"Standard"},email:{name:"Email",description:"User email address",required:!1,category:"Custom"},name:{name:"Name",description:"User full name",required:!1,category:"Custom"},scope:{name:"Scope",description:"OAuth 2.0 scope values",required:!1,category:"OAuth"},sys_id:{name:"ServiceNow Sys ID",description:"ServiceNow system record identifier",required:!1,category:"ServiceNow"},user_name:{name:"ServiceNow Username",description:"ServiceNow user name",required:!1,category:"ServiceNow"},instance:{name:"ServiceNow Instance",description:"ServiceNow instance identifier",required:!1,category:"ServiceNow"},organization_id:{name:"Salesforce Organization ID",description:"Salesforce organization identifier",required:!1,category:"Salesforce"},user_id:{name:"Salesforce User ID",description:"Salesforce user identifier",required:!1,category:"Salesforce"}},Tt=(t,r,n,o=Date.now())=>{const a=[];if(!t)return a.push({severity:x.CRITICAL,code:"MISSING_HEADER",title:"Missing Header",message:"JWT header is missing or invalid",recommendation:"Ensure the token has a valid header segment"}),{issues:a,riskScore:100};if(!r)return a.push({severity:x.CRITICAL,code:"MISSING_PAYLOAD",title:"Missing Payload",message:"JWT payload is missing or invalid",recommendation:"Ensure the token has a valid payload segment"}),{issues:a,riskScore:100};const m=t.alg;if((m==="none"||m==="None"||m==="NONE")&&a.push({severity:x.CRITICAL,code:"NONE_ALGORITHM",title:"None Algorithm Detected",message:'Token uses the "none" algorithm, which provides no security',recommendation:'Never use the "none" algorithm in production. Use HS256, RS256, or ES256.',riskScore:100}),(!n||n.length===0)&&a.push({severity:x.HIGH,code:"MISSING_SIGNATURE",title:"Missing Signature",message:"Token has no signature (unsigned token)",recommendation:"Always sign tokens in production to ensure integrity and authenticity",riskScore:80}),!r.exp)a.push({severity:x.HIGH,code:"MISSING_EXP",title:"Missing Expiration Claim",message:"Token has no expiration time (exp claim)",recommendation:"Always include an expiration time to limit token lifetime and reduce risk if compromised",riskScore:70});else{const c=r.exp*1e3;if(c<o){const h=Math.floor((o-c)/864e5);a.push({severity:x.HIGH,code:"EXPIRED_TOKEN",title:"Token Expired",message:`Token expired ${h>0?`${h} day(s)`:"recently"} ago`,recommendation:"Do not accept expired tokens. Request a new token from the identity provider",riskScore:60})}}if(r.aud||a.push({severity:x.HIGH,code:"MISSING_AUD",title:"Missing Audience Claim",message:"Token has no audience (aud claim)",recommendation:"Include an audience claim to ensure tokens are only used by intended recipients",riskScore:65}),!r.iat)a.push({severity:x.MEDIUM,code:"MISSING_IAT",title:"Missing Issued At Claim",message:"Token has no issued at time (iat claim)",recommendation:"Include iat claim to track when the token was issued",riskScore:30});else{const h=(r.iat*1e3-o)/(1e3*60);h>5&&a.push({severity:x.MEDIUM,code:"FUTURE_IAT",title:"Future Issued At Time",message:`Token appears to be issued ${Math.round(h)} minutes in the future`,recommendation:"Check system clocks for clock skew between issuer and validator",riskScore:40})}if(r.exp&&r.iat){const c=(r.exp-r.iat)/3600;c>24&&a.push({severity:x.MEDIUM,code:"LONG_EXPIRY",title:"Long Token Lifetime",message:`Token lifetime is ${Math.round(c)} hours (${Math.round(c/24)} days)`,recommendation:"Access tokens should typically expire within 1 hour. Use refresh tokens for longer sessions",riskScore:45})}if(m==="HS256"&&a.push({severity:x.MEDIUM,code:"WEAK_ALGORITHM",title:"HMAC Algorithm Used",message:"Token uses HMAC (symmetric) signing algorithm",recommendation:"Consider using RS256 or ES256 (asymmetric) for better key management in distributed systems",riskScore:35,note:"HS256 is acceptable if secret is properly managed"}),r.jti||a.push({severity:x.LOW,code:"MISSING_JTI",title:"Missing JWT ID",message:"Token has no unique identifier (jti claim)",recommendation:"Include jti claim to enable token revocation and prevent replay attacks",riskScore:20}),r.nbf){const c=r.nbf*1e3;if(c>o){const h=Math.round((c-o)/6e4);a.push({severity:x.INFO,code:"NOT_YET_VALID",title:"Token Not Yet Valid",message:`Token will be valid in ${h} minutes`,recommendation:"Wait until nbf time before accepting this token",riskScore:10})}}const i=Math.min(100,Math.max(0,a.reduce((c,h)=>c+(h.riskScore||0),0)/Math.max(a.length,1)));return{issues:a,riskScore:i}},At=t=>t>=80?{level:"Critical",color:"text-red-600",bg:"bg-red-50",border:"border-red-200"}:t>=60?{level:"High",color:"text-orange-600",bg:"bg-orange-50",border:"border-orange-200"}:t>=40?{level:"Medium",color:"text-yellow-600",bg:"bg-yellow-50",border:"border-yellow-200"}:t>=20?{level:"Low",color:"text-blue-600",bg:"bg-blue-50",border:"border-blue-200"}:{level:"Info",color:"text-green-600",bg:"bg-green-50",border:"border-green-200"},Rt=t=>Mt[t]||{name:t,description:"Custom claim",required:!1,category:"Custom"},Dt=(t,r=Date.now())=>{if(!t)return"—";const n=typeof t=="number"?t*1e3:t,o=new Date(n);if(Number.isNaN(o.getTime()))return"Invalid timestamp";const a=Math.floor((n-r)/1e3),m=Math.floor(a/60),i=Math.floor(m/60),c=Math.floor(i/24),h=new Intl.RelativeTimeFormat("en",{numeric:"auto"});return Math.abs(c)>0?`${o.toLocaleString()} (${h.format(c,"day")})`:Math.abs(i)>0?`${o.toLocaleString()} (${h.format(i,"hour")})`:Math.abs(m)>0?`${o.toLocaleString()} (${h.format(m,"minute")})`:`${o.toLocaleString()} (${h.format(a,"second")})`},Ht=(t,r=Date.now())=>{if(!t)return null;const n=t*1e3,o=n-r,a=Math.max(0,Math.min(100,o/(n-(r-864e5))*100));return{ms:o,seconds:Math.floor(o/1e3),minutes:Math.floor(o/(1e3*60)),hours:Math.floor(o/(1e3*60*60)),days:Math.floor(o/(1e3*60*60*24)),percentage:a,expired:o<0}},Kt=async t=>{try{const r=await fetch(t);if(!r.ok)throw new Error(`HTTP ${r.status}: ${r.statusText}`);const n=await r.json();if(!n.keys||!Array.isArray(n.keys))throw new Error("Invalid JWKS format: missing keys array");return{success:!0,jwks:n,keys:n.keys,count:n.keys.length}}catch(r){return{success:!1,error:r.message||"Failed to fetch JWKS",jwks:null,keys:[],count:0}}},Oe=(t,r)=>!t||!t.keys?null:t.keys.find(n=>n.kid===r)||null,Ge=new Map,_t=300*1e3,Ut=t=>{const r=Ge.get(t);return r&&Date.now()-r.timestamp<_t?r.jwks:null},Jt=(t,r)=>{Ge.set(t,{jwks:r,timestamp:Date.now()})},Lt=["password","secret","token","access_token","refresh_token","api_key","apikey","auth","authorization","credit_card","ssn","social_security","pin","pii","phi"],Ot=[/password/i,/secret/i,/token/i,/key/i,/auth/i,/credential/i,/passphrase/i,/private/i],pe=t=>{const r=t.toLowerCase();return Lt.some(n=>r.includes(n))?!0:Ot.some(n=>n.test(t))},$t=(t,r=[],n="*",o=8)=>{if(!t)return t;const a={...t},m=new Set(r);return r.length===0&&Object.keys(t).forEach(i=>{pe(i)&&m.add(i)}),m.forEach(i=>{if(i in a){const c=a[i];typeof c=="string"?a[i]=n.repeat(Math.min(o,c.length))+(c.length>o?"...":""):typeof c=="object"&&c!==null?a[i]="[REDACTED]":a[i]=n.repeat(o)}}),a},Pt=(t,r,n="")=>{try{const o=i=>{const c=encodeURIComponent(i).replace(/%([0-9A-F]{2})/g,(h,f)=>String.fromCharCode(parseInt(f,16)));return btoa(c).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")},a=o(JSON.stringify(t)),m=o(JSON.stringify(r));return`${a}.${m}.${n.substring(0,10)}...REDACTED`}catch{return null}},Wt=(t,r)=>{const n=h=>{if(!h)return null;const f=h.split(".");if(f.length!==3)return null;try{const p=I=>{const b=I.replace(/-/g,"+").replace(/_/g,"/").padEnd(I.length+(I.length%4?4-I.length%4:0),"="),j=atob(b);try{return decodeURIComponent(j.split("").map(M=>`%${`00${M.charCodeAt(0).toString(16)}`.slice(-2)}`).join(""))}catch{return j}},N=p(f[0]),H=p(f[1]);return{header:JSON.parse(N),payload:JSON.parse(H),signature:f[2],headerRaw:N,payloadRaw:H}}catch{return null}},o=n(t),a=n(r);if(!o||!a)return{valid:!1,error:"One or both tokens are invalid"};const m=$e(o.header,a.header),i=$e(o.payload,a.payload),c=o.signature===a.signature;return{valid:!0,token1:o,token2:a,headerDiff:m,payloadDiff:i,signaturesMatch:c,summary:{headerChanges:m.added.length+m.removed.length+m.changed.length,payloadChanges:i.added.length+i.removed.length+i.changed.length,signaturesMatch:c}}},$e=(t,r)=>{const n=new Set([...Object.keys(t||{}),...Object.keys(r||{})]),o=[],a=[],m=[],i=[];return n.forEach(c=>{const h=t?.[c],f=r?.[c];c in(t||{})?c in(r||{})?JSON.stringify(h)!==JSON.stringify(f)?m.push({key:c,oldValue:h,newValue:f}):i.push({key:c,value:h}):a.push({key:c,value:h}):o.push({key:c,value:f})}),{added:o,removed:a,changed:m,unchanged:i}},Ft=t=>{if(!t.valid)return t.error||"Comparison failed";const{headerDiff:r,payloadDiff:n,signaturesMatch:o}=t,a=[];return r.added.length>0&&a.push(`${r.added.length} header field(s) added`),r.removed.length>0&&a.push(`${r.removed.length} header field(s) removed`),r.changed.length>0&&a.push(`${r.changed.length} header field(s) changed`),n.added.length>0&&a.push(`${n.added.length} claim(s) added`),n.removed.length>0&&a.push(`${n.removed.length} claim(s) removed`),n.changed.length>0&&a.push(`${n.changed.length} claim(s) changed`),o?a.push("Signatures match"):a.push("Signatures differ"),a.join(", ")||"Tokens are identical"},Bt={servicenow:{name:"ServiceNow",primary:"#81B5A1",primaryDark:"#5A8F7A",primaryLight:"#A8D4C4",bgGradient:"from-green-50 to-emerald-50",badgeBg:"#81B5A1",badgeText:"#FFFFFF"},salesforce:{name:"Salesforce",primary:"#00A1E0",primaryDark:"#0070D2",primaryLight:"#4FC3F7",bgGradient:"from-blue-50 to-cyan-50",badgeBg:"#00A1E0",badgeText:"#FFFFFF"}},Gt=t=>!t||t.sys_id||t.instance||t.instance_url||t.user_name||t.email&&t.email.includes("servicenow")?"servicenow":t.organization_id||t.user_id||t.sfdc_instance_url||t.scope||t.email&&t.email.includes("salesforce")?"salesforce":"servicenow",Vt=(t,r)=>{if(!t)return[];const n=[];return r==="servicenow"?(t.sys_id&&n.push("Contains ServiceNow sys_id"),(t.user_name||t.userName)&&n.push("User principal claim detected"),(t.instance||t.instance_url)&&n.push("Instance metadata present")):r==="salesforce"&&(t.organization_id&&n.push("Contains Salesforce organization_id"),t.user_id&&n.push("User ID claim detected"),t.sfdc_instance_url&&n.push("Salesforce instance URL present"),t.scope&&n.push("OAuth scope defined")),n},zt=(t,r)=>{if(!t)return new Set;const n=new Set;return r==="servicenow"?(t.sys_id&&n.add("sys_id"),(t.user_name||t.userName)&&n.add("user_name"),(t.instance||t.instance_url)&&(n.add("instance"),n.add("instance_url"))):r==="salesforce"&&(t.organization_id&&n.add("organization_id"),t.user_id&&n.add("user_id"),t.sfdc_instance_url&&n.add("sfdc_instance_url"),t.scope&&n.add("scope")),n},Ce=t=>{if(!t)return"";const r=t.replace(/-/g,"+").replace(/_/g,"/").padEnd(t.length+(t.length%4?4-t.length%4:0),"="),n=atob(r);try{return decodeURIComponent(n.split("").map(o=>`%${`00${o.charCodeAt(0).toString(16)}`.slice(-2)}`).join(""))}catch{return n}},Pe=t=>{if(!t)return"";try{return JSON.stringify(JSON.parse(t),null,2)}catch{return t}},qt=t=>{if(!t?.exp)return{tone:"warning",icon:B,message:"Missing exp claim"};const r=Date.now(),n=t.exp*1e3;if(n<r){const a=Math.floor((r-n)/864e5);return{tone:"error",icon:B,message:a>0?`Expired ${a} day(s) ago`:"Recently expired"}}const o=(n-r)/(1e3*60*60);return o<=1?{tone:"warning",icon:B,message:`Expiring in ${Math.round(o*60)} minutes`}:{tone:"success",icon:ee,message:`Valid for ${Math.round(o)} hour(s)`}},Yt={success:{text:"text-success",bg:"bg-success/10",border:"border-success/20"},warning:{text:"text-warning",bg:"bg-warning/10",border:"border-warning/20"},error:{text:"text-error",bg:"bg-error/10",border:"border-error/20"}},We=["sub","name","email","user_name","sys_id","iat","exp"],Qt=(t=32)=>{const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";let n="";for(let o=0;o<t;o++)n+=r.charAt(Math.floor(Math.random()*r.length));return n},Xt=async(t="HS256")=>{const r=["John","Jane","Alice","Bob","Charlie","David","Emma","Frank","Grace","Henry"],n=["Smith","Johnson","Williams","Brown","Jones","Garcia","Miller","Davis","Rodriguez","Martinez"],o=["example.com","test.com","demo.org","sample.net","dev.io"],a=r[Math.floor(Math.random()*r.length)],m=n[Math.floor(Math.random()*n.length)],i=o[Math.floor(Math.random()*o.length)],c=`${a.toLowerCase()}.${m.toLowerCase()}@${i}`,h=`${a.toLowerCase()}.${m.toLowerCase()}`,f=Array.from({length:32},()=>Math.floor(Math.random()*16).toString(16)).join(""),p=Math.floor(Date.now()/1e3),N=p-Math.floor(Math.random()*3600),H=p+Math.floor(Math.random()*86400)+3600,I={alg:t,typ:"JWT",...t.startsWith("RS")||t.startsWith("ES")?{kid:Math.floor(Math.random()*1e6).toString()}:{}},b={sub:c,name:`${a} ${m}`,email:c,user_name:h,sys_id:f,iat:N,exp:H,instance:`instance${Math.floor(Math.random()*100)}.service-now.com`,instance_url:`https://instance${Math.floor(Math.random()*100)}.service-now.com`},j=R=>{const A=encodeURIComponent(R).replace(/%([0-9A-F]{2})/g,(u,y)=>String.fromCharCode(parseInt(y,16)));return btoa(A).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")},M=j(JSON.stringify(I)),L=j(JSON.stringify(b)),K=`${M}.${L}`;let T,J="";if(t.startsWith("HS")){const R=Qt();J=R;const A=new TextEncoder,u=A.encode(R),y=t==="HS256"?"SHA-256":t==="HS384"?"SHA-384":"SHA-512",_=await crypto.subtle.importKey("raw",u,{name:"HMAC",hash:y},!1,["sign"]),$=await crypto.subtle.sign("HMAC",_,A.encode(K));T=btoa(String.fromCharCode(...new Uint8Array($))).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}else if(t.startsWith("RS")){const R=t==="RS256"?"SHA-256":t==="RS384"?"SHA-384":"SHA-512",A=await crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:2048,publicExponent:new Uint8Array([1,0,1]),hash:R},!0,["sign","verify"]),u=new TextEncoder,y=await crypto.subtle.sign("RSASSA-PKCS1-v1_5",A.privateKey,u.encode(K));T=btoa(String.fromCharCode(...new Uint8Array(y))).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"");const _=await crypto.subtle.exportKey("spki",A.publicKey);J=`-----BEGIN PUBLIC KEY-----
${btoa(String.fromCharCode(...new Uint8Array(_))).match(/.{1,64}/g).join(`
`)}
-----END PUBLIC KEY-----`}else if(t.startsWith("ES")){const R=t==="ES256"?"SHA-256":t==="ES384"?"SHA-384":"SHA-512",A=t==="ES256"?"P-256":t==="ES384"?"P-384":"P-521",u=await crypto.subtle.generateKey({name:"ECDSA",namedCurve:A},!0,["sign","verify"]),y=new TextEncoder,_=await crypto.subtle.sign({name:"ECDSA",hash:R},u.privateKey,y.encode(K));T=btoa(String.fromCharCode(...new Uint8Array(_))).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"");const $=await crypto.subtle.exportKey("spki",u.publicKey);J=`-----BEGIN PUBLIC KEY-----
${btoa(String.fromCharCode(...new Uint8Array($))).match(/.{1,64}/g).join(`
`)}
-----END PUBLIC KEY-----`}return{token:`${K}.${T}`,key:J,algorithm:t}};Fe,chrome.runtime?.getURL&&chrome.runtime.getURL("jwt.html"),Be,chrome.runtime?.getURL&&chrome.runtime.getURL("saml.html"),pt,chrome.runtime?.getURL&&chrome.runtime.getURL("rest.html"),yt,chrome.runtime?.getURL&&chrome.runtime.getURL("har-analyzer.html"),gt,chrome.runtime?.getURL&&chrome.runtime.getURL("json-utility.html");const q=async t=>{if(t)try{await navigator.clipboard.writeText(t)}catch(r){console.error("Copy failed",r)}},Zt=async(t,r,n,o)=>{try{const a=t.split(".");if(a.length!==3)return{verified:!1,error:"Invalid JWT format"};const i=JSON.parse(Ce(a[0])).alg||n||"RS256";if(i.startsWith("HS")){const b=new TextEncoder,j=`${a[0]}.${a[1]}`,M=b.encode(r),L=i==="HS256"?"SHA-256":i==="HS384"?"SHA-384":"SHA-512",K=await crypto.subtle.importKey("raw",M,{name:"HMAC",hash:L},!1,["sign"]),T=await crypto.subtle.sign("HMAC",K,b.encode(j)),O=btoa(String.fromCharCode(...new Uint8Array(T))).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")===a[2];return{verified:O,error:O?null:"Signature verification failed"}}let c;if(o==="JWK"){const b=typeof r=="string"?JSON.parse(r):r;c=await crypto.subtle.importKey("jwk",b,{name:i.startsWith("RS")?"RSASSA-PKCS1-v1_5":"ECDSA",hash:i==="RS256"||i==="ES256"?"SHA-256":i==="RS384"||i==="ES384"?"SHA-384":"SHA-512"},!1,["verify"])}else{const b=r.replace(/-----BEGIN PUBLIC KEY-----/g,"").replace(/-----END PUBLIC KEY-----/g,"").replace(/-----BEGIN RSA PUBLIC KEY-----/g,"").replace(/-----END RSA PUBLIC KEY-----/g,"").replace(/\s+/g,""),j=Uint8Array.from(atob(b),M=>M.charCodeAt(0));if(i.startsWith("RS"))c=await crypto.subtle.importKey("spki",j.buffer,{name:"RSASSA-PKCS1-v1_5",hash:i==="RS256"?"SHA-256":i==="RS384"?"SHA-384":"SHA-512"},!1,["verify"]);else if(i.startsWith("ES"))c=await crypto.subtle.importKey("spki",j.buffer,{name:"ECDSA",namedCurve:i==="ES256"?"P-256":i==="ES384"?"P-384":"P-521"},!1,["verify"]);else return{verified:!1,error:`Algorithm ${i} not supported for verification`}}const h=`${a[0]}.${a[1]}`,f=a[2].replace(/-/g,"+").replace(/_/g,"/"),p=f.length%4?4-f.length%4:0,N=f+"=".repeat(p),H=Uint8Array.from(atob(N),b=>b.charCodeAt(0)),I=await crypto.subtle.verify(i.startsWith("RS")?"RSASSA-PKCS1-v1_5":"ECDSA",c,H,new TextEncoder().encode(h));return{verified:I,error:I?null:"Signature verification failed"}}catch(a){return{verified:!1,error:a.message||"Verification error"}}},es=t=>l.useMemo(()=>{if(!t.trim())return{error:"",header:null,payload:null,signature:"",headerRaw:"",payloadRaw:""};const r=t.split(".");if(r.length!==3)return{error:"A JWT must contain three dot-separated segments.",header:null,payload:null,signature:"",headerRaw:"",payloadRaw:""};try{const n=Ce(r[0]),o=Ce(r[1]),a=r[2],m=JSON.parse(n),i=Et(t);return{error:"",header:m,payload:i,signature:a,headerRaw:n,payloadRaw:o}}catch(n){return{error:n.message||"Unable to decode token.",header:null,payload:null,signature:r[2]||"",headerRaw:"",payloadRaw:""}}},[t]),xe=({title:t,content:r,description:n,onCopy:o,viewMode:a,onViewModeChange:m,theme:i,statusColor:c,isHeader:h=!1,payload:f,targetClaims:p,getClaimInfo:N,companyClaimSet:H,currentCompany:I,currentTime:b,calculateTTL:j})=>{const[M,L]=l.useState(!1),K=r?r.split(`
`):["—"],T=a==="table"&&t==="Decoded Payload"?(()=>{try{return JSON.parse(r)}catch{return null}})():null;c?.border,c?.text;const J=c?c.text.includes("error")?"#ef4444":c.text.includes("warning")?"#f59e0b":i.primary:i.primary,O=async()=>{await o(r),L(!0),setTimeout(()=>L(!1),2e3)},R=t==="Decoded Payload"||t==="Signature"?"400px":h?"auto":"280px",A=a==="table"&&T&&t==="Decoded Payload";return e.jsxs("div",{className:"border border-gray-300 rounded-lg bg-white flex flex-col overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between bg-gray-50 px-4 py-2 flex-shrink-0 border-b border-gray-200",children:[e.jsxs("div",{className:"flex items-center gap-2.5",children:[e.jsx("div",{className:"h-1.5 w-1.5 rounded-full flex-shrink-0",style:{backgroundColor:J}}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("h3",{className:"text-xs font-medium text-gray-700 uppercase tracking-wide",children:t}),n&&e.jsx("p",{className:"text-xs text-gray-500 leading-tight mt-0.5",children:n})]})]}),e.jsxs("div",{className:"flex items-center gap-1.5 flex-shrink-0",children:[t==="Decoded Payload"&&e.jsxs("div",{className:"flex items-center gap-0.5 bg-white p-0.5 border border-gray-300 rounded-md",children:[e.jsx("button",{onClick:()=>m("json"),className:S("px-2 py-1 text-xs font-medium transition-colors rounded",a==="json"?"bg-sky-500 text-white":"text-gray-700 hover:bg-gray-50"),tabIndex:0,children:"JSON"}),e.jsxs("button",{onClick:()=>m("table"),className:S("px-2 py-1 text-xs font-medium transition-colors rounded inline-flex items-center gap-1",a==="table"?"bg-sky-500 text-white":"text-gray-700 hover:bg-gray-50"),tabIndex:0,children:[e.jsx(kt,{className:"h-3 w-3"}),"Table"]})]}),e.jsxs("button",{onClick:O,onKeyDown:u=>{(u.key==="Enter"||u.key===" ")&&(u.preventDefault(),O())},onMouseDown:u=>{u.currentTarget.style.transform="scale(0.95)",u.currentTarget.style.backgroundColor="#e2e8f0"},onMouseUp:u=>{u.currentTarget.style.transform="",u.currentTarget.style.backgroundColor=""},onTouchStart:u=>{u.currentTarget.style.transform="scale(0.95)",u.currentTarget.style.backgroundColor="#e2e8f0"},onTouchEnd:u=>{setTimeout(()=>{u.currentTarget.style.transform="",u.currentTarget.style.backgroundColor=""},150)},className:S("inline-flex items-center gap-1.5 px-2.5 py-1 text-xs font-medium transition-colors focus:outline-none border rounded-md focus:ring-2 focus:ring-blue-500",M?"bg-green-50 border-green-300 text-green-700":"text-gray-700 hover:bg-gray-50 hover:border-gray-400 bg-white border-gray-300"),tabIndex:0,children:[M?e.jsx(ee,{className:"h-3.5 w-3.5"}):e.jsx(ke,{className:"h-3.5 w-3.5"}),e.jsx("span",{className:"hidden sm:inline",children:M?"Copied!":"Copy"})]})]})]}),e.jsx("div",{className:S("bg-white",h||A?"overflow-visible":"overflow-auto"),style:h||A?{}:{height:R,maxHeight:R},children:a==="table"&&T?e.jsx("div",{className:"p-4 w-full",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-200",children:[e.jsx("th",{className:"px-4 py-2.5 text-left font-medium text-gray-700",children:"Claim"}),e.jsx("th",{className:"px-4 py-2.5 text-left font-medium text-gray-700",children:"Value"})]})}),e.jsx("tbody",{children:Object.entries(T).map(([u,y])=>e.jsxs("tr",{className:"border-b border-gray-100 hover:bg-gray-50 transition-colors",children:[e.jsx("td",{className:"px-4 py-2.5 font-mono text-gray-700 text-sm",children:u}),e.jsx("td",{className:"px-4 py-2.5 text-gray-900 text-sm",children:typeof y=="object"?JSON.stringify(y):String(y)})]},u))})]})}):t==="Signature"?e.jsx("div",{className:"p-4",children:e.jsx("pre",{className:"text-sm leading-relaxed whitespace-pre-wrap break-words overflow-wrap-anywhere",children:e.jsx("code",{className:"font-mono text-gray-800",children:r||"—"})})}):e.jsxs("div",{className:"flex bg-white",style:{flex:"1 1 auto",minHeight:"100%"},children:[e.jsx("div",{className:"flex-shrink-0 bg-gray-50 border-r border-gray-200 text-right pr-3 pl-3 py-4 flex flex-col",style:{width:"50px",fontFamily:"monospace",minHeight:"100%"},children:K.map((u,y)=>e.jsx("div",{className:"text-gray-400 text-xs leading-relaxed select-none flex-shrink-0",style:{minHeight:"20px"},children:y+1},y))}),e.jsx("div",{className:"flex-1 py-4 pl-4 pr-4 text-sm leading-relaxed overflow-x-auto bg-white",children:e.jsx("div",{className:"font-mono text-gray-800",children:K.map((u,y)=>{let _=null,$=!1;if(t==="Key Claims"&&p&&N&&f){const E=u.match(/^\s*"([^"]+)":\s*(.+)/);if(E&&p.includes(E[1])){const G=E[1];_=N(G),$=H?.has(G)||!1}}if(t==="Key Claims"&&_){const E=u.indexOf(":");if(E!==-1){const G=u.substring(0,E+1),V=u.substring(E+1).trim();return e.jsxs("div",{className:"flex items-center gap-2",style:{minHeight:"22.4px"},children:[e.jsx("span",{className:"text-slate-900 whitespace-pre",children:G}),e.jsx("span",{className:"text-slate-900 whitespace-pre",children:V}),$&&e.jsx("span",{className:"inline-flex items-center rounded-full px-1.5 py-0.5 text-xs font-semibold uppercase text-white flex-shrink-0",style:{backgroundColor:i.badgeBg},children:I==="servicenow"?"SN":"SF"}),e.jsx(Ve,{content:e.jsxs("div",{className:"max-w-sm",children:[e.jsx("p",{className:"font-semibold mb-1.5 text-sm text-white",children:_.name}),e.jsx("p",{className:"text-xs mb-2.5 text-slate-300 leading-relaxed",children:_.description})]}),position:"left",children:e.jsx(fe,{className:"h-3.5 w-3.5 text-sky-500 cursor-help flex-shrink-0"})})]},y)}}return e.jsx("div",{className:"text-slate-900 whitespace-pre",style:{minHeight:"22.4px"},children:u||" "},y)})})})]})})]})},Ve=({children:t,content:r,position:n="top"})=>{const[o,a]=l.useState(!1),m={top:"left-1/2 bottom-full mb-2 -translate-x-1/2",left:"right-full top-1/2 mr-2 -translate-y-1/2",right:"left-full top-1/2 ml-2 -translate-y-1/2",bottom:"left-1/2 top-full mt-2 -translate-x-1/2"},i={top:"left-1/2 top-full -translate-x-1/2 -mt-1 border-4 border-transparent border-t-white",left:"left-full top-1/2 -translate-y-1/2 -ml-1 border-4 border-transparent border-r-white",right:"right-full top-1/2 -translate-y-1/2 -mr-1 border-4 border-transparent border-l-white",bottom:"left-1/2 bottom-full -translate-x-1/2 -mb-1 border-4 border-transparent border-b-white"};return e.jsxs("div",{className:"relative inline-block",children:[e.jsx("div",{onMouseEnter:()=>a(!0),onMouseLeave:()=>a(!1),onFocus:()=>a(!0),onBlur:()=>a(!1),className:"cursor-help",tabIndex:0,children:t}),o&&e.jsxs("div",{className:`absolute ${m[n]} z-50 w-64 rounded-lg border border-slate-200 bg-white p-3 text-xs text-slate-700 shadow-lg`,children:[r,e.jsx("div",{className:`absolute ${i[n]}`})]})]})},ts=()=>{const[t,r]=l.useState(""),[n,o]=l.useState(""),[a,m]=l.useState(""),[i,c]=l.useState("PEM"),[h,f]=l.useState(!1),[p,N]=l.useState(null),[H,I]=l.useState(!1),[b,j]=l.useState(!1),[M,L]=l.useState("json"),[K,T]=l.useState("servicenow"),[J,O]=l.useState(!0),[R,A]=l.useState(""),[u,y]=l.useState(!1),[_,$]=l.useState(!1),[E,G]=l.useState(!1),[V,ye]=l.useState(null),[ze]=l.useState(!0),[te,Ie]=l.useState(!1),[se,Ee]=l.useState(!1),[re,Me]=l.useState(!1),[Y,qe]=l.useState(""),[P,be]=l.useState(null),[Te,we]=l.useState(!1),[Ae,Re]=l.useState(null),[ne,De]=l.useState(""),[ve]=l.useState(!0),[Q,He]=l.useState([]),[me,Ye]=l.useState(null),[Qe]=l.useState(!0),[he,Xe]=l.useState(""),[w,Ze]=l.useState(null),[Ke,et]=l.useState("HS256"),[ae,ge]=l.useState(!1),Se=l.useRef(null),_e=l.useRef(null),Ne=l.useRef(null),Ue=l.useRef(null);l.useRef(null);const{error:oe,header:U,payload:g,signature:z,headerRaw:tt,payloadRaw:st}=es(t),X=qt(g),Z=V||Date.now(),C=l.useMemo(()=>!U||!g?null:Tt(U,g,z,Z),[U,g,z,Z]),je=l.useMemo(()=>C?At(C.riskScore):null,[C]),rt=l.useMemo(()=>Gt(g),[g]),W=K||rt,ie=Bt[W];l.useMemo(()=>Vt(g,W),[g,W]);const nt=l.useMemo(()=>zt(g,W),[g,W]),at=X.icon,le=z&&z.length>0,D=U?.alg?.startsWith("HS");l.useEffect(()=>{le&&!b&&j(!0)},[le]),l.useEffect(()=>{N(null)},[t]),l.useEffect(()=>{const s=Ue.current;if(s){s.style.height="auto";const d=Math.min(s.scrollHeight,400);s.style.height=`${d}px`}},[t]),l.useEffect(()=>{const s=d=>{d.key==="Escape"&&u&&y(!1),d.key==="Escape"&&b&&j(!1)};return document.addEventListener("keydown",s),()=>document.removeEventListener("keydown",s)},[u,b]),l.useEffect(()=>{const s=d=>{Se.current&&!Se.current.contains(d.target)&&y(!1),_e.current&&!_e.current.contains(d.target)&&ge(!1),Ne.current&&!Ne.current.contains(d.target)&&f(!1)};return(u||ae||h)&&document.addEventListener("mousedown",s),()=>{document.removeEventListener("mousedown",s)}},[u,ae,h]);const ot=async()=>{if(!t)return;I(!0);const d=await Zt(t,D?a:n,U?.alg,i);N(d),I(!1)},it=s=>{const d=s.target.files[0];if(!d)return;const v=new FileReader;v.onload=k=>{if(i==="JWK")try{o(JSON.stringify(JSON.parse(k.target.result),null,2))}catch{o(k.target.result)}else o(k.target.result)},v.readAsText(d)},Je=async()=>{if(!Y.trim())return;we(!0),Re(null);const s=Ut(Y);if(s){be(s),we(!1);return}const d=await Kt(Y);d.success?(be(d.jwks),Jt(Y,d.jwks),U?.kid&&d.keys.length>0&&Oe(d.jwks,U.kid)&&De(U.kid)):(Re(d.error),be(null)),we(!1)};l.useEffect(()=>{if(P&&ne&&!D){const s=Oe(P,ne);s&&(c("JWK"),o(JSON.stringify(s,null,2)))}},[P,ne,D]),l.useEffect(()=>{if(g&&ve){const s=Object.keys(g).filter(d=>pe(d));s.length>0&&Q.length===0&&He(s)}},[g,ve]);const lt=s=>{He(d=>d.includes(s)?d.filter(v=>v!==s):[...d,s])};l.useEffect(()=>{if(U&&g){const s=$t(g,Q),d=Pt(U,s,z);Ye(d)}},[U,g,z,Q]);const ct=()=>{if(!t||!he)return;const s=Wt(t,he);Ze(s)},dt=s=>({text:"text-error",border:"border-error/40"});l.useMemo(()=>oe||g&&(X.tone==="error"||p?.verified===!1)?"error":null,[oe,g,X,p]);const ut=l.useMemo(()=>{if(!g)return[];const s=[];return s.push({label:"Structure",status:"success",icon:ee,message:"Valid"}),s.push({label:"Expiry",status:X.tone,icon:at,message:X.message}),le?p?.verified?s.push({label:"Signature",status:"success",icon:ee,message:"Verified"}):p?.verified===!1?s.push({label:"Signature",status:"error",icon:ce,message:"Invalid"}):s.push({label:"Signature",status:"warning",icon:B,message:"Not verified"}):s.push({label:"Signature",status:"warning",icon:B,message:"Missing"}),s},[g,X,le,p]);return e.jsxs("div",{className:"flex h-screen bg-white overflow-hidden",children:[e.jsx(bt,{currentPageId:"jwt",sidebarOpen:J,onSidebarToggle:O}),e.jsx("div",{className:"flex-1 overflow-y-auto bg-white",style:{width:"100%",minWidth:0},children:e.jsxs("div",{className:"mx-auto max-w-4xl w-full px-6 py-8",children:[e.jsxs("div",{className:"space-y-8",children:[e.jsxs("header",{className:"space-y-2",children:[e.jsx("h1",{className:"text-3xl font-semibold text-gray-900",children:"JWT Debugger"}),e.jsx("p",{className:"text-base text-gray-600",children:"Decode, verify, and inspect JSON Web Tokens"}),e.jsxs("div",{className:"relative",ref:Se,children:[e.jsxs("button",{className:"flex items-center gap-1.5 px-3 py-1.5 text-sm font-medium text-gray-700 hover:text-gray-900 transition-colors border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-sky-500 focus:ring-offset-1",onClick:()=>y(!u),onKeyDown:s=>{(s.key==="Enter"||s.key===" ")&&(s.preventDefault(),y(!u))},tabIndex:0,"aria-label":"Select company","aria-expanded":u,children:[e.jsx("span",{className:"whitespace-nowrap",children:ie.name}),e.jsx(F,{className:S("h-4 w-4 text-gray-500 transition-transform duration-200",u&&"rotate-180")})]}),u&&e.jsxs("div",{className:"absolute right-0 top-full mt-1 w-36 bg-white border border-gray-200 rounded-md shadow-lg z-50 overflow-hidden",children:[e.jsx("button",{onClick:()=>{T("servicenow"),y(!1)},className:S("w-full px-3 py-2 text-left text-sm transition-colors focus:outline-none",W==="servicenow"?"bg-sky-50 text-sky-700 font-medium":"text-gray-700 hover:bg-gray-50"),tabIndex:0,children:"ServiceNow"}),e.jsx("button",{onClick:()=>{T("salesforce"),y(!1)},className:S("w-full px-3 py-2 text-left text-sm transition-colors focus:outline-none",W==="salesforce"?"bg-sky-50 text-sky-700 font-medium":"text-gray-700 hover:bg-gray-50"),tabIndex:0,children:"Salesforce"})]})]})]}),e.jsx("div",{className:"space-y-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{htmlFor:"token-input",className:"text-sm font-medium text-gray-700",children:"JSON Web Token (JWT)"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>ge(!ae),onKeyDown:s=>{(s.key==="Enter"||s.key===" ")&&(s.preventDefault(),ge(!ae))},className:"px-3 py-1.5 text-xs font-medium text-gray-700 hover:text-gray-900 transition-colors focus:outline-none inline-flex items-center gap-1.5",tabIndex:0,children:[e.jsx(Le,{className:"h-3.5 w-3.5"}),"Generate example (",Ke,")",e.jsx(F,{className:"h-3 w-3"})]}),ae&&e.jsx("div",{className:"absolute right-0 top-full mt-2 w-40 border border-gray-200 rounded-lg bg-white shadow-lg z-50 overflow-y-auto max-h-64",children:["HS256","HS384","HS512","RS256","RS384","RS512","ES256","ES384","ES512"].map(s=>e.jsx("button",{onClick:async()=>{et(s),ge(!1);const{token:d,key:v,algorithm:k}=await Xt(s);r(d),k.startsWith("HS")?(m(v),o("")):(o(v),m(""),c("PEM")),b||j(!0)},className:S("w-full px-3 py-2 text-left text-sm transition-colors active:scale-[0.98] focus:outline-none",Ke===s?"bg-slate-100 font-medium text-slate-900":"text-slate-700 hover:bg-slate-50"),tabIndex:0,children:s},s))})]}),e.jsxs("button",{onClick:()=>q(t),onKeyDown:s=>{(s.key==="Enter"||s.key===" ")&&(s.preventDefault(),q(t))},onMouseDown:s=>{s.currentTarget.style.transform="scale(0.95)",s.currentTarget.style.backgroundColor="#e2e8f0"},onMouseUp:s=>{s.currentTarget.style.transform="",s.currentTarget.style.backgroundColor=""},onTouchStart:s=>{s.currentTarget.style.transform="scale(0.95)",s.currentTarget.style.backgroundColor="#e2e8f0"},onTouchEnd:s=>{setTimeout(()=>{s.currentTarget.style.transform="",s.currentTarget.style.backgroundColor=""},150)},className:"inline-flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-gray-700 hover:text-gray-900 transition-colors focus:outline-none",tabIndex:0,children:[e.jsx(ke,{className:"h-3.5 w-3.5"}),"Copy"]}),e.jsx("button",{onClick:()=>r(""),onKeyDown:s=>{(s.key==="Enter"||s.key===" ")&&(s.preventDefault(),r(""))},className:"px-3 py-1.5 text-xs font-medium text-gray-700 hover:text-gray-900 transition-colors focus:outline-none",tabIndex:0,children:"Clear"})]})]})}),e.jsxs("div",{className:"relative",children:[e.jsx("textarea",{ref:Ue,id:"token-input",value:t,onChange:s=>{r(s.target.value),s.target.style.height="auto";const d=Math.min(s.target.scrollHeight,400);s.target.style.height=`${d}px`},placeholder:"Paste a JWT token here...",className:"min-h-[120px] max-h-[400px] w-full resize-none border border-gray-200 rounded-lg bg-white px-4 py-3 font-mono text-sm leading-relaxed text-gray-900 placeholder:text-gray-400 focus:outline-none focus:ring-2 focus:ring-sky-500 focus:border-sky-500 transition-colors overflow-y-auto",style:{color:"transparent",caretColor:"#111827",height:"auto"},tabIndex:0}),t&&e.jsx("div",{className:"absolute inset-0 pointer-events-none px-4 py-3 font-mono text-sm leading-relaxed overflow-hidden rounded-lg bg-white",style:{maxHeight:"400px",overflowY:"auto"},children:e.jsx("pre",{className:"whitespace-pre-wrap break-all",children:(()=>{const s=t.split(".");return s.length!==3?e.jsx("span",{className:"text-gray-900",children:t}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-sky-600",children:s[0]}),e.jsx("span",{className:"text-gray-400",children:"."}),e.jsx("span",{className:"text-purple-600",children:s[1]}),e.jsx("span",{className:"text-gray-400",children:"."}),e.jsx("span",{className:"text-green-600",children:s[2]})]})})()})})]}),oe&&e.jsxs("div",{className:"mt-3 flex items-center gap-2 text-sm text-red-600 bg-red-50 px-4 py-2 rounded-lg",children:[e.jsx(B,{className:"h-4 w-4 flex-shrink-0"}),e.jsx("span",{children:oe})]}),!oe&&g&&e.jsxs("div",{className:"mt-3 flex items-center gap-6 text-sm flex-wrap bg-green-50 px-4 py-2 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ee,{className:"h-4 w-4 text-green-600"}),e.jsx("span",{className:"font-medium text-gray-900",children:"Valid JWT"})]}),ut.map((s,d)=>{const v=s.icon,k=Yt[s.status];return e.jsxs(ft.Fragment,{children:[d>0&&e.jsx("span",{className:"text-gray-300 mx-2",children:"·"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(v,{className:S("h-4 w-4",k.text)}),e.jsxs("span",{className:S("font-medium",k.text),children:[s.label,": ",e.jsx("span",{className:"text-gray-600",children:s.message})]})]})]},s.label)})]})]}),g&&e.jsxs(e.Fragment,{children:[C&&C.issues.length>0&&e.jsxs("div",{className:"mb-6 border border-gray-300 rounded-lg bg-white overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between bg-gray-50 px-4 py-3 border-b border-gray-300 cursor-pointer hover:bg-gray-100 transition-colors",onClick:()=>G(!E),children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsx(Fe,{className:"h-5 w-5 text-slate-600"}),e.jsx("span",{className:"text-base font-semibold text-slate-900",children:"Security Analysis"}),e.jsxs("span",{className:S("ml-2 px-2 py-0.5 rounded text-xs font-semibold",je?.bg,je?.color),children:[C.issues.length," ",C.issues.length===1?"Issue":"Issues"]}),!E&&e.jsxs("span",{className:"ml-2 text-xs text-slate-500",children:["• ",C.issues.filter(s=>s.severity===x.CRITICAL).length>0&&`${C.issues.filter(s=>s.severity===x.CRITICAL).length} Critical`,C.issues.filter(s=>s.severity===x.HIGH).length>0&&`, ${C.issues.filter(s=>s.severity===x.HIGH).length} High`,C.issues.filter(s=>s.severity===x.MEDIUM).length>0&&`, ${C.issues.filter(s=>s.severity===x.MEDIUM).length} Medium`,"• ",je?.level," Risk (",C.riskScore,"/100)"]})]}),e.jsx("button",{onClick:s=>{s.stopPropagation(),G(!E)},className:"p-1 text-gray-500 hover:text-gray-700 transition-colors focus:outline-none",tabIndex:0,children:E?e.jsx(de,{className:"h-4 w-4"}):e.jsx(F,{className:"h-4 w-4"})})]}),E&&e.jsx("div",{className:"p-4 space-y-3 bg-white",children:C.issues.map((s,d)=>{const v={[x.CRITICAL]:{text:"text-red-700",bg:"bg-red-50",border:"border-red-200",icon:ce},[x.HIGH]:{text:"text-orange-700",bg:"bg-orange-50",border:"border-orange-200",icon:B},[x.MEDIUM]:{text:"text-yellow-700",bg:"bg-yellow-50",border:"border-yellow-200",icon:B},[x.LOW]:{text:"text-sky-700",bg:"bg-sky-50",border:"border-sky-200",icon:fe},[x.INFO]:{text:"text-slate-700",bg:"bg-slate-50",border:"border-slate-200",icon:fe}},k=v[s.severity]||v[x.INFO],mt=k.icon;return e.jsx("div",{className:S("rounded p-3",k.bg),children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(mt,{className:S("h-4 w-4 mt-0.5 flex-shrink-0",k.text)}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:S("font-medium text-sm",k.text),children:s.title}),e.jsx("span",{className:S("text-xs font-medium px-2 py-0.5 rounded uppercase",k.bg,k.text,k.border,"border"),children:s.severity})]}),e.jsx("p",{className:"text-sm text-gray-700 mb-2",children:s.message}),s.recommendation&&e.jsxs("div",{className:"mt-2 pt-2 border-t border-gray-200",children:[e.jsx("p",{className:"text-xs font-medium text-gray-600 mb-1",children:"Recommendation:"}),e.jsx("p",{className:"text-xs text-gray-700",children:s.recommendation})]})]})]})},d)})})]}),e.jsxs("div",{className:"grid gap-4 lg:grid-cols-2 mb-4",children:[e.jsx(xe,{title:"Decoded Header",content:Pe(tt),description:"Signing algorithm and token type",onCopy:q,viewMode:"json",theme:ie,statusColor:null,isHeader:!0}),e.jsx(xe,{title:"Key Claims",content:(()=>{const s={};return We.forEach(d=>{const v=g?.[d];v!=null&&(d==="iat"||d==="exp"||d==="nbf"?s[d]=Dt(v,Z):s[d]=v)}),JSON.stringify(s,null,2)})(),description:"Important JWT claims",onCopy:q,viewMode:"json",theme:ie,statusColor:null,isHeader:!0,payload:g,targetClaims:We,getClaimInfo:Rt,companyClaimSet:nt,currentCompany:W,currentTime:Z,calculateTTL:Ht})]}),e.jsxs("div",{className:"grid gap-4 lg:grid-cols-2 mb-4",children:[e.jsx(xe,{title:"Decoded Payload",content:Pe(st),description:"Claims and user data",onCopy:q,viewMode:M,onViewModeChange:L,theme:ie,statusColor:null}),le&&e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsx(xe,{title:"Signature",content:z,description:"Cryptographic signature",onCopy:q,viewMode:"json",theme:ie,statusColor:p?.verified===!1?dt():null,isHeader:!0}),e.jsxs("div",{className:"mt-4 flex-1 flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between px-2 py-2",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[e.jsx("span",{className:"text-xs font-medium text-gray-600 uppercase tracking-wide",children:"Verify Signature"}),!D&&e.jsx(Ve,{content:e.jsxs("div",{className:"max-w-xs",children:[e.jsx("p",{className:"font-semibold mb-1 text-sm text-white",children:"Supported Algorithms"}),e.jsx("p",{className:"text-xs text-gray-300 leading-relaxed",children:"RSA: RS256, RS384, RS512 | ECDSA: ES256, ES384, ES512. Paste your public key in PEM or JWK format, or upload a file."})]}),position:"bottom",children:e.jsx(fe,{className:"h-3.5 w-3.5 text-gray-400 hover:text-gray-600 cursor-help flex-shrink-0"})}),p&&e.jsxs("div",{className:S("ml-2 flex items-center gap-1.5 px-2 py-0.5 rounded text-xs font-medium flex-shrink-0",p.verified?"bg-green-100 text-green-700":"bg-red-100 text-red-700"),children:[p.verified?e.jsx(ee,{className:"h-3.5 w-3.5"}):e.jsx(ce,{className:"h-3.5 w-3.5"}),e.jsx("span",{children:p.verified?"Verified":"Failed"})]})]}),e.jsx("button",{onClick:()=>j(!b),className:"flex-shrink-0 p-1 text-gray-500 hover:text-gray-700 transition-colors focus:outline-none",tabIndex:0,"aria-label":b?"Collapse":"Expand",children:b?e.jsx(de,{className:"h-4 w-4"}):e.jsx(F,{className:"h-4 w-4"})})]}),b&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:D?"Secret":"Public Key"}),e.jsx("textarea",{value:D?a:n,onChange:s=>{D?m(s.target.value):o(s.target.value),N(null)},placeholder:D?"Enter the secret used to sign the JWT":i==="PEM"?`-----BEGIN PUBLIC KEY-----
MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8A...
-----END PUBLIC KEY-----`:`{
  "kty": "RSA",
  "n": "...",
  "e": "AQAB"
}`,className:"w-full h-28 resize-none border border-gray-300 rounded bg-white px-3 py-2 font-mono text-xs leading-relaxed text-gray-900 placeholder:text-gray-400 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500 transition-colors",tabIndex:0})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:ot,disabled:!t||!D&&!n||D&&!a||H,className:"px-4 py-2 text-sm font-medium text-white bg-sky-500 hover:bg-sky-600 rounded-lg transition-colors disabled:bg-gray-300 disabled:cursor-not-allowed disabled:hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-sky-500 focus:ring-offset-1",tabIndex:0,children:H?"Verifying...":"Verify Signature"}),e.jsxs("div",{className:"flex items-center gap-2 ml-auto",children:[!D&&e.jsxs(e.Fragment,{children:[e.jsxs("label",{className:"inline-flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-gray-700 hover:text-gray-900 cursor-pointer transition-colors focus-within:outline-none",children:[e.jsx(wt,{className:"h-3.5 w-3.5"}),"Upload",e.jsx("input",{type:"file",accept:".pem,.key,.crt,.pub,.json",onChange:it,className:"hidden",tabIndex:0})]}),e.jsxs("div",{className:"relative",ref:Ne,children:[e.jsxs("button",{type:"button",onClick:()=>f(!h),className:"inline-flex items-center gap-1.5 px-3 py-1.5 text-sm font-medium text-gray-700 hover:text-gray-900 border border-gray-300 rounded-lg bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-sky-500 focus:ring-offset-1 transition-colors",tabIndex:0,children:[e.jsx("span",{children:i}),e.jsx(F,{className:S("h-4 w-4 text-gray-400 transition-transform duration-200",h&&"rotate-180")})]}),h&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>f(!1)}),e.jsxs("div",{className:"absolute right-0 top-full mt-2 w-32 bg-white border border-gray-300 rounded-lg shadow-lg z-50 overflow-hidden",children:[e.jsx("button",{onClick:()=>{c("PEM"),o(""),N(null),f(!1)},className:S("w-full px-4 py-2.5 text-left text-sm transition-colors focus:outline-none border-b border-gray-100 last:border-b-0",i==="PEM"?"bg-sky-50 text-sky-600 font-medium":"text-gray-700 hover:bg-gray-50"),tabIndex:0,children:"PEM"}),e.jsx("button",{onClick:()=>{c("JWK"),o(""),N(null),f(!1)},className:S("w-full px-4 py-2.5 text-left text-sm transition-colors focus:outline-none border-b border-gray-100 last:border-b-0",i==="JWK"?"bg-sky-50 text-sky-600 font-medium":"text-gray-700 hover:bg-gray-50"),tabIndex:0,children:"JWK"})]})]})]})]}),(n||a)&&e.jsxs("button",{onClick:()=>{o(""),m(""),N(null)},className:"inline-flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-gray-700 hover:text-gray-900 transition-colors focus:outline-none",tabIndex:0,children:[e.jsx(ce,{className:"h-3.5 w-3.5"}),"Clear"]})]})]}),p&&!p.verified&&e.jsx("div",{className:"bg-red-50 px-3 py-2 rounded",children:e.jsxs("div",{className:"flex items-center gap-2 text-sm text-red-700",children:[e.jsx(ce,{className:"h-4 w-4 flex-shrink-0"}),e.jsx("span",{children:p.error||"Signature verification failed"})]})})]})]})]})]}),ze&&e.jsxs("div",{className:"mb-6 border border-gray-300 rounded-lg bg-white overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between border-b border-gray-300 bg-gray-50 px-4 py-3 cursor-pointer hover:bg-gray-100 transition-colors",onClick:()=>Ie(!te),children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsx(vt,{className:"h-4 w-4 text-gray-600"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:"Time Simulation"}),!te&&e.jsxs("span",{className:"text-xs text-gray-500 ml-2",children:[V?`Simulated: ${new Date(V).toLocaleString()}`:"Real time",g?.exp&&` • Token ${g.exp*1e3<Z?"expired":"valid"}`]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("button",{onClick:s=>{s.stopPropagation(),Ie(!te)},className:"p-1 text-gray-500 hover:text-gray-700 transition-colors focus:outline-none",tabIndex:0,children:te?e.jsx(de,{className:"h-4 w-4"}):e.jsx(F,{className:"h-4 w-4"})})})]}),te&&e.jsxs("div",{className:"p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-4 flex-wrap",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 whitespace-nowrap",children:"Current Time:"}),e.jsx("input",{type:"datetime-local",value:V?new Date(V).toISOString().slice(0,16):new Date().toISOString().slice(0,16),onChange:s=>{const d=new Date(s.target.value).getTime();ye(d)},className:"border border-gray-300 rounded bg-white px-3 py-1.5 text-sm text-gray-900 focus:outline-none focus:ring-2 focus:ring-sky-500 focus:border-sky-500 transition-colors"}),e.jsx("button",{onClick:()=>{const s=Date.now(),d=prompt("Fast-forward hours (negative to go back):","0");d!==null&&!isNaN(parseFloat(d))&&ye(s+parseFloat(d)*60*60*1e3)},className:"px-3 py-1.5 text-xs font-medium text-gray-700 hover:text-gray-900 transition-colors focus:outline-none",children:"Fast Forward"}),e.jsx("button",{onClick:()=>ye(null),className:"px-3 py-1.5 text-xs font-medium text-gray-700 hover:text-gray-900 transition-colors focus:outline-none",children:"Reset"})]}),g?.exp&&e.jsx("div",{className:"pt-3 border-t border-gray-100",children:e.jsxs("p",{className:"text-sm text-gray-600",children:["Token ",g.exp*1e3<Z?"expired":"valid"," at simulated time"]})})]})]}),!D&&e.jsxs("div",{className:"mb-4 border-t border-gray-200 pt-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(Be,{className:"h-4 w-4 text-gray-600"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:"JWKS (JSON Web Key Set)"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"url",value:Y,onChange:s=>qe(s.target.value),placeholder:"https://example.com/.well-known/jwks.json",className:"flex-1 border border-gray-300 rounded bg-white px-3 py-2 text-sm text-gray-900 placeholder:text-gray-400 focus:outline-none focus:ring-2 focus:ring-sky-500 focus:border-sky-500 transition-colors",onKeyDown:s=>{s.key==="Enter"&&Je()}}),e.jsx("button",{onClick:Je,disabled:Te||!Y.trim(),className:"inline-flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-sky-500 hover:bg-sky-600 rounded-lg transition-colors disabled:bg-gray-300 disabled:cursor-not-allowed disabled:hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-sky-500",children:Te?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"h-4 w-4 border-2 border-slate-400 border-t-transparent rounded-full animate-spin"}),"Loading..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Le,{className:"h-4 w-4"}),"Fetch"]})})]}),Ae&&e.jsx("div",{className:"bg-red-50 px-3 py-2 rounded text-sm text-red-700",children:Ae}),P&&P.keys&&P.keys.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Select Key:"}),e.jsxs("select",{value:ne,onChange:s=>De(s.target.value),className:"w-full border border-gray-300 rounded bg-white px-3 py-2 text-sm text-gray-900 focus:outline-none focus:ring-2 focus:ring-sky-500 focus:border-sky-500 transition-colors cursor-pointer hover:bg-gray-50",children:[e.jsx("option",{value:"",children:"-- Select a key --"}),P.keys.map((s,d)=>e.jsxs("option",{value:s.kid||d,children:[s.kid||`Key ${d+1}`," (",s.alg||"N/A",")"]},d))]}),e.jsxs("p",{className:"text-xs text-gray-500",children:["Found ",P.keys.length," key(s). ",ne?"Key selected for verification.":"Select a key to use for verification."]})]})]})]}),ve&&g&&e.jsxs("div",{className:"mb-6 border border-gray-300 rounded-lg bg-white overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between border-b border-gray-300 bg-gray-50 px-4 py-3 cursor-pointer hover:bg-gray-100 transition-colors",onClick:()=>Ee(!se),children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsx(St,{className:"h-5 w-5 text-slate-600"}),e.jsx("span",{className:"text-base font-semibold text-slate-900",children:"Redact Sensitive Claims"}),!se&&e.jsxs("span",{className:"text-xs text-slate-500 ml-2",children:["• ",Q.length," claim",Q.length!==1?"s":""," selected",me?" • Redacted token ready":""]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("button",{onClick:s=>{s.stopPropagation(),Ee(!se)},className:"p-1.5 hover:bg-slate-200 rounded-lg transition focus:outline-none focus:ring-2 focus:ring-slate-300",tabIndex:0,children:se?e.jsx(de,{className:"h-4 w-4 text-slate-600"}):e.jsx(F,{className:"h-4 w-4 text-slate-600"})})})]}),se&&e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Select claims to redact:"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2 max-h-48 overflow-y-auto",children:Object.keys(g).map(s=>e.jsxs("label",{className:"flex items-center gap-2 p-2 rounded border border-slate-200 hover:bg-slate-50 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:Q.includes(s),onChange:()=>lt(s),className:"rounded"}),e.jsxs("span",{className:S("text-sm",pe(s)?"font-semibold text-red-700":"text-slate-700"),children:[s,pe(s)&&e.jsx("span",{className:"ml-1 text-xs text-red-500",children:"(sensitive)"})]})]},s))})]}),me&&e.jsxs("div",{className:"pt-3 border-t border-gray-100",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Redacted Token:"}),e.jsx("textarea",{value:me,readOnly:!0,className:"w-full h-24 resize-none border border-gray-300 rounded bg-gray-50 px-3 py-2 font-mono text-xs text-gray-700"}),e.jsxs("button",{onClick:()=>q(me),className:"mt-2 inline-flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-gray-700 hover:text-gray-900 transition-colors focus:outline-none",children:[e.jsx(ke,{className:"h-3.5 w-3.5"}),"Copy Redacted Token"]})]})]})]}),Qe&&e.jsxs("div",{className:"mb-6 border border-gray-300 rounded-lg bg-white overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between border-b border-gray-300 bg-gray-50 px-4 py-3 cursor-pointer hover:bg-gray-100 transition-colors",onClick:()=>Me(!re),children:[e.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[e.jsx(Nt,{className:"h-4 w-4 text-gray-600"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:"Compare Tokens"}),!re&&e.jsx("span",{className:"text-xs text-gray-500 ml-2",children:w?`${w.summary.headerChanges+w.summary.payloadChanges} difference${w.summary.headerChanges+w.summary.payloadChanges!==1?"s":""}`:"Paste second token to compare"})]}),e.jsx("button",{onClick:s=>{s.stopPropagation(),Me(!re)},className:"p-1 text-gray-500 hover:text-gray-700 transition-colors focus:outline-none",tabIndex:0,children:re?e.jsx(de,{className:"h-4 w-4"}):e.jsx(F,{className:"h-4 w-4"})})]}),re&&e.jsxs("div",{className:"p-4 space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Second Token:"}),e.jsx("textarea",{value:he,onChange:s=>Xe(s.target.value),placeholder:"Paste the second JWT token to compare",className:"w-full h-32 resize-none border border-gray-300 rounded bg-white px-3 py-2 font-mono text-sm text-gray-900 placeholder:text-gray-400 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500 transition-colors"})]}),e.jsx("button",{onClick:ct,disabled:!t||!he,className:"px-4 py-2 text-sm font-medium text-white bg-sky-500 hover:bg-sky-600 rounded-lg transition-colors disabled:bg-gray-300 disabled:cursor-not-allowed disabled:hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-sky-500 focus:ring-offset-1",children:"Compare Tokens"}),w&&e.jsxs("div",{className:"pt-3 border-t border-gray-100 space-y-3",children:[e.jsxs("div",{className:"bg-gray-50 px-3 py-2 rounded",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 mb-1",children:"Summary:"}),e.jsx("p",{className:"text-sm text-gray-700",children:w?Ft(w):""})]}),w.valid&&e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 mb-2",children:"Header Changes:"}),e.jsxs("div",{className:"space-y-1 text-xs",children:[w.headerDiff.added.length>0&&e.jsxs("div",{className:"text-green-700",children:["+ ",w.headerDiff.added.length," added"]}),w.headerDiff.removed.length>0&&e.jsxs("div",{className:"text-red-700",children:["- ",w.headerDiff.removed.length," removed"]}),w.headerDiff.changed.length>0&&e.jsxs("div",{className:"text-yellow-700",children:["~ ",w.headerDiff.changed.length," changed"]})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 mb-2",children:"Payload Changes:"}),e.jsxs("div",{className:"space-y-1 text-xs",children:[w.payloadDiff.added.length>0&&e.jsxs("div",{className:"text-green-700",children:["+ ",w.payloadDiff.added.length," added"]}),w.payloadDiff.removed.length>0&&e.jsxs("div",{className:"text-red-700",children:["- ",w.payloadDiff.removed.length," removed"]}),w.payloadDiff.changed.length>0&&e.jsxs("div",{className:"text-yellow-700",children:["~ ",w.payloadDiff.changed.length," changed"]})]})]})]})]})]})]})]})]})})]})};xt.createRoot(document.getElementById("root")).render(e.jsx(ts,{}));
//# sourceMappingURL=jwt-BxwYV_rU.js.map
