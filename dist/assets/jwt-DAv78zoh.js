import{c as ws,S as ss,F as vs,R as Ns,j as e,r as i,a as js}from"./styles-C2Snwmvq.js";import{K as ts,N as Ss,F as ks,C as G,c as b}from"./clsx-BZvGQT-f.js";import{N as Cs,C as ge}from"./Navigation-CgQ4oWS-.js";import{C as le}from"./circle-check-BUvpvTL2.js";import{X as ie,C as ue}from"./x-BEBW2Z4Y.js";import{C as V}from"./circle-alert-B-EaIt9S.js";import{R as qe}from"./refresh-cw-DuNrCsK6.js";import{I as pe}from"./info-7TTk-aLq.js";import{U as Is}from"./upload-D4tqkKhS.js";import{C as Es}from"./clock-Bpwbk4Kn.js";import{L as As,G as Ts}from"./lock-Cz5DkrpG.js";const Ms=[["path",{d:"M12 3v18",key:"108xh3"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}]],rs=ws("table",Ms);class fe extends Error{}fe.prototype.name="InvalidTokenError";function Rs(s){return decodeURIComponent(atob(s).replace(/(.)/g,(r,a)=>{let o=a.charCodeAt(0).toString(16).toUpperCase();return o.length<2&&(o="0"+o),"%"+o}))}function Ds(s){let r=s.replace(/-/g,"+").replace(/_/g,"/");switch(r.length%4){case 0:break;case 2:r+="==";break;case 3:r+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return Rs(r)}catch{return atob(r)}}function Hs(s,r){if(typeof s!="string")throw new fe("Invalid token specified: must be a string");r||(r={});const a=r.header===!0?0:1,o=s.split(".")[a];if(typeof o!="string")throw new fe(`Invalid token specified: missing part #${a+1}`);let n;try{n=Ds(o)}catch(x){throw new fe(`Invalid token specified: invalid base64 for part #${a+1} (${x.message})`)}try{return JSON.parse(n)}catch(x){throw new fe(`Invalid token specified: invalid json for part #${a+1} (${x.message})`)}}const w={CRITICAL:"critical",HIGH:"high",MEDIUM:"medium",LOW:"low",INFO:"info"},Ks={iss:{name:"Issuer",description:"Identifies the principal that issued the JWT",required:!1,category:"Standard"},sub:{name:"Subject",description:"Identifies the subject of the JWT (usually the user)",required:!1,category:"Standard"},aud:{name:"Audience",description:"Identifies the recipients that the JWT is intended for. Should always be present in production tokens.",required:!1,recommended:!0,category:"Standard"},exp:{name:"Expiration Time",description:"Identifies the expiration time on or after which the JWT must not be accepted for processing",required:!1,recommended:!0,category:"Standard"},nbf:{name:"Not Before",description:"Identifies the time before which the JWT must not be accepted for processing",required:!1,category:"Standard"},iat:{name:"Issued At",description:"Identifies the time at which the JWT was issued",required:!1,recommended:!0,category:"Standard"},jti:{name:"JWT ID",description:"Provides a unique identifier for the JWT. Can be used to prevent token replay attacks.",required:!1,category:"Standard"},email:{name:"Email",description:"User email address",required:!1,category:"Custom"},name:{name:"Name",description:"User full name",required:!1,category:"Custom"},scope:{name:"Scope",description:"OAuth 2.0 scope values",required:!1,category:"OAuth"},sys_id:{name:"ServiceNow Sys ID",description:"ServiceNow system record identifier",required:!1,category:"ServiceNow"},user_name:{name:"ServiceNow Username",description:"ServiceNow user name",required:!1,category:"ServiceNow"},instance:{name:"ServiceNow Instance",description:"ServiceNow instance identifier",required:!1,category:"ServiceNow"},organization_id:{name:"Salesforce Organization ID",description:"Salesforce organization identifier",required:!1,category:"Salesforce"},user_id:{name:"Salesforce User ID",description:"Salesforce user identifier",required:!1,category:"Salesforce"}},_s=(s,r,a,o=Date.now())=>{const n=[];if(!s)return n.push({severity:w.CRITICAL,code:"MISSING_HEADER",title:"Missing Header",message:"JWT header is missing or invalid",recommendation:"Ensure the token has a valid header segment"}),{issues:n,riskScore:100};if(!r)return n.push({severity:w.CRITICAL,code:"MISSING_PAYLOAD",title:"Missing Payload",message:"JWT payload is missing or invalid",recommendation:"Ensure the token has a valid payload segment"}),{issues:n,riskScore:100};const x=s.alg;if((x==="none"||x==="None"||x==="NONE")&&n.push({severity:w.CRITICAL,code:"NONE_ALGORITHM",title:"None Algorithm Detected",message:'Token uses the "none" algorithm, which provides no security',recommendation:'Never use the "none" algorithm in production. Use HS256, RS256, or ES256.',riskScore:100}),(!a||a.length===0)&&n.push({severity:w.HIGH,code:"MISSING_SIGNATURE",title:"Missing Signature",message:"Token has no signature (unsigned token)",recommendation:"Always sign tokens in production to ensure integrity and authenticity",riskScore:80}),!r.exp)n.push({severity:w.HIGH,code:"MISSING_EXP",title:"Missing Expiration Claim",message:"Token has no expiration time (exp claim)",recommendation:"Always include an expiration time to limit token lifetime and reduce risk if compromised",riskScore:70});else{const c=r.exp*1e3;if(c<o){const h=Math.floor((o-c)/864e5);n.push({severity:w.HIGH,code:"EXPIRED_TOKEN",title:"Token Expired",message:`Token expired ${h>0?`${h} day(s)`:"recently"} ago`,recommendation:"Do not accept expired tokens. Request a new token from the identity provider",riskScore:60})}}if(r.aud||n.push({severity:w.HIGH,code:"MISSING_AUD",title:"Missing Audience Claim",message:"Token has no audience (aud claim)",recommendation:"Include an audience claim to ensure tokens are only used by intended recipients",riskScore:65}),!r.iat)n.push({severity:w.MEDIUM,code:"MISSING_IAT",title:"Missing Issued At Claim",message:"Token has no issued at time (iat claim)",recommendation:"Include iat claim to track when the token was issued",riskScore:30});else{const h=(r.iat*1e3-o)/(1e3*60);h>5&&n.push({severity:w.MEDIUM,code:"FUTURE_IAT",title:"Future Issued At Time",message:`Token appears to be issued ${Math.round(h)} minutes in the future`,recommendation:"Check system clocks for clock skew between issuer and validator",riskScore:40})}if(r.exp&&r.iat){const c=(r.exp-r.iat)/3600;c>24&&n.push({severity:w.MEDIUM,code:"LONG_EXPIRY",title:"Long Token Lifetime",message:`Token lifetime is ${Math.round(c)} hours (${Math.round(c/24)} days)`,recommendation:"Access tokens should typically expire within 1 hour. Use refresh tokens for longer sessions",riskScore:45})}if(x==="HS256"&&n.push({severity:w.MEDIUM,code:"WEAK_ALGORITHM",title:"HMAC Algorithm Used",message:"Token uses HMAC (symmetric) signing algorithm",recommendation:"Consider using RS256 or ES256 (asymmetric) for better key management in distributed systems",riskScore:35,note:"HS256 is acceptable if secret is properly managed"}),r.jti||n.push({severity:w.LOW,code:"MISSING_JTI",title:"Missing JWT ID",message:"Token has no unique identifier (jti claim)",recommendation:"Include jti claim to enable token revocation and prevent replay attacks",riskScore:20}),r.nbf){const c=r.nbf*1e3;if(c>o){const h=Math.round((c-o)/6e4);n.push({severity:w.INFO,code:"NOT_YET_VALID",title:"Token Not Yet Valid",message:`Token will be valid in ${h} minutes`,recommendation:"Wait until nbf time before accepting this token",riskScore:10})}}const l=Math.min(100,Math.max(0,n.reduce((c,h)=>c+(h.riskScore||0),0)/Math.max(n.length,1)));return{issues:n,riskScore:l}},Js=s=>s>=80?{level:"Critical",color:"text-red-600",bg:"bg-red-50",border:"border-red-200"}:s>=60?{level:"High",color:"text-orange-600",bg:"bg-orange-50",border:"border-orange-200"}:s>=40?{level:"Medium",color:"text-yellow-600",bg:"bg-yellow-50",border:"border-yellow-200"}:s>=20?{level:"Low",color:"text-blue-600",bg:"bg-blue-50",border:"border-blue-200"}:{level:"Info",color:"text-green-600",bg:"bg-green-50",border:"border-green-200"},Ye=s=>Ks[s]||{name:s,description:"Custom claim",required:!1,category:"Custom"},Ws=(s,r=Date.now())=>{if(!s)return"—";const a=typeof s=="number"?s*1e3:s,o=new Date(a);if(Number.isNaN(o.getTime()))return"Invalid timestamp";const n=Math.floor((a-r)/1e3),x=Math.floor(n/60),l=Math.floor(x/60),c=Math.floor(l/24),h=new Intl.RelativeTimeFormat("en",{numeric:"auto"});return Math.abs(c)>0?`${o.toLocaleString()} (${h.format(c,"day")})`:Math.abs(l)>0?`${o.toLocaleString()} (${h.format(l,"hour")})`:Math.abs(x)>0?`${o.toLocaleString()} (${h.format(x,"minute")})`:`${o.toLocaleString()} (${h.format(n,"second")})`},Us=async s=>{try{const r=await fetch(s);if(!r.ok)throw new Error(`HTTP ${r.status}: ${r.statusText}`);const a=await r.json();if(!a.keys||!Array.isArray(a.keys))throw new Error("Invalid JWKS format: missing keys array");return{success:!0,jwks:a,keys:a.keys,count:a.keys.length}}catch(r){return{success:!1,error:r.message||"Failed to fetch JWKS",jwks:null,keys:[],count:0}}},Qe=(s,r)=>!s||!s.keys?null:s.keys.find(a=>a.kid===r)||null,as=new Map,Ls=300*1e3,Os=s=>{const r=as.get(s);return r&&Date.now()-r.timestamp<Ls?r.jwks:null},Ps=(s,r)=>{as.set(s,{jwks:r,timestamp:Date.now()})},$s=["password","secret","token","access_token","refresh_token","api_key","apikey","auth","authorization","credit_card","ssn","social_security","pin","pii","phi"],Fs=[/password/i,/secret/i,/token/i,/key/i,/auth/i,/credential/i,/passphrase/i,/private/i],je=s=>{const r=s.toLowerCase();return $s.some(a=>r.includes(a))?!0:Fs.some(a=>a.test(s))},Bs=(s,r=[],a="*",o=8)=>{if(!s)return s;const n={...s},x=new Set(r);return r.length===0&&Object.keys(s).forEach(l=>{je(l)&&x.add(l)}),x.forEach(l=>{if(l in n){const c=n[l];typeof c=="string"?n[l]=a.repeat(Math.min(o,c.length))+(c.length>o?"...":""):typeof c=="object"&&c!==null?n[l]="[REDACTED]":n[l]=a.repeat(o)}}),n},Gs=(s,r,a="")=>{try{const o=l=>{const c=encodeURIComponent(l).replace(/%([0-9A-F]{2})/g,(h,p)=>String.fromCharCode(parseInt(p,16)));return btoa(c).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")},n=o(JSON.stringify(s)),x=o(JSON.stringify(r));return`${n}.${x}.${a.substring(0,10)}...REDACTED`}catch{return null}},Vs=(s,r)=>{const a=h=>{if(!h)return null;const p=h.split(".");if(p.length!==3)return null;try{const m=v=>{const S=v.replace(/-/g,"+").replace(/_/g,"/").padEnd(v.length+(v.length%4?4-v.length%4:0),"="),I=atob(S);try{return decodeURIComponent(I.split("").map(M=>`%${`00${M.charCodeAt(0).toString(16)}`.slice(-2)}`).join(""))}catch{return I}},f=m(p[0]),j=m(p[1]);return{header:JSON.parse(f),payload:JSON.parse(j),signature:p[2],headerRaw:f,payloadRaw:j}}catch{return null}},o=a(s),n=a(r);if(!o||!n)return{valid:!1,error:"One or both tokens are invalid"};const x=Xe(o.header,n.header),l=Xe(o.payload,n.payload),c=o.signature===n.signature;return{valid:!0,token1:o,token2:n,headerDiff:x,payloadDiff:l,signaturesMatch:c,summary:{headerChanges:x.added.length+x.removed.length+x.changed.length,payloadChanges:l.added.length+l.removed.length+l.changed.length,signaturesMatch:c}}},Xe=(s,r)=>{const a=new Set([...Object.keys(s||{}),...Object.keys(r||{})]),o=[],n=[],x=[],l=[];return a.forEach(c=>{const h=s?.[c],p=r?.[c];c in(s||{})?c in(r||{})?JSON.stringify(h)!==JSON.stringify(p)?x.push({key:c,oldValue:h,newValue:p}):l.push({key:c,value:h}):n.push({key:c,value:h}):o.push({key:c,value:p})}),{added:o,removed:n,changed:x,unchanged:l}},zs=s=>{if(!s.valid)return s.error||"Comparison failed";const{headerDiff:r,payloadDiff:a,signaturesMatch:o}=s,n=[];return r.added.length>0&&n.push(`${r.added.length} header field(s) added`),r.removed.length>0&&n.push(`${r.removed.length} header field(s) removed`),r.changed.length>0&&n.push(`${r.changed.length} header field(s) changed`),a.added.length>0&&n.push(`${a.added.length} claim(s) added`),a.removed.length>0&&n.push(`${a.removed.length} claim(s) removed`),a.changed.length>0&&n.push(`${a.changed.length} claim(s) changed`),o?n.push("Signatures match"):n.push("Signatures differ"),n.join(", ")||"Tokens are identical"},qs={servicenow:{name:"ServiceNow",primary:"#81B5A1",primaryDark:"#5A8F7A",primaryLight:"#A8D4C4",bgGradient:"from-green-50 to-emerald-50",badgeBg:"#81B5A1",badgeText:"#FFFFFF"},salesforce:{name:"Salesforce",primary:"#00A1E0",primaryDark:"#0070D2",primaryLight:"#4FC3F7",bgGradient:"from-blue-50 to-cyan-50",badgeBg:"#00A1E0",badgeText:"#FFFFFF"}},Ys=s=>!s||s.sys_id||s.instance||s.instance_url||s.user_name||s.email&&s.email.includes("servicenow")?"servicenow":s.organization_id||s.user_id||s.sfdc_instance_url||s.scope||s.email&&s.email.includes("salesforce")?"salesforce":"servicenow",Qs=(s,r)=>{if(!s)return[];const a=[];return r==="servicenow"?(s.sys_id&&a.push("Contains ServiceNow sys_id"),(s.user_name||s.userName)&&a.push("User principal claim detected"),(s.instance||s.instance_url)&&a.push("Instance metadata present")):r==="salesforce"&&(s.organization_id&&a.push("Contains Salesforce organization_id"),s.user_id&&a.push("User ID claim detected"),s.sfdc_instance_url&&a.push("Salesforce instance URL present"),s.scope&&a.push("OAuth scope defined")),a},Xs=(s,r)=>{if(!s)return new Set;const a=new Set;return r==="servicenow"?(s.sys_id&&a.add("sys_id"),(s.user_name||s.userName)&&a.add("user_name"),(s.instance||s.instance_url)&&(a.add("instance"),a.add("instance_url"))):r==="salesforce"&&(s.organization_id&&a.add("organization_id"),s.user_id&&a.add("user_id"),s.sfdc_instance_url&&a.add("sfdc_instance_url"),s.scope&&a.add("scope")),a},Te=s=>{if(!s)return"";const r=s.replace(/-/g,"+").replace(/_/g,"/").padEnd(s.length+(s.length%4?4-s.length%4:0),"="),a=atob(r);try{return decodeURIComponent(a.split("").map(o=>`%${`00${o.charCodeAt(0).toString(16)}`.slice(-2)}`).join(""))}catch{return a}},Ne=s=>{if(!s)return"";try{return JSON.stringify(JSON.parse(s),null,2)}catch{return s}},Zs=s=>{if(!s?.exp)return{tone:"warning",icon:V,message:"Missing exp claim"};const r=Date.now(),a=s.exp*1e3;if(a<r){const n=Math.floor((r-a)/864e5);return{tone:"error",icon:V,message:n>0?`Expired ${n} day(s) ago`:"Recently expired"}}const o=(a-r)/(1e3*60*60);return o<=1?{tone:"warning",icon:V,message:`Expiring in ${Math.round(o*60)} minutes`}:{tone:"success",icon:le,message:`Valid for ${Math.round(o)} hour(s)`}},et={success:{text:"text-success",bg:"bg-success/10",border:"border-success/20"},warning:{text:"text-warning",bg:"bg-warning/10",border:"border-warning/20"},error:{text:"text-error",bg:"bg-error/10",border:"border-error/20"}},Ze=["sub","name","email","user_name","sys_id","iat","exp"],st=(s=32)=>{const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";let a="";for(let o=0;o<s;o++)a+=r.charAt(Math.floor(Math.random()*r.length));return a},tt=async(s="HS256")=>{const r=["John","Jane","Alice","Bob","Charlie","David","Emma","Frank","Grace","Henry"],a=["Smith","Johnson","Williams","Brown","Jones","Garcia","Miller","Davis","Rodriguez","Martinez"],o=["example.com","test.com","demo.org","sample.net","dev.io"],n=r[Math.floor(Math.random()*r.length)],x=a[Math.floor(Math.random()*a.length)],l=o[Math.floor(Math.random()*o.length)],c=`${n.toLowerCase()}.${x.toLowerCase()}@${l}`,h=`${n.toLowerCase()}.${x.toLowerCase()}`,p=Array.from({length:32},()=>Math.floor(Math.random()*16).toString(16)).join(""),m=Math.floor(Date.now()/1e3),f=m-Math.floor(Math.random()*3600),j=m+Math.floor(Math.random()*86400)+3600,v={alg:s,typ:"JWT",...s.startsWith("RS")||s.startsWith("ES")?{kid:Math.floor(Math.random()*1e6).toString()}:{}},S={sub:c,name:`${n} ${x}`,email:c,user_name:h,sys_id:p,iat:f,exp:j,instance:`instance${Math.floor(Math.random()*100)}.service-now.com`,instance_url:`https://instance${Math.floor(Math.random()*100)}.service-now.com`},I=A=>{const K=encodeURIComponent(A).replace(/%([0-9A-F]{2})/g,(C,E)=>String.fromCharCode(parseInt(E,16)));return btoa(K).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")},M=I(JSON.stringify(v)),U=I(JSON.stringify(S)),L=`${M}.${U}`;let D,_="";if(s.startsWith("HS")){const A=st();_=A;const K=new TextEncoder,C=K.encode(A),E=s==="HS256"?"SHA-256":s==="HS384"?"SHA-384":"SHA-512",O=await crypto.subtle.importKey("raw",C,{name:"HMAC",hash:E},!1,["sign"]),u=await crypto.subtle.sign("HMAC",O,K.encode(L));D=btoa(String.fromCharCode(...new Uint8Array(u))).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}else if(s.startsWith("RS")){const A=s==="RS256"?"SHA-256":s==="RS384"?"SHA-384":"SHA-512",K=await crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:2048,publicExponent:new Uint8Array([1,0,1]),hash:A},!0,["sign","verify"]),C=new TextEncoder,E=await crypto.subtle.sign("RSASSA-PKCS1-v1_5",K.privateKey,C.encode(L));D=btoa(String.fromCharCode(...new Uint8Array(E))).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"");const O=await crypto.subtle.exportKey("spki",K.publicKey);_=`-----BEGIN PUBLIC KEY-----
${btoa(String.fromCharCode(...new Uint8Array(O))).match(/.{1,64}/g).join(`
`)}
-----END PUBLIC KEY-----`}else if(s.startsWith("ES")){const A=s==="ES256"?"SHA-256":s==="ES384"?"SHA-384":"SHA-512",K=s==="ES256"?"P-256":s==="ES384"?"P-384":"P-521",C=await crypto.subtle.generateKey({name:"ECDSA",namedCurve:K},!0,["sign","verify"]),E=new TextEncoder,O=await crypto.subtle.sign({name:"ECDSA",hash:A},C.privateKey,E.encode(L));D=btoa(String.fromCharCode(...new Uint8Array(O))).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"");const u=await crypto.subtle.exportKey("spki",C.publicKey);_=`-----BEGIN PUBLIC KEY-----
${btoa(String.fromCharCode(...new Uint8Array(u))).match(/.{1,64}/g).join(`
`)}
-----END PUBLIC KEY-----`}return{token:`${L}.${D}`,key:_,algorithm:s}};ss,chrome.runtime?.getURL&&chrome.runtime.getURL("jwt.html"),ts,chrome.runtime?.getURL&&chrome.runtime.getURL("saml.html"),Ss,chrome.runtime?.getURL&&chrome.runtime.getURL("rest.html"),ks,chrome.runtime?.getURL&&chrome.runtime.getURL("har-analyzer.html"),vs,chrome.runtime?.getURL&&chrome.runtime.getURL("json-utility.html");const Z=async s=>{if(s)try{await navigator.clipboard.writeText(s)}catch(r){console.error("Copy failed",r)}},rt=async(s,r,a,o)=>{try{const n=s.split(".");if(n.length!==3)return{verified:!1,error:"Invalid JWT format"};const l=JSON.parse(Te(n[0])).alg||a||"RS256";if(l.startsWith("HS")){const I=new TextEncoder,M=`${n[0]}.${n[1]}`,U=I.encode(r),L=l==="HS256"?"SHA-256":l==="HS384"?"SHA-384":"SHA-512",D=await crypto.subtle.importKey("raw",U,{name:"HMAC",hash:L},!1,["sign"]),_=await crypto.subtle.sign("HMAC",D,I.encode(M)),A=btoa(String.fromCharCode(...new Uint8Array(_))).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")===n[2];return{verified:A,error:A?null:"Signature verification failed"}}let c;if(o==="JWK"){const I=typeof r=="string"?JSON.parse(r):r;c=await crypto.subtle.importKey("jwk",I,{name:l.startsWith("RS")?"RSASSA-PKCS1-v1_5":"ECDSA",hash:l==="RS256"||l==="ES256"?"SHA-256":l==="RS384"||l==="ES384"?"SHA-384":"SHA-512"},!1,["verify"])}else{const I=r.replace(/-----BEGIN PUBLIC KEY-----/g,"").replace(/-----END PUBLIC KEY-----/g,"").replace(/-----BEGIN RSA PUBLIC KEY-----/g,"").replace(/-----END RSA PUBLIC KEY-----/g,"").replace(/\s+/g,""),M=Uint8Array.from(atob(I),U=>U.charCodeAt(0));if(l.startsWith("RS"))c=await crypto.subtle.importKey("spki",M.buffer,{name:"RSASSA-PKCS1-v1_5",hash:l==="RS256"?"SHA-256":l==="RS384"?"SHA-384":"SHA-512"},!1,["verify"]);else if(l.startsWith("ES"))c=await crypto.subtle.importKey("spki",M.buffer,{name:"ECDSA",namedCurve:l==="ES256"?"P-256":l==="ES384"?"P-384":"P-521"},!1,["verify"]);else return{verified:!1,error:`Algorithm ${l} not supported for verification`}}const h=`${n[0]}.${n[1]}`,p=n[2].replace(/-/g,"+").replace(/_/g,"/"),m=p.length%4?4-p.length%4:0,f=p+"=".repeat(m),j=Uint8Array.from(atob(f),I=>I.charCodeAt(0)),v=l.startsWith("RS")?"RSASSA-PKCS1-v1_5":{name:"ECDSA",hash:l==="ES256"?"SHA-256":l==="ES384"?"SHA-384":"SHA-512"},S=await crypto.subtle.verify(v,c,j,new TextEncoder().encode(h));return{verified:S,error:S?null:"Signature verification failed"}}catch(n){return{verified:!1,error:n.message||"Verification error"}}},at=s=>i.useMemo(()=>{if(!s.trim())return{error:"",header:null,payload:null,signature:"",headerRaw:"",payloadRaw:""};const r=s.split(".");if(r.length!==3)return{error:"A JWT must contain three dot-separated segments.",header:null,payload:null,signature:"",headerRaw:"",payloadRaw:""};try{const a=Te(r[0]),o=Te(r[1]),n=r[2],x=JSON.parse(a),l=Hs(s);return{error:"",header:x,payload:l,signature:n,headerRaw:a,payloadRaw:o}}catch(a){return{error:a.message||"Unable to decode token.",header:null,payload:null,signature:r[2]||"",headerRaw:"",payloadRaw:""}}},[s]),es=({title:s,content:r,description:a,onCopy:o,viewMode:n,onViewModeChange:x,theme:l,statusColor:c,isHeader:h=!1,payload:p,targetClaims:m,getClaimInfo:f,companyClaimSet:j,currentCompany:v,currentTime:S,calculateTTL:I,editable:M,onContentChange:U,placeholder:L})=>{const[D,_]=i.useState(!1),ee=r?r.split(`
`):["—"],A=n==="table"&&s?.startsWith("Payload:")?(()=>{try{return JSON.parse(r)}catch{return null}})():null;c?.border,c?.text;const K=c?c.text.includes("error")?"#ef4444":c.text.includes("warning")?"#f59e0b":l.primary:l.primary,C=async()=>{await o(r),_(!0),setTimeout(()=>_(!1),2e3)},E=s?.startsWith("Payload:")||s?.startsWith("Signature:")||h?"auto":"280px",O=n==="table"&&A&&s?.startsWith("Payload:");return e.jsxs("div",{className:"border border-gray-200 rounded-xl bg-white flex flex-col overflow-hidden shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between bg-gray-50 px-4 sm:px-5 lg:px-6 py-2.5 sm:py-3 lg:py-3.5 flex-shrink-0 border-b border-gray-200",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 flex-1 min-w-0",children:[e.jsx("div",{className:"h-1.5 sm:h-2 w-1.5 sm:w-2 rounded-full flex-shrink-0",style:{backgroundColor:K}}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("h3",{className:"text-xs sm:text-sm font-semibold text-gray-900 uppercase tracking-wide truncate",children:s}),a&&e.jsx("p",{className:"hidden sm:block text-xs text-gray-600 leading-tight mt-1",children:a})]})]}),e.jsxs("div",{className:"flex items-center gap-1 sm:gap-1.5 flex-shrink-0",children:[s?.startsWith("Payload:")&&e.jsxs("div",{className:"flex items-center gap-0.5 bg-white p-0.5 border border-gray-300 rounded-md",children:[e.jsx("button",{onClick:()=>x("json"),className:b("px-1.5 sm:px-2 py-0.5 sm:py-1 text-[10px] sm:text-xs font-medium transition-colors rounded",n==="json"?"bg-sky-500 text-white":"text-gray-700 hover:bg-gray-50"),tabIndex:0,children:"JSON"}),e.jsxs("button",{onClick:()=>x("table"),className:b("px-1.5 sm:px-2 py-0.5 sm:py-1 text-[10px] sm:text-xs font-medium transition-colors rounded inline-flex items-center gap-1",n==="table"?"bg-sky-500 text-white":"text-gray-700 hover:bg-gray-50"),tabIndex:0,children:[e.jsx(rs,{className:"h-2.5 sm:h-3 w-2.5 sm:w-3"}),e.jsx("span",{className:"hidden sm:inline",children:"Table"})]})]}),e.jsxs("button",{onClick:C,onKeyDown:u=>{(u.key==="Enter"||u.key===" ")&&(u.preventDefault(),C())},onMouseDown:u=>{u.currentTarget.style.transform="scale(0.95)",u.currentTarget.style.backgroundColor="#e2e8f0"},onMouseUp:u=>{u.currentTarget.style.transform="",u.currentTarget.style.backgroundColor=""},onTouchStart:u=>{u.currentTarget.style.transform="scale(0.95)",u.currentTarget.style.backgroundColor="#e2e8f0"},onTouchEnd:u=>{setTimeout(()=>{u.currentTarget.style.transform="",u.currentTarget.style.backgroundColor=""},150)},className:b("inline-flex items-center gap-1.5 px-3 py-1.5 text-xs font-semibold transition-all focus:outline-none border-[0.5px] border-gray-300 rounded-lg focus:outline-none shadow-sm",D?"bg-green-50 border-green-400 text-green-700":"text-gray-700 hover:bg-gray-50 hover:border-gray-400 bg-white border-gray-300 hover:shadow"),tabIndex:0,children:[D?e.jsx(le,{className:"h-3.5 w-3.5"}):e.jsx(ge,{className:"h-3.5 w-3.5"}),e.jsx("span",{className:"hidden sm:inline",children:D?"Copied!":"Copy"})]})]})]}),e.jsx("div",{className:b("bg-white",h||O?"overflow-visible":"overflow-auto"),style:h||O||s?.startsWith("Signature:")?{}:{height:E,maxHeight:E},children:n==="table"&&A?e.jsx("div",{className:"p-3 sm:p-4 lg:p-5 w-full overflow-x-auto",children:e.jsxs("table",{className:"w-full text-xs sm:text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b-2 border-gray-200",children:[e.jsx("th",{className:"px-3 sm:px-4 lg:px-5 py-2 sm:py-3 text-left font-semibold text-gray-900",children:"Claim"}),e.jsx("th",{className:"px-3 sm:px-4 lg:px-5 py-2 sm:py-3 text-left font-semibold text-gray-900",children:"Value"})]})}),e.jsx("tbody",{children:Object.entries(A).map(([u,T])=>e.jsxs("tr",{className:"border-b border-gray-100 hover:bg-gray-50 transition-colors",children:[e.jsx("td",{className:"px-3 sm:px-4 lg:px-5 py-2 sm:py-3 font-mono text-gray-700 text-xs sm:text-sm",children:u}),e.jsx("td",{className:"px-3 sm:px-4 lg:px-5 py-2 sm:py-3 text-gray-900 text-xs sm:text-sm break-words",children:typeof T=="object"?JSON.stringify(T):String(T)})]},u))})]})}):s?.startsWith("Signature:")||M&&s?.startsWith("Verify Signature:")?M&&s?.startsWith("Verify Signature:")?e.jsx("div",{className:"p-3 sm:p-4",children:e.jsx("textarea",{value:r||"",onChange:u=>U?.(u.target.value),placeholder:L||"",className:"w-full h-full min-h-[180px] resize-none border-0 bg-transparent px-0 py-0 font-mono text-xs sm:text-sm leading-relaxed text-gray-800 placeholder:text-gray-400 focus:outline-none focus:bg-sky-50/30",tabIndex:0})}):e.jsx("div",{className:"p-3 sm:p-4",children:e.jsx("pre",{className:"text-xs sm:text-sm leading-relaxed whitespace-pre-wrap break-words overflow-wrap-anywhere",children:e.jsx("code",{className:"font-mono text-gray-800",children:r||"—"})})}):e.jsxs("div",{className:"flex bg-white",style:{flex:"1 1 auto",minHeight:"100%"},children:[e.jsx("div",{className:"flex-shrink-0 bg-gray-50 border-r-2 border-gray-200 text-right pr-2 sm:pr-3 lg:pr-4 pl-2 sm:pl-3 lg:pl-4 py-3 sm:py-4 lg:py-5 flex flex-col",style:{width:"45px",fontFamily:"monospace",minHeight:"100%"},children:ee.map((u,T)=>e.jsx("div",{className:"text-gray-400 text-[10px] sm:text-xs leading-relaxed select-none flex-shrink-0",style:{minHeight:"18px"},children:T+1},T))}),e.jsx("div",{className:"flex-1 py-3 sm:py-4 lg:py-5 pl-3 sm:pl-4 lg:pl-6 pr-3 sm:pr-4 lg:pr-6 text-xs sm:text-sm leading-relaxed overflow-x-auto bg-white",children:e.jsx("div",{className:"font-mono text-gray-800",children:ee.map((u,T)=>{let z=null,$=!1;if(s?.startsWith("Key Claims:")&&m&&f&&p){const J=u.match(/^\s*"([^"]+)":\s*(.+)/);if(J&&m.includes(J[1])){const se=J[1];z=f(se),$=j?.has(se)||!1}}if(s?.startsWith("Key Claims:")&&z){const J=u.indexOf(":");if(J!==-1){const se=u.substring(0,J+1),q=u.substring(J+1).trim();return e.jsxs("div",{className:"flex items-center gap-2",style:{minHeight:"22.4px"},children:[e.jsx("span",{className:"text-slate-900 whitespace-pre",children:se}),e.jsx("span",{className:"text-slate-900 whitespace-pre",children:q}),$&&e.jsx("span",{className:"inline-flex items-center rounded-full px-1.5 py-0.5 text-xs font-semibold uppercase text-white flex-shrink-0",style:{backgroundColor:l.badgeBg},children:v==="servicenow"?"SN":"SF"}),e.jsx(Me,{content:e.jsxs("div",{className:"max-w-sm",children:[e.jsx("p",{className:"font-semibold mb-1.5 text-sm text-white",children:z.name}),e.jsx("p",{className:"text-xs mb-2.5 text-slate-300 leading-relaxed",children:z.description})]}),position:"left",children:e.jsx(pe,{className:"h-3.5 w-3.5 text-sky-500 cursor-help flex-shrink-0"})})]},T)}}return e.jsx("div",{className:"text-slate-900 whitespace-pre",style:{minHeight:"22.4px"},children:u||" "},T)})})})]})})]})},Me=({children:s,content:r,position:a="top"})=>{const[o,n]=i.useState(!1),[x,l]=i.useState({top:0,left:0}),c=i.useRef(null),h=i.useRef(null),p=()=>{if(h.current&&c.current){const m=h.current.getBoundingClientRect(),f=c.current.getBoundingClientRect();let j=0,v=0;switch(a){case"right":j=m.top+m.height/2-f.height/2,v=m.right+8;break;case"left":j=m.top+m.height/2-f.height/2,v=m.left-f.width-8;break;case"bottom":j=m.bottom+8,v=m.left+m.width/2-f.width/2;break;default:j=m.top-f.height-8,v=m.left+m.width/2-f.width/2}const S=8;v<S&&(v=S),v+f.width>window.innerWidth-S&&(v=window.innerWidth-f.width-S),j<S&&(j=S),j+f.height>window.innerHeight-S&&(j=window.innerHeight-f.height-S),l({top:j,left:v})}};return i.useEffect(()=>{if(o){requestAnimationFrame(()=>{p()});const m=()=>{requestAnimationFrame(()=>{p()})};return window.addEventListener("resize",m),window.addEventListener("scroll",m,!0),()=>{window.removeEventListener("resize",m),window.removeEventListener("scroll",m,!0)}}},[o,a]),e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"relative inline-block",children:e.jsx("div",{ref:h,onMouseEnter:()=>n(!0),onMouseLeave:()=>n(!1),onFocus:()=>n(!0),onBlur:()=>n(!1),className:"cursor-help",tabIndex:0,children:s})}),o&&e.jsx(e.Fragment,{children:e.jsx("div",{ref:c,className:"fixed z-[9999] w-64 max-w-[calc(100vw-2rem)] rounded-lg bg-gray-900 border border-gray-700 p-3 text-xs text-white shadow-2xl",style:{top:`${x.top}px`,left:`${x.left}px`,pointerEvents:"auto"},children:r})})]})},nt=()=>{const[s,r]=i.useState(""),[a,o]=i.useState(""),[n,x]=i.useState(""),[l,c]=i.useState("PEM"),[h,p]=i.useState(!1),[m,f]=i.useState(null),[j,v]=i.useState(!1),[S,I]=i.useState(!1),[M,U]=i.useState("json"),[L,D]=i.useState("servicenow"),[_,ee]=i.useState(!0),[A,K]=i.useState(""),[C,E]=i.useState(!1),[O,u]=i.useState(!1),[T,z]=i.useState(!1),[$,J]=i.useState(null),[se]=i.useState(!0),[q,Re]=i.useState(!1),[ce,De]=i.useState(!1),[de,He]=i.useState(!1),[ye,Ke]=i.useState(!1),[te,ns]=i.useState(""),[F,Se]=i.useState(null),[_e,ke]=i.useState(!1),[Je,We]=i.useState(null),[me,Ue]=i.useState(""),[Ce]=i.useState(!0),[re,Le]=i.useState([]),[be,os]=i.useState(null),[is]=i.useState(!0),[we,ls]=i.useState(""),[k,cs]=i.useState(null),[Oe,ds]=i.useState("HS256"),[xe,ve]=i.useState(!1),Ie=i.useRef(null),Pe=i.useRef(null),Ee=i.useRef(null),$e=i.useRef(null);i.useRef(null);const{error:he,header:W,payload:g,signature:Y,headerRaw:Fe,payloadRaw:Be}=at(s),ae=Zs(g),ne=$||Date.now(),R=i.useMemo(()=>!W||!g?null:_s(W,g,Y,ne),[W,g,Y,ne]),Ae=i.useMemo(()=>R?Js(R.riskScore):null,[R]),ms=i.useMemo(()=>Ys(g),[g]),P=L||ms,Q=qs[P];i.useMemo(()=>Qs(g,P),[g,P]);const Ge=i.useMemo(()=>Xs(g,P),[g,P]),xs=ae.icon,X=Y&&Y.length>0,H=W?.alg?.startsWith("HS");i.useEffect(()=>{X&&!S&&I(!0)},[X]),i.useEffect(()=>{f(null)},[s]),i.useEffect(()=>{const t=$e.current;if(t){t.style.height="auto";const d=Math.min(t.scrollHeight,400);t.style.height=`${d}px`}},[s]),i.useEffect(()=>{const t=d=>{d.key==="Escape"&&C&&E(!1),d.key==="Escape"&&S&&I(!1)};return document.addEventListener("keydown",t),()=>document.removeEventListener("keydown",t)},[C,S]),i.useEffect(()=>{const t=d=>{Ie.current&&!Ie.current.contains(d.target)&&E(!1),Pe.current&&!Pe.current.contains(d.target)&&ve(!1),Ee.current&&!Ee.current.contains(d.target)&&p(!1)};return(C||xe||h)&&document.addEventListener("mousedown",t),()=>{document.removeEventListener("mousedown",t)}},[C,xe,h]);const hs=async()=>{if(!s)return;v(!0);const d=await rt(s,H?n:a,W?.alg,l);f(d),v(!1)},us=t=>{const d=t.target.files[0];if(!d)return;const N=new FileReader;N.onload=y=>{if(l==="JWK")try{o(JSON.stringify(JSON.parse(y.target.result),null,2))}catch{o(y.target.result)}else o(y.target.result)},N.readAsText(d)},Ve=async()=>{if(!te.trim())return;ke(!0),We(null);const t=Os(te);if(t){Se(t),ke(!1);return}const d=await Us(te);d.success?(Se(d.jwks),Ps(te,d.jwks),W?.kid&&d.keys.length>0&&Qe(d.jwks,W.kid)&&Ue(W.kid)):(We(d.error),Se(null)),ke(!1)};i.useEffect(()=>{if(F&&me&&!H){const t=Qe(F,me);t&&(c("JWK"),o(JSON.stringify(t,null,2)))}},[F,me,H]),i.useEffect(()=>{if(g&&Ce){const t=Object.keys(g).filter(d=>je(d));t.length>0&&re.length===0&&Le(t)}},[g,Ce]);const gs=t=>{Le(d=>d.includes(t)?d.filter(N=>N!==t):[...d,t])};i.useEffect(()=>{if(W&&g){const t=Bs(g,re),d=Gs(W,t,Y);os(d)}},[W,g,Y,re]);const ps=()=>{if(!s||!we)return;const t=Vs(s,we);cs(t)},ze=t=>({text:"text-error",border:"border-error/40"});i.useMemo(()=>he||g&&(ae.tone==="error"||m?.verified===!1)?"error":null,[he,g,ae,m]);const fs=i.useMemo(()=>{if(!g)return[];const t=[];return t.push({label:"Structure",status:"success",icon:le,message:"Valid"}),t.push({label:"Expiry",status:ae.tone,icon:xs,message:ae.message}),X?m?.verified?t.push({label:"Signature",status:"success",icon:le,message:"Verified"}):m?.verified===!1?t.push({label:"Signature",status:"error",icon:ie,message:"Invalid"}):t.push({label:"Signature",status:"warning",icon:V,message:"Not verified"}):t.push({label:"Signature",status:"warning",icon:V,message:"Missing"}),t},[g,ae,X,m]);return e.jsxs("div",{className:"flex h-screen bg-white overflow-hidden",children:[e.jsx(Cs,{currentPageId:"jwt",sidebarOpen:_,onSidebarToggle:ee}),e.jsx("div",{className:"flex-1 overflow-y-auto bg-gray-50",style:{width:"100%",minWidth:0},children:e.jsxs("div",{className:"mx-auto max-w-[1600px] w-full px-4 sm:px-6 lg:px-8 py-4 sm:py-6 lg:py-10",children:[e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsx("header",{className:"bg-white border border-gray-300 rounded-xl shadow-sm px-4 sm:px-6 lg:px-8 py-4 sm:py-6 mb-4 sm:mb-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-4",children:[e.jsxs("div",{className:"space-y-1 sm:space-y-2",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:"JWT Debugger"}),e.jsx("p",{className:"text-sm sm:text-base text-gray-600",children:"Decode, verify, and inspect JSON Web Tokens"})]}),e.jsxs("div",{className:"relative",ref:Ie,children:[e.jsxs("button",{className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-gray-700 hover:text-gray-900 transition-all border-[0.5px] border-gray-300 rounded-lg hover:border-gray-500 hover:bg-gray-50 focus:outline-none focus:outline-none",onClick:()=>E(!C),onKeyDown:t=>{(t.key==="Enter"||t.key===" ")&&(t.preventDefault(),E(!C))},tabIndex:0,"aria-label":"Select company","aria-expanded":C,children:[e.jsx("span",{className:"whitespace-nowrap",children:Q.name}),e.jsx(G,{className:b("h-4 w-4 text-gray-500 transition-transform duration-200",C&&"rotate-180")})]}),C&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>E(!1)}),e.jsxs("div",{className:"absolute right-0 top-full mt-2 w-40 bg-white border border-gray-200 rounded-lg shadow-xl z-50 overflow-hidden",children:[e.jsx("button",{onClick:()=>{D("servicenow"),E(!1)},className:b("w-full px-4 py-2.5 text-left text-sm transition-colors border-b border-gray-100 last:border-b-0 focus:outline-none",P==="servicenow"?"bg-sky-50 text-sky-700 font-semibold":"text-gray-700 hover:bg-gray-50"),tabIndex:0,children:"ServiceNow"}),e.jsx("button",{onClick:()=>{D("salesforce"),E(!1)},className:b("w-full px-4 py-2.5 text-left text-sm transition-colors border-b border-gray-100 last:border-b-0 focus:outline-none",P==="salesforce"?"bg-sky-50 text-sky-700 font-semibold":"text-gray-700 hover:bg-gray-50"),tabIndex:0,children:"Salesforce"})]})]})]})]})}),e.jsx("div",{className:"space-y-3 sm:space-y-4",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[e.jsx("label",{htmlFor:"token-input",className:"text-sm sm:text-base font-semibold text-gray-900",children:"JSON Web Token (JWT)"}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>ve(!xe),onKeyDown:t=>{(t.key==="Enter"||t.key===" ")&&(t.preventDefault(),ve(!xe))},className:"px-4 py-2 text-xs font-semibold text-gray-700 bg-white border-[0.5px] border-gray-300 rounded-lg hover:bg-gray-50 hover:border-gray-500 focus:outline-none focus:outline-none transition-all shadow-sm hover:shadow inline-flex items-center gap-2",tabIndex:0,children:[e.jsx(qe,{className:"h-3.5 w-3.5"}),"Generate example (",Oe,")",e.jsx(G,{className:"h-3 w-3"})]}),xe&&e.jsx("div",{className:"absolute right-0 top-full mt-2 w-40 border border-gray-200 rounded-lg bg-white shadow-lg z-50 overflow-y-auto max-h-64",children:["HS256","HS384","HS512","RS256","RS384","RS512","ES256","ES384","ES512"].map(t=>e.jsx("button",{onClick:async()=>{ds(t),ve(!1);const{token:d,key:N,algorithm:y}=await tt(t);r(d),y.startsWith("HS")?(x(N),o("")):(o(N),x(""),c("PEM")),S||I(!0)},className:b("w-full px-3 py-2 text-left text-sm transition-colors active:scale-[0.98] focus:outline-none",Oe===t?"bg-slate-100 font-medium text-slate-900":"text-slate-700 hover:bg-slate-50"),tabIndex:0,children:t},t))})]}),e.jsxs("button",{onClick:()=>Z(s),onKeyDown:t=>{(t.key==="Enter"||t.key===" ")&&(t.preventDefault(),Z(s))},className:"inline-flex items-center gap-2 px-4 py-2 text-xs font-semibold text-gray-700 bg-white border-[0.5px] border-gray-300 rounded-lg hover:bg-gray-50 hover:border-gray-500 focus:outline-none focus:outline-none transition-all shadow-sm hover:shadow",tabIndex:0,children:[e.jsx(ge,{className:"h-4 w-4"}),"Copy"]}),e.jsxs("button",{onClick:()=>r(""),onKeyDown:t=>{(t.key==="Enter"||t.key===" ")&&(t.preventDefault(),r(""))},className:"inline-flex items-center gap-1.5 px-4 py-2 text-xs font-semibold text-gray-700 bg-white border-[0.5px] border-gray-300 rounded-lg hover:bg-gray-50 hover:border-gray-500 focus:outline-none focus:outline-none transition-all shadow-sm hover:shadow",tabIndex:0,children:[e.jsx(ie,{className:"h-3.5 w-3.5"}),"Clear"]})]})]})}),e.jsxs("div",{className:"relative",children:[e.jsx("textarea",{ref:$e,id:"token-input",value:s,onChange:t=>{r(t.target.value),t.target.style.height="auto";const d=Math.min(t.target.scrollHeight,400);t.target.style.height=`${d}px`},placeholder:"Paste a JWT token here...",className:"min-h-[100px] sm:min-h-[120px] max-h-[300px] sm:max-h-[400px] w-full resize-none border-[0.5px] border-gray-300 rounded-xl bg-white px-3 sm:px-5 py-3 sm:py-4 font-mono text-xs sm:text-sm leading-relaxed text-gray-900 placeholder:text-gray-400 focus:outline-none focus:border-sky-400/60 overflow-y-auto shadow-sm",style:{color:"transparent",caretColor:"#111827",height:"auto"},tabIndex:0}),s&&e.jsx("div",{className:"absolute inset-0 pointer-events-none px-3 sm:px-5 py-3 sm:py-4 font-mono text-xs sm:text-sm leading-relaxed overflow-hidden rounded-xl",style:{maxHeight:"400px",overflowY:"auto"},children:e.jsx("pre",{className:"whitespace-pre-wrap break-all",children:(()=>{const t=s.split(".");return t.length!==3?e.jsx("span",{className:"text-gray-900",children:s}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-sky-600",children:t[0]}),e.jsx("span",{className:"text-gray-400",children:"."}),e.jsx("span",{className:"text-purple-600",children:t[1]}),e.jsx("span",{className:"text-gray-400",children:"."}),e.jsx("span",{className:"text-green-600",children:t[2]})]})})()})})]}),he&&e.jsxs("div",{className:"mt-4 flex items-center gap-3 text-sm text-red-700 bg-red-50 border border-red-200 px-5 py-3 rounded-lg",children:[e.jsx(V,{className:"h-5 w-5 flex-shrink-0"}),e.jsx("span",{className:"font-medium",children:he})]}),!he&&g&&e.jsxs("div",{className:"mt-3 sm:mt-4 flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-4 lg:gap-6 text-xs sm:text-sm flex-wrap bg-green-50 border border-green-200 px-3 sm:px-5 py-2.5 sm:py-3 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(le,{className:"h-4 w-4 text-green-600 flex-shrink-0"}),e.jsx("span",{className:"font-medium text-gray-900",children:"Valid JWT"})]}),fs.map((t,d)=>{const N=t.icon,y=et[t.status];return e.jsxs(js.Fragment,{children:[d>0&&e.jsx("span",{className:"hidden sm:inline text-gray-300 mx-2",children:"·"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(N,{className:b("h-3.5 sm:h-4 w-3.5 sm:w-4 flex-shrink-0",y.text)}),e.jsxs("span",{className:b("font-medium",y.text),children:[e.jsxs("span",{className:"hidden sm:inline",children:[t.label,": "]}),e.jsx("span",{className:"text-gray-600",children:t.message})]})]})]},t.label)})]})]}),g&&e.jsxs(e.Fragment,{children:[R&&R.issues.length>0&&e.jsxs("div",{className:"mb-4 sm:mb-6 bg-white border border-gray-200 rounded-xl shadow-sm overflow-hidden",children:[e.jsxs("div",{className:"flex items-start sm:items-center justify-between bg-gray-50 px-4 sm:px-6 py-3 sm:py-4 border-b border-gray-200 cursor-pointer hover:bg-gray-100 transition-colors",onClick:()=>z(!T),children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-3 flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[e.jsx(ss,{className:"h-4 sm:h-5 w-4 sm:w-5 text-slate-600 flex-shrink-0"}),e.jsx("span",{className:"text-sm sm:text-base font-semibold text-slate-900",children:"Security Analysis"}),e.jsxs("span",{className:b("px-2 py-0.5 rounded text-xs font-semibold flex-shrink-0",Ae?.bg,Ae?.color),children:[R.issues.length," ",R.issues.length===1?"Issue":"Issues"]})]}),!T&&e.jsxs("span",{className:"text-xs text-slate-500",children:["• ",R.issues.filter(t=>t.severity===w.CRITICAL).length>0&&`${R.issues.filter(t=>t.severity===w.CRITICAL).length} Critical`,R.issues.filter(t=>t.severity===w.HIGH).length>0&&`, ${R.issues.filter(t=>t.severity===w.HIGH).length} High`,R.issues.filter(t=>t.severity===w.MEDIUM).length>0&&`, ${R.issues.filter(t=>t.severity===w.MEDIUM).length} Medium`,"• ",Ae?.level," Risk (",R.riskScore,"/100)"]})]}),e.jsx("button",{onClick:t=>{t.stopPropagation(),z(!T)},className:"p-1 text-gray-500 hover:text-gray-700 transition-colors focus:outline-none",tabIndex:0,children:T?e.jsx(ue,{className:"h-4 w-4"}):e.jsx(G,{className:"h-4 w-4"})})]}),T&&e.jsx("div",{className:"p-6 space-y-4 bg-white",children:R.issues.map((t,d)=>{const N={[w.CRITICAL]:{text:"text-red-700",bg:"bg-red-50",border:"border-red-200",icon:ie},[w.HIGH]:{text:"text-orange-700",bg:"bg-orange-50",border:"border-orange-200",icon:V},[w.MEDIUM]:{text:"text-yellow-700",bg:"bg-yellow-50",border:"border-yellow-200",icon:V},[w.LOW]:{text:"text-sky-700",bg:"bg-sky-50",border:"border-sky-200",icon:pe},[w.INFO]:{text:"text-slate-700",bg:"bg-slate-50",border:"border-slate-200",icon:pe}},y=N[t.severity]||N[w.INFO],oe=y.icon;return e.jsx("div",{className:b("rounded p-3",y.bg),children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(oe,{className:b("h-4 w-4 mt-0.5 flex-shrink-0",y.text)}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:b("font-medium text-sm",y.text),children:t.title}),e.jsx("span",{className:b("text-xs font-medium px-2 py-0.5 rounded uppercase",y.bg,y.text,y.border,"border"),children:t.severity})]}),e.jsx("p",{className:"text-sm text-gray-700 mb-2",children:t.message}),t.recommendation&&e.jsxs("div",{className:"mt-2 pt-2 border-t border-gray-200",children:[e.jsx("p",{className:"text-xs font-medium text-gray-600 mb-1",children:"Recommendation:"}),e.jsx("p",{className:"text-xs text-gray-700",children:t.recommendation})]})]})]})},d)})})]}),e.jsxs("div",{className:b("grid gap-4 sm:gap-6 mb-4 sm:mb-6 items-stretch",X?"grid-cols-1 lg:grid-cols-2":"grid-cols-1"),children:[e.jsx("div",{className:b("flex flex-col h-full",!X&&"lg:col-span-1"),children:e.jsxs("div",{className:"border border-gray-200 rounded-xl bg-white shadow-sm overflow-hidden flex flex-col flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between bg-gray-50 px-4 sm:px-6 py-3 sm:py-4 border-b border-gray-200",children:[e.jsx("h3",{className:"text-sm sm:text-base font-semibold text-gray-900",children:"JWT Token Structure"}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("div",{className:"flex items-center gap-0.5 bg-white p-0.5 border border-gray-300 rounded-md",children:[e.jsx("button",{onClick:()=>U("json"),className:b("px-2 py-1 text-xs font-medium transition-colors rounded",M==="json"?"bg-sky-500 text-white":"text-gray-700 hover:bg-gray-50"),tabIndex:0,children:"JSON"}),e.jsxs("button",{onClick:()=>U("table"),className:b("px-2 py-1 text-xs font-medium transition-colors rounded inline-flex items-center gap-1",M==="table"?"bg-sky-500 text-white":"text-gray-700 hover:bg-gray-50"),tabIndex:0,children:[e.jsx(rs,{className:"h-3 w-3"}),e.jsx("span",{className:"hidden sm:inline",children:"Table"})]})]})})]}),e.jsxs("div",{className:"flex-1 py-3 sm:py-4 lg:py-5 px-4 sm:px-5 lg:px-6 text-xs sm:text-sm leading-relaxed bg-white space-y-4 overflow-y-auto min-h-0",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-2 w-2 rounded-full",style:{backgroundColor:Q.primary}}),e.jsx("h4",{className:"text-xs sm:text-sm font-semibold text-gray-900 uppercase tracking-wide",children:"Header"})]}),e.jsxs("button",{onClick:async()=>{await Z(Ne(Fe))},className:"inline-flex items-center gap-1.5 px-2 py-1 text-xs font-semibold transition-all focus:outline-none border-[0.5px] border-gray-300 rounded-lg bg-white text-gray-700 hover:bg-gray-50 hover:border-gray-500 focus:outline-none shadow-sm",tabIndex:0,children:[e.jsx(ge,{className:"h-3 w-3"}),e.jsx("span",{className:"hidden sm:inline",children:"Copy"})]})]}),e.jsx("div",{className:"font-mono text-gray-800 whitespace-pre-wrap break-words",children:Ne(Fe)})]}),e.jsx("div",{className:"border-t border-gray-200 my-4"}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-2 w-2 rounded-full",style:{backgroundColor:Q.primary}}),e.jsx("h4",{className:"text-xs sm:text-sm font-semibold text-gray-900 uppercase tracking-wide",children:"Payload"})]}),e.jsxs("button",{onClick:async()=>{await Z(Ne(Be))},className:"inline-flex items-center gap-1.5 px-2 py-1 text-xs font-semibold transition-all focus:outline-none border-[0.5px] border-gray-300 rounded-lg bg-white text-gray-700 hover:bg-gray-50 hover:border-gray-500 focus:outline-none shadow-sm",tabIndex:0,children:[e.jsx(ge,{className:"h-3 w-3"}),e.jsx("span",{className:"hidden sm:inline",children:"Copy"})]})]}),M==="table"&&g?e.jsx("div",{className:"w-full overflow-x-auto",children:e.jsxs("table",{className:"w-full text-xs sm:text-sm border-collapse",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b-2 border-gray-200",children:[e.jsx("th",{className:"px-3 sm:px-4 py-2 text-left font-semibold text-gray-900",children:"Claim"}),e.jsx("th",{className:"px-3 sm:px-4 py-2 text-left font-semibold text-gray-900",children:"Value"})]})}),e.jsx("tbody",{children:Object.entries(g).map(([t,d])=>{const N=Ze.includes(t)?Ye(t):null,y=Ge?.has(t)||!1,B=t==="iat"||t==="exp"||t==="nbf"?Ws(d,ne):typeof d=="object"?JSON.stringify(d,null,2):String(d);return e.jsxs("tr",{className:"border-b border-gray-100 hover:bg-gray-50 transition-colors",children:[e.jsx("td",{className:"px-3 sm:px-4 py-2 font-mono text-gray-700 text-xs sm:text-sm",children:e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("span",{children:t}),y&&e.jsx("span",{className:"inline-flex items-center rounded-full px-1.5 py-0.5 text-[10px] font-semibold uppercase text-white flex-shrink-0",style:{backgroundColor:Q.badgeBg},children:P==="servicenow"?"SN":"SF"}),N&&e.jsx(Me,{content:e.jsxs("div",{className:"max-w-sm",children:[e.jsx("p",{className:"font-semibold mb-1.5 text-sm text-white",children:N.name}),e.jsx("p",{className:"text-xs text-gray-300 leading-relaxed mb-2",children:N.description}),N.example&&e.jsxs("div",{className:"mt-2 pt-2 border-t border-gray-600",children:[e.jsx("p",{className:"text-xs text-gray-400 mb-1",children:"Example:"}),e.jsx("code",{className:"text-xs text-gray-300 font-mono",children:N.example})]})]}),position:"right",children:e.jsx(pe,{className:"h-3.5 w-3.5 text-gray-500 hover:text-sky-600 cursor-help flex-shrink-0 transition-colors"})})]})}),e.jsx("td",{className:"px-3 sm:px-4 py-2 text-gray-900 text-xs sm:text-sm break-words",children:B})]},t)})})]})}):e.jsx("div",{className:"font-mono text-gray-800 whitespace-pre-wrap break-words",children:Ne(Be).split(`
`).map((t,d)=>{const N=t.match(/^\s*"([^"]+)":\s*(.+)/);let y=null,oe=!1;if(N&&Ze.includes(N[1])){const B=N[1];y=Ye(B),oe=Ge?.has(B)||!1}if(y||oe){const B=t.indexOf(":");if(B!==-1){const ys=t.substring(0,B+1),bs=t.substring(B+1).trim();return e.jsxs("div",{className:"flex items-center gap-2",style:{minHeight:"18px"},children:[e.jsx("span",{className:"text-gray-900 whitespace-pre",children:ys}),e.jsx("span",{className:"text-gray-900 whitespace-pre",children:bs}),oe&&e.jsx("span",{className:"inline-flex items-center rounded-full px-1.5 py-0.5 text-[10px] font-semibold uppercase text-white flex-shrink-0",style:{backgroundColor:Q.badgeBg},children:P==="servicenow"?"SN":"SF"}),y&&e.jsx(Me,{content:e.jsxs("div",{className:"max-w-sm",children:[e.jsx("p",{className:"font-semibold mb-1.5 text-sm text-white",children:y.name}),e.jsx("p",{className:"text-xs text-gray-300 leading-relaxed mb-2",children:y.description}),y.example&&e.jsxs("div",{className:"mt-2 pt-2 border-t border-gray-600",children:[e.jsx("p",{className:"text-xs text-gray-400 mb-1",children:"Example:"}),e.jsx("code",{className:"text-xs text-gray-300 font-mono",children:y.example})]})]}),position:"right",children:e.jsx(pe,{className:"h-3.5 w-3.5 text-gray-500 hover:text-sky-600 cursor-help flex-shrink-0 transition-colors"})})]},d)}}return e.jsx("div",{style:{minHeight:"18px"},children:t},d)})})]})]})]})}),X&&e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(es,{title:"Signature: Cryptographic Signature",content:Y,description:"",onCopy:Z,viewMode:"json",theme:Q,statusColor:m?.verified===!1?ze():null,isHeader:!0})}),e.jsxs("div",{className:"mt-4 sm:mt-6 flex flex-col flex-1 min-h-0 border border-gray-200 rounded-xl bg-white shadow-sm overflow-hidden",children:[e.jsx("div",{className:"flex-1 min-h-0 [&>div]:border-0 [&>div]:rounded-none [&>div]:shadow-none",children:e.jsx(es,{title:`Verify Signature: ${H?"Secret Key":"Public Key"}`,content:H?n:a||"",description:"",onCopy:Z,viewMode:"json",theme:Q,statusColor:m?.verified===!1?ze():(m?.verified===!0,null),isHeader:!0,editable:!0,onContentChange:t=>{H?x(t):o(t),f(null)},placeholder:H?"Enter the secret used to sign the JWT":l==="PEM"?`-----BEGIN PUBLIC KEY-----
MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8A...
-----END PUBLIC KEY-----`:`{
  "kty": "RSA",
  "n": "...",
  "e": "AQAB"
}`})}),e.jsxs("div",{className:"flex items-center justify-between bg-gray-50 border-t border-gray-200 px-3 sm:px-4 py-2 sm:py-2.5",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 flex-wrap",children:[e.jsxs("label",{className:"text-xs sm:text-sm font-medium text-gray-700",children:[H?"Secret":"Public Key"," Format"]}),!H&&e.jsxs("div",{className:"relative",ref:Ee,children:[e.jsxs("button",{type:"button",onClick:()=>p(!h),className:"inline-flex items-center gap-2 px-3 py-1.5 text-xs sm:text-sm font-medium text-gray-700 bg-white border-[0.5px] border-gray-300 rounded-lg hover:bg-gray-50 hover:border-gray-500 focus:outline-none transition-all shadow-sm",tabIndex:0,children:[e.jsx("span",{children:l}),e.jsx(G,{className:b("h-3.5 w-3.5 text-gray-500 transition-transform duration-200",h&&"rotate-180")})]}),h&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-[49]",onClick:()=>p(!1)}),e.jsxs("div",{className:"absolute left-0 top-full mt-1 w-32 bg-white border border-gray-200 rounded-lg shadow-xl z-[100] overflow-hidden",children:[e.jsx("button",{onClick:()=>{c("PEM"),o(""),f(null),p(!1)},className:b("w-full px-3 py-2 text-left text-xs sm:text-sm transition-colors focus:outline-none border-b border-gray-100 last:border-b-0",l==="PEM"?"bg-sky-50 text-sky-600 font-medium":"text-gray-700 hover:bg-gray-50"),tabIndex:0,children:"PEM"}),e.jsx("button",{onClick:()=>{c("JWK"),o(""),f(null),p(!1)},className:b("w-full px-3 py-2 text-left text-xs sm:text-sm transition-colors focus:outline-none border-b border-gray-100 last:border-b-0",l==="JWK"?"bg-sky-50 text-sky-600 font-medium":"text-gray-700 hover:bg-gray-50"),tabIndex:0,children:"JWK"})]})]})]}),!H&&e.jsxs("label",{className:"inline-flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-gray-700 bg-white border-[0.5px] border-gray-300 rounded-lg hover:bg-gray-50 hover:border-gray-500 cursor-pointer transition-all focus-within:outline-none shadow-sm",children:[e.jsx(Is,{className:"h-3.5 w-3.5"}),"Upload",e.jsx("input",{type:"file",accept:".pem,.key,.crt,.pub,.json",onChange:us,className:"hidden",tabIndex:0})]}),(a||n)&&e.jsxs("button",{onClick:()=>{o(""),x(""),f(null)},className:"inline-flex items-center gap-1.5 px-3 py-1.5 text-xs font-semibold text-gray-700 bg-white border-[0.5px] border-gray-300 rounded-lg hover:bg-gray-50 hover:border-gray-500 focus:outline-none transition-all shadow-sm hover:shadow",tabIndex:0,children:[e.jsx(ie,{className:"h-3.5 w-3.5"}),"Clear"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[m&&e.jsxs("div",{className:b("flex items-center gap-1 sm:gap-1.5 px-1.5 sm:px-2 py-0.5 rounded text-xs font-medium flex-shrink-0",m.verified?"bg-green-100 text-green-700":"bg-red-100 text-red-700"),children:[m.verified?e.jsx(le,{className:"h-3 sm:h-3.5 w-3 sm:w-3.5"}):e.jsx(ie,{className:"h-3 sm:h-3.5 w-3 sm:w-3.5"}),e.jsx("span",{className:"hidden sm:inline",children:m.verified?"Verified":"Failed"})]}),e.jsx("button",{onClick:hs,disabled:!s||!H&&!a||H&&!n||j,className:"px-4 sm:px-5 py-2 text-xs sm:text-sm font-semibold text-white bg-sky-500 hover:bg-sky-600 rounded-lg transition-all disabled:bg-gray-300 disabled:cursor-not-allowed disabled:hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-gray-900 focus:ring-offset-2 shadow-sm hover:shadow",tabIndex:0,children:j?"Verifying...":"Verify Signature"})]})]}),m&&!m.verified&&e.jsx("div",{className:"mt-2 bg-red-50 border border-red-200 px-3 py-2 rounded-lg",children:e.jsxs("div",{className:"flex items-center gap-2 text-xs sm:text-sm text-red-700 font-medium",children:[e.jsx(ie,{className:"h-3.5 w-3.5 flex-shrink-0"}),e.jsx("span",{children:m.error||"Signature verification failed"})]})})]})]})]}),!H&&e.jsxs("div",{className:"mb-4 sm:mb-6 bg-white border border-gray-200 rounded-xl shadow-sm overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between bg-gray-50 px-4 sm:px-6 py-3 sm:py-4 border-b border-gray-200 cursor-pointer hover:bg-gray-100 transition-colors",onClick:()=>Ke(!ye),children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[e.jsx(ts,{className:"h-4 sm:h-5 w-4 sm:w-5 text-gray-600 flex-shrink-0"}),e.jsx("span",{className:"text-sm sm:text-base font-semibold text-gray-900",children:"JWKS (JSON Web Key Set)"})]}),e.jsx("button",{onClick:t=>{t.stopPropagation(),Ke(!ye)},className:"p-1 text-gray-500 hover:text-gray-700 transition-colors focus:outline-none",tabIndex:0,children:ye?e.jsx(ue,{className:"h-4 w-4"}):e.jsx(G,{className:"h-4 w-4"})})]}),ye&&e.jsxs("div",{className:"p-4 sm:px-6 sm:py-4 space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"url",value:te,onChange:t=>ns(t.target.value),placeholder:"https://example.com/.well-known/jwks.json",className:"flex-1 border-[0.5px] border-gray-300 rounded-lg bg-white px-4 py-2.5 text-sm text-gray-900 placeholder:text-gray-400 focus:outline-none focus:border-sky-400/60",onKeyDown:t=>{t.key==="Enter"&&Ve()}}),e.jsx("button",{onClick:Ve,disabled:_e||!te.trim(),className:"inline-flex items-center gap-2 px-5 py-2.5 text-sm font-semibold text-white bg-sky-500 hover:bg-sky-600 rounded-lg transition-all disabled:bg-gray-300 disabled:cursor-not-allowed disabled:hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-sky-500 focus:ring-offset-2 shadow-sm hover:shadow",children:_e?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"h-4 w-4 border-2 border-slate-400 border-t-transparent rounded-full animate-spin"}),"Loading..."]}):e.jsxs(e.Fragment,{children:[e.jsx(qe,{className:"h-4 w-4"}),"Fetch"]})})]}),Je&&e.jsx("div",{className:"bg-red-50 border border-red-200 px-4 py-3 rounded-lg text-sm text-red-700 font-medium",children:Je}),F&&F.keys&&F.keys.length>0&&e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Select Key:"}),e.jsxs("select",{value:me,onChange:t=>Ue(t.target.value),className:"w-full border-[0.5px] border-gray-300 rounded-lg bg-white px-4 py-2.5 text-sm text-gray-900 focus:outline-none focus:border-sky-400/60 cursor-pointer hover:bg-gray-50",children:[e.jsx("option",{value:"",children:"-- Select a key --"}),F.keys.map((t,d)=>e.jsxs("option",{value:t.kid||d,children:[t.kid||`Key ${d+1}`," (",t.alg||"N/A",")"]},d))]}),e.jsxs("p",{className:"text-xs text-gray-500",children:["Found ",F.keys.length," key(s). ",me?"Key selected for verification.":"Select a key to use for verification."]})]})]})]}),se&&e.jsxs("div",{className:"mb-4 sm:mb-6 bg-white border border-gray-200 rounded-xl shadow-sm overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between border-b border-gray-200 bg-gray-50 px-4 sm:px-6 py-3 sm:py-4 cursor-pointer hover:bg-gray-100 transition-colors",onClick:()=>Re(!q),children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsx(Es,{className:"h-4 w-4 text-gray-600"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:"Time Simulation"}),!q&&e.jsxs("span",{className:"text-xs text-gray-500 ml-2",children:[$?`Simulated: ${new Date($).toLocaleString()}`:"Real time",g?.exp&&` • Token ${g.exp*1e3<ne?"expired":"valid"}`]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("button",{onClick:t=>{t.stopPropagation(),Re(!q)},className:"p-1 text-gray-500 hover:text-gray-700 transition-colors focus:outline-none",tabIndex:0,children:q?e.jsx(ue,{className:"h-4 w-4"}):e.jsx(G,{className:"h-4 w-4"})})})]}),q&&e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-4 flex-wrap",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 whitespace-nowrap",children:"Current Time:"}),e.jsx("input",{type:"datetime-local",value:$?new Date($).toISOString().slice(0,16):new Date().toISOString().slice(0,16),onChange:t=>{const d=new Date(t.target.value).getTime();J(d)},className:"border-[0.5px] border-gray-300 rounded bg-white px-3 py-1.5 text-sm text-gray-900 focus:outline-none focus:border-sky-400/60"}),e.jsx("button",{onClick:()=>{const t=Date.now(),d=prompt("Fast-forward hours (negative to go back):","0");d!==null&&!isNaN(parseFloat(d))&&J(t+parseFloat(d)*60*60*1e3)},className:"px-3 py-1.5 text-xs font-medium text-gray-700 hover:text-gray-900 transition-colors focus:outline-none",children:"Fast Forward"}),e.jsx("button",{onClick:()=>J(null),className:"px-3 py-1.5 text-xs font-medium text-gray-700 hover:text-gray-900 transition-colors focus:outline-none",children:"Reset"})]}),g?.exp&&e.jsx("div",{className:"pt-3 border-t border-gray-100",children:e.jsxs("p",{className:"text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Token "}),e.jsx("span",{className:b("font-semibold",g.exp*1e3<ne?"text-red-600":"text-green-600"),children:g.exp*1e3<ne?"expired":"valid"}),e.jsx("span",{className:"text-gray-600",children:" at simulated time"})]})})]})]}),Ce&&g&&e.jsxs("div",{className:"mb-4 sm:mb-6 bg-white border border-gray-200 rounded-xl shadow-sm overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between border-b border-gray-200 bg-gray-50 px-4 sm:px-6 py-3 sm:py-4 cursor-pointer hover:bg-gray-100 transition-colors",onClick:()=>De(!ce),children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsx(As,{className:"h-5 w-5 text-slate-600"}),e.jsx("span",{className:"text-base font-semibold text-slate-900",children:"Redact Sensitive Claims"}),!ce&&e.jsxs("span",{className:"text-xs text-slate-500 ml-2",children:["• ",re.length," claim",re.length!==1?"s":""," selected",be?" • Redacted token ready":""]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("button",{onClick:t=>{t.stopPropagation(),De(!ce)},className:"p-1.5 hover:bg-slate-200 rounded-lg transition focus:outline-none focus:ring-2 focus:ring-slate-300",tabIndex:0,children:ce?e.jsx(ue,{className:"h-4 w-4 text-slate-600"}):e.jsx(G,{className:"h-4 w-4 text-slate-600"})})})]}),ce&&e.jsxs("div",{className:"p-6 space-y-5",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Select claims to redact:"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2 max-h-48 overflow-y-auto",children:Object.keys(g).map(t=>e.jsxs("label",{className:"flex items-center gap-2 p-2 rounded border border-slate-200 hover:bg-slate-50 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:re.includes(t),onChange:()=>gs(t),className:"rounded"}),e.jsxs("span",{className:b("text-sm",je(t)?"font-semibold text-red-700":"text-slate-700"),children:[t,je(t)&&e.jsx("span",{className:"ml-1 text-xs text-red-500",children:"(sensitive)"})]})]},t))})]}),be&&e.jsxs("div",{className:"pt-3 border-t border-gray-100",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Redacted Token:"}),e.jsx("textarea",{value:be,readOnly:!0,className:"w-full h-24 resize-none border-[0.5px] border-gray-300 rounded bg-gray-50 px-3 py-2 font-mono text-xs text-gray-700 focus:outline-none focus:border-sky-400/60"}),e.jsxs("button",{onClick:()=>Z(be),className:"mt-2 inline-flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-gray-700 hover:text-gray-900 transition-colors focus:outline-none",children:[e.jsx(ge,{className:"h-3.5 w-3.5"}),"Copy Redacted Token"]})]})]})]}),is&&e.jsxs("div",{className:"mb-4 sm:mb-6 bg-white border border-gray-200 rounded-xl shadow-sm overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between border-b border-gray-200 bg-gray-50 px-4 sm:px-6 py-3 sm:py-4 cursor-pointer hover:bg-gray-100 transition-colors",onClick:()=>He(!de),children:[e.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[e.jsx(Ts,{className:"h-4 w-4 text-gray-600"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:"Compare Tokens"}),!de&&e.jsx("span",{className:"text-xs text-gray-500 ml-2",children:k?`${k.summary.headerChanges+k.summary.payloadChanges} difference${k.summary.headerChanges+k.summary.payloadChanges!==1?"s":""}`:"Paste second token to compare"})]}),e.jsx("button",{onClick:t=>{t.stopPropagation(),He(!de)},className:"p-1 text-gray-500 hover:text-gray-700 transition-colors focus:outline-none",tabIndex:0,children:de?e.jsx(ue,{className:"h-4 w-4"}):e.jsx(G,{className:"h-4 w-4"})})]}),de&&e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Second Token:"}),e.jsx("textarea",{value:we,onChange:t=>ls(t.target.value),placeholder:"Paste the second JWT token to compare",className:"w-full h-32 resize-none border-[0.5px] border-gray-300 rounded bg-white px-3 py-2 font-mono text-sm text-gray-900 placeholder:text-gray-400 focus:outline-none focus:border-sky-400/60"})]}),e.jsx("button",{onClick:ps,disabled:!s||!we,className:"px-4 py-2 text-sm font-medium text-white bg-sky-500 hover:bg-sky-600 rounded-lg transition-colors disabled:bg-gray-300 disabled:cursor-not-allowed disabled:hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-sky-500 focus:ring-offset-1",children:"Compare Tokens"}),k&&e.jsxs("div",{className:"pt-3 border-t border-gray-100 space-y-3",children:[e.jsxs("div",{className:"bg-gray-50 px-3 py-2 rounded",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 mb-1",children:"Summary:"}),e.jsx("p",{className:"text-sm text-gray-700",children:k?zs(k):""})]}),k.valid&&e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 mb-2",children:"Header Changes:"}),e.jsxs("div",{className:"space-y-1 text-xs",children:[k.headerDiff.added.length>0&&e.jsxs("div",{className:"text-green-700",children:["+ ",k.headerDiff.added.length," added"]}),k.headerDiff.removed.length>0&&e.jsxs("div",{className:"text-red-700",children:["- ",k.headerDiff.removed.length," removed"]}),k.headerDiff.changed.length>0&&e.jsxs("div",{className:"text-yellow-700",children:["~ ",k.headerDiff.changed.length," changed"]})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 mb-2",children:"Payload Changes:"}),e.jsxs("div",{className:"space-y-1 text-xs",children:[k.payloadDiff.added.length>0&&e.jsxs("div",{className:"text-green-700",children:["+ ",k.payloadDiff.added.length," added"]}),k.payloadDiff.removed.length>0&&e.jsxs("div",{className:"text-red-700",children:["- ",k.payloadDiff.removed.length," removed"]}),k.payloadDiff.changed.length>0&&e.jsxs("div",{className:"text-yellow-700",children:["~ ",k.payloadDiff.changed.length," changed"]})]})]})]})]})]})]})]})]})})]})};Ns.createRoot(document.getElementById("root")).render(e.jsx(nt,{}));
//# sourceMappingURL=jwt-DAv78zoh.js.map
